\doxysection{bt\+Gjk\+Pair\+Detector.\+cpp}
\hypertarget{bt_gjk_pair_detector_8cpp_source}{}\label{bt_gjk_pair_detector_8cpp_source}\index{C:/Users/Usuario/Documents/pruebas-\/c/Practica Animación/libraries/bullet-\/3.17/src/BulletCollision/NarrowPhaseCollision/btGjkPairDetector.cpp@{C:/Users/Usuario/Documents/pruebas-\/c/Practica Animación/libraries/bullet-\/3.17/src/BulletCollision/NarrowPhaseCollision/btGjkPairDetector.cpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*}}
\DoxyCodeLine{00002\ \textcolor{comment}{Bullet\ Continuous\ Collision\ Detection\ and\ Physics\ Library}}
\DoxyCodeLine{00003\ \textcolor{comment}{Copyright\ (c)\ 2003-\/2006\ Erwin\ Coumans\ \ http://continuousphysics.com/Bullet/}}
\DoxyCodeLine{00004\ \textcolor{comment}{}}
\DoxyCodeLine{00005\ \textcolor{comment}{This\ software\ is\ provided\ 'as-\/is',\ without\ any\ express\ or\ implied\ warranty.}}
\DoxyCodeLine{00006\ \textcolor{comment}{In\ no\ event\ will\ the\ authors\ be\ held\ liable\ for\ any\ damages\ arising\ from\ the\ use\ of\ this\ software.}}
\DoxyCodeLine{00007\ \textcolor{comment}{Permission\ is\ granted\ to\ anyone\ to\ use\ this\ software\ for\ any\ purpose,\ }}
\DoxyCodeLine{00008\ \textcolor{comment}{including\ commercial\ applications,\ and\ to\ alter\ it\ and\ redistribute\ it\ freely,\ }}
\DoxyCodeLine{00009\ \textcolor{comment}{subject\ to\ the\ following\ restrictions:}}
\DoxyCodeLine{00010\ \textcolor{comment}{}}
\DoxyCodeLine{00011\ \textcolor{comment}{1.\ The\ origin\ of\ this\ software\ must\ not\ be\ misrepresented;\ you\ must\ not\ claim\ that\ you\ wrote\ the\ original\ software.\ If\ you\ use\ this\ software\ in\ a\ product,\ an\ acknowledgment\ in\ the\ product\ documentation\ would\ be\ appreciated\ but\ is\ not\ required.}}
\DoxyCodeLine{00012\ \textcolor{comment}{2.\ Altered\ source\ versions\ must\ be\ plainly\ marked\ as\ such,\ and\ must\ not\ be\ misrepresented\ as\ being\ the\ original\ software.}}
\DoxyCodeLine{00013\ \textcolor{comment}{3.\ This\ notice\ may\ not\ be\ removed\ or\ altered\ from\ any\ source\ distribution.}}
\DoxyCodeLine{00014\ \textcolor{comment}{*/}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}btGjkPairDetector.h"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}BulletCollision/CollisionShapes/btConvexShape.h"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}BulletCollision/NarrowPhaseCollision/btSimplexSolverInterface.h"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}BulletCollision/NarrowPhaseCollision/btConvexPenetrationDepthSolver.h"{}}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#if\ defined(DEBUG)\ ||\ defined(\_DEBUG)}}
\DoxyCodeLine{00022\ \textcolor{comment}{//\#define\ TEST\_NON\_VIRTUAL\ 1}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ <stdio.h>}\ \ \textcolor{comment}{//for\ debug\ printf}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#ifdef\ \_\_SPU\_\_}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ <spu\_printf.h>}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#define\ printf\ spu\_printf}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\_\_SPU\_\_}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \textcolor{comment}{//must\ be\ above\ the\ machine\ epsilon}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#ifdef\ BT\_USE\_DOUBLE\_PRECISION}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#define\ REL\_ERROR2\ btScalar(1.0e-\/12)}}
\DoxyCodeLine{00033\ btScalar\ gGjkEpaPenetrationTolerance\ =\ 1.0e-\/12;}
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#define\ REL\_ERROR2\ btScalar(1.0e-\/6)}}
\DoxyCodeLine{00036\ btScalar\ gGjkEpaPenetrationTolerance\ =\ 0.001;}
\DoxyCodeLine{00037\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ btGjkPairDetector::btGjkPairDetector(\textcolor{keyword}{const}\ btConvexShape\ *objectA,\ \textcolor{keyword}{const}\ btConvexShape\ *objectB,\ btSimplexSolverInterface\ *simplexSolver,\ \mbox{\hyperlink{classbt_convex_penetration_depth_solver}{btConvexPenetrationDepthSolver}}\ *penetrationDepthSolver)}
\DoxyCodeLine{00041\ \ \ \ \ :\ m\_cachedSeparatingAxis(btScalar(0.),\ btScalar(1.),\ btScalar(0.)),}
\DoxyCodeLine{00042\ \ \ \ \ \ \ m\_penetrationDepthSolver(penetrationDepthSolver),}
\DoxyCodeLine{00043\ \ \ \ \ \ \ m\_simplexSolver(simplexSolver),}
\DoxyCodeLine{00044\ \ \ \ \ \ \ m\_minkowskiA(objectA),}
\DoxyCodeLine{00045\ \ \ \ \ \ \ m\_minkowskiB(objectB),}
\DoxyCodeLine{00046\ \ \ \ \ \ \ m\_shapeTypeA(objectA-\/>getShapeType()),}
\DoxyCodeLine{00047\ \ \ \ \ \ \ m\_shapeTypeB(objectB-\/>getShapeType()),}
\DoxyCodeLine{00048\ \ \ \ \ \ \ m\_marginA(objectA-\/>getMargin()),}
\DoxyCodeLine{00049\ \ \ \ \ \ \ m\_marginB(objectB-\/>getMargin()),}
\DoxyCodeLine{00050\ \ \ \ \ \ \ m\_ignoreMargin(false),}
\DoxyCodeLine{00051\ \ \ \ \ \ \ m\_lastUsedMethod(-\/1),}
\DoxyCodeLine{00052\ \ \ \ \ \ \ m\_catchDegeneracies(1),}
\DoxyCodeLine{00053\ \ \ \ \ \ \ m\_fixContactNormalDirection(1)}
\DoxyCodeLine{00054\ \{}
\DoxyCodeLine{00055\ \}}
\DoxyCodeLine{00056\ btGjkPairDetector::btGjkPairDetector(\textcolor{keyword}{const}\ btConvexShape\ *objectA,\ \textcolor{keyword}{const}\ btConvexShape\ *objectB,\ \textcolor{keywordtype}{int}\ shapeTypeA,\ \textcolor{keywordtype}{int}\ shapeTypeB,\ btScalar\ marginA,\ btScalar\ marginB,\ btSimplexSolverInterface\ *simplexSolver,\ \mbox{\hyperlink{classbt_convex_penetration_depth_solver}{btConvexPenetrationDepthSolver}}\ *penetrationDepthSolver)}
\DoxyCodeLine{00057\ \ \ \ \ :\ m\_cachedSeparatingAxis(btScalar(0.),\ btScalar(1.),\ btScalar(0.)),}
\DoxyCodeLine{00058\ \ \ \ \ \ \ m\_penetrationDepthSolver(penetrationDepthSolver),}
\DoxyCodeLine{00059\ \ \ \ \ \ \ m\_simplexSolver(simplexSolver),}
\DoxyCodeLine{00060\ \ \ \ \ \ \ m\_minkowskiA(objectA),}
\DoxyCodeLine{00061\ \ \ \ \ \ \ m\_minkowskiB(objectB),}
\DoxyCodeLine{00062\ \ \ \ \ \ \ m\_shapeTypeA(shapeTypeA),}
\DoxyCodeLine{00063\ \ \ \ \ \ \ m\_shapeTypeB(shapeTypeB),}
\DoxyCodeLine{00064\ \ \ \ \ \ \ m\_marginA(marginA),}
\DoxyCodeLine{00065\ \ \ \ \ \ \ m\_marginB(marginB),}
\DoxyCodeLine{00066\ \ \ \ \ \ \ m\_ignoreMargin(false),}
\DoxyCodeLine{00067\ \ \ \ \ \ \ m\_lastUsedMethod(-\/1),}
\DoxyCodeLine{00068\ \ \ \ \ \ \ m\_catchDegeneracies(1),}
\DoxyCodeLine{00069\ \ \ \ \ \ \ m\_fixContactNormalDirection(1)}
\DoxyCodeLine{00070\ \{}
\DoxyCodeLine{00071\ \}}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \textcolor{keywordtype}{void}\ btGjkPairDetector::getClosestPoints(\textcolor{keyword}{const}\ ClosestPointInput\ \&input,\ Result\ \&output,\ \textcolor{keyword}{class}\ \mbox{\hyperlink{classbt_i_debug_draw}{btIDebugDraw}}\ *debugDraw,\ \textcolor{keywordtype}{bool}\ swapResults)}
\DoxyCodeLine{00074\ \{}
\DoxyCodeLine{00075\ \ \ \ \ (void)swapResults;}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \ \ \ \ \mbox{\hyperlink{classbt_gjk_pair_detector_abc29953dd7aee59e9ca887963c26c8c2}{getClosestPointsNonVirtual}}(input,\ output,\ debugDraw);}
\DoxyCodeLine{00078\ \}}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ btComputeSupport(\textcolor{keyword}{const}\ btConvexShape\ *convexA,\ \textcolor{keyword}{const}\ btTransform\ \&localTransA,\ \textcolor{keyword}{const}\ btConvexShape\ *convexB,\ \textcolor{keyword}{const}\ btTransform\ \&localTransB,\ \textcolor{keyword}{const}\ btVector3\ \&dir,\ \textcolor{keywordtype}{bool}\ check2d,\ btVector3\ \&supAworld,\ btVector3\ \&supBworld,\ btVector3\ \&aMinb)}
\DoxyCodeLine{00081\ \{}
\DoxyCodeLine{00082\ \ \ \ \ btVector3\ separatingAxisInA\ =\ (dir)*localTransA.getBasis();}
\DoxyCodeLine{00083\ \ \ \ \ btVector3\ separatingAxisInB\ =\ (-\/dir)\ *\ localTransB.getBasis();}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \ \ \ \ btVector3\ pInANoMargin\ =\ convexA-\/>localGetSupportVertexWithoutMarginNonVirtual(separatingAxisInA);}
\DoxyCodeLine{00086\ \ \ \ \ btVector3\ qInBNoMargin\ =\ convexB-\/>localGetSupportVertexWithoutMarginNonVirtual(separatingAxisInB);}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \ \ \ \ btVector3\ pInA\ =\ pInANoMargin;}
\DoxyCodeLine{00089\ \ \ \ \ btVector3\ qInB\ =\ qInBNoMargin;}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00091\ \ \ \ \ supAworld\ =\ localTransA(pInA);}
\DoxyCodeLine{00092\ \ \ \ \ supBworld\ =\ localTransB(qInB);}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \ \ \ \ \textcolor{keywordflow}{if}\ (check2d)}
\DoxyCodeLine{00095\ \ \ \ \ \{}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ supAworld[2]\ =\ 0.f;}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ supBworld[2]\ =\ 0.f;}
\DoxyCodeLine{00098\ \ \ \ \ \}}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \ \ \ \ aMinb\ =\ supAworld\ -\/\ supBworld;}
\DoxyCodeLine{00101\ \}}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structbt_support_vector}{btSupportVector}}}
\DoxyCodeLine{00104\ \{}
\DoxyCodeLine{00105\ \ \ \ \ btVector3\ \mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}};\ \ \ }
\DoxyCodeLine{00106\ \ \ \ \ btVector3\ \mbox{\hyperlink{structbt_support_vector_a8d1c19756c15c781286e715069746f5d}{v1}};\ \ }
\DoxyCodeLine{00107\ \ \ \ \ btVector3\ \mbox{\hyperlink{structbt_support_vector_a0c435fed23c213b39fe69fb40d784392}{v2}};\ \ }
\DoxyCodeLine{00108\ \};}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structbt_simplex}{btSimplex}}}
\DoxyCodeLine{00111\ \{}
\DoxyCodeLine{00112\ \ \ \ \ \mbox{\hyperlink{structbt_support_vector}{btSupportVector}}\ ps[4];}
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structbt_simplex_a1baa5bdc98828bd6d40c46c88cbf9d01}{last}};\ \ }
\DoxyCodeLine{00114\ \};}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00116\ \textcolor{keyword}{static}\ btVector3\ ccd\_vec3\_origin(0,\ 0,\ 0);}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ btSimplexInit(\mbox{\hyperlink{structbt_simplex}{btSimplex}}\ *s)}
\DoxyCodeLine{00119\ \{}
\DoxyCodeLine{00120\ \ \ \ \ s-\/>\mbox{\hyperlink{structbt_simplex_a1baa5bdc98828bd6d40c46c88cbf9d01}{last}}\ =\ -\/1;}
\DoxyCodeLine{00121\ \}}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00123\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{int}\ btSimplexSize(\textcolor{keyword}{const}\ \mbox{\hyperlink{structbt_simplex}{btSimplex}}\ *s)}
\DoxyCodeLine{00124\ \{}
\DoxyCodeLine{00125\ \ \ \ \ \textcolor{keywordflow}{return}\ s-\/>\mbox{\hyperlink{structbt_simplex_a1baa5bdc98828bd6d40c46c88cbf9d01}{last}}\ +\ 1;}
\DoxyCodeLine{00126\ \}}
\DoxyCodeLine{00127\ }
\DoxyCodeLine{00128\ \textcolor{keyword}{inline}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structbt_support_vector}{btSupportVector}}\ *btSimplexPoint(\textcolor{keyword}{const}\ \mbox{\hyperlink{structbt_simplex}{btSimplex}}\ *s,\ \textcolor{keywordtype}{int}\ idx)}
\DoxyCodeLine{00129\ \{}
\DoxyCodeLine{00130\ \ \ \ \ \textcolor{comment}{//\ here\ is\ no\ check\ on\ boundaries}}
\DoxyCodeLine{00131\ \ \ \ \ \textcolor{keywordflow}{return}\ \&s-\/>ps[idx];}
\DoxyCodeLine{00132\ \}}
\DoxyCodeLine{00133\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ btSupportCopy(\mbox{\hyperlink{structbt_support_vector}{btSupportVector}}\ *d,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structbt_support_vector}{btSupportVector}}\ *s)}
\DoxyCodeLine{00134\ \{}
\DoxyCodeLine{00135\ \ \ \ \ *d\ =\ *s;}
\DoxyCodeLine{00136\ \}}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00138\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ btVec3Copy(btVector3\ *v,\ \textcolor{keyword}{const}\ btVector3\ *w)}
\DoxyCodeLine{00139\ \{}
\DoxyCodeLine{00140\ \ \ \ \ *v\ =\ *w;}
\DoxyCodeLine{00141\ \}}
\DoxyCodeLine{00142\ }
\DoxyCodeLine{00143\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ ccdVec3Add(btVector3\ *v,\ \textcolor{keyword}{const}\ btVector3\ *w)}
\DoxyCodeLine{00144\ \{}
\DoxyCodeLine{00145\ \ \ \ \ v-\/>m\_floats[0]\ +=\ w-\/>m\_floats[0];}
\DoxyCodeLine{00146\ \ \ \ \ v-\/>m\_floats[1]\ +=\ w-\/>m\_floats[1];}
\DoxyCodeLine{00147\ \ \ \ \ v-\/>m\_floats[2]\ +=\ w-\/>m\_floats[2];}
\DoxyCodeLine{00148\ \}}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ ccdVec3Sub(btVector3\ *v,\ \textcolor{keyword}{const}\ btVector3\ *w)}
\DoxyCodeLine{00151\ \{}
\DoxyCodeLine{00152\ \ \ \ \ *v\ -\/=\ *w;}
\DoxyCodeLine{00153\ \}}
\DoxyCodeLine{00154\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ btVec3Sub2(btVector3\ *d,\ \textcolor{keyword}{const}\ btVector3\ *v,\ \textcolor{keyword}{const}\ btVector3\ *w)}
\DoxyCodeLine{00155\ \{}
\DoxyCodeLine{00156\ \ \ \ \ *d\ =\ (*v)\ -\/\ (*w);}
\DoxyCodeLine{00157\ \}}
\DoxyCodeLine{00158\ \textcolor{keyword}{inline}\ btScalar\ btVec3Dot(\textcolor{keyword}{const}\ btVector3\ *a,\ \textcolor{keyword}{const}\ btVector3\ *b)}
\DoxyCodeLine{00159\ \{}
\DoxyCodeLine{00160\ \ \ \ \ btScalar\ dot;}
\DoxyCodeLine{00161\ \ \ \ \ dot\ =\ a-\/>dot(*b);}
\DoxyCodeLine{00162\ }
\DoxyCodeLine{00163\ \ \ \ \ \textcolor{keywordflow}{return}\ dot;}
\DoxyCodeLine{00164\ \}}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00166\ \textcolor{keyword}{inline}\ btScalar\ ccdVec3Dist2(\textcolor{keyword}{const}\ btVector3\ *a,\ \textcolor{keyword}{const}\ btVector3\ *b)}
\DoxyCodeLine{00167\ \{}
\DoxyCodeLine{00168\ \ \ \ \ btVector3\ ab;}
\DoxyCodeLine{00169\ \ \ \ \ btVec3Sub2(\&ab,\ a,\ b);}
\DoxyCodeLine{00170\ \ \ \ \ \textcolor{keywordflow}{return}\ btVec3Dot(\&ab,\ \&ab);}
\DoxyCodeLine{00171\ \}}
\DoxyCodeLine{00172\ }
\DoxyCodeLine{00173\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ btVec3Scale(btVector3\ *d,\ btScalar\ k)}
\DoxyCodeLine{00174\ \{}
\DoxyCodeLine{00175\ \ \ \ \ d-\/>m\_floats[0]\ *=\ k;}
\DoxyCodeLine{00176\ \ \ \ \ d-\/>m\_floats[1]\ *=\ k;}
\DoxyCodeLine{00177\ \ \ \ \ d-\/>m\_floats[2]\ *=\ k;}
\DoxyCodeLine{00178\ \}}
\DoxyCodeLine{00179\ }
\DoxyCodeLine{00180\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ btVec3Cross(btVector3\ *d,\ \textcolor{keyword}{const}\ btVector3\ *a,\ \textcolor{keyword}{const}\ btVector3\ *b)}
\DoxyCodeLine{00181\ \{}
\DoxyCodeLine{00182\ \ \ \ \ d-\/>m\_floats[0]\ =\ (a-\/>m\_floats[1]\ *\ b-\/>m\_floats[2])\ -\/\ (a-\/>m\_floats[2]\ *\ b-\/>m\_floats[1]);}
\DoxyCodeLine{00183\ \ \ \ \ d-\/>m\_floats[1]\ =\ (a-\/>m\_floats[2]\ *\ b-\/>m\_floats[0])\ -\/\ (a-\/>m\_floats[0]\ *\ b-\/>m\_floats[2]);}
\DoxyCodeLine{00184\ \ \ \ \ d-\/>m\_floats[2]\ =\ (a-\/>m\_floats[0]\ *\ b-\/>m\_floats[1])\ -\/\ (a-\/>m\_floats[1]\ *\ b-\/>m\_floats[0]);}
\DoxyCodeLine{00185\ \}}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00187\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ btTripleCross(\textcolor{keyword}{const}\ btVector3\ *a,\ \textcolor{keyword}{const}\ btVector3\ *b,}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ btVector3\ *c,\ btVector3\ *d)}
\DoxyCodeLine{00189\ \{}
\DoxyCodeLine{00190\ \ \ \ \ btVector3\ \mbox{\hyperlink{group__gtc__constants_ga4b7956eb6e2fbedfc7cf2e46e85c5139}{e}};}
\DoxyCodeLine{00191\ \ \ \ \ btVec3Cross(\&e,\ a,\ b);}
\DoxyCodeLine{00192\ \ \ \ \ btVec3Cross(d,\ \&e,\ c);}
\DoxyCodeLine{00193\ \}}
\DoxyCodeLine{00194\ }
\DoxyCodeLine{00195\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{int}\ ccdEq(btScalar\ \_a,\ btScalar\ \_b)}
\DoxyCodeLine{00196\ \{}
\DoxyCodeLine{00197\ \ \ \ \ btScalar\ ab;}
\DoxyCodeLine{00198\ \ \ \ \ btScalar\ a,\ b;}
\DoxyCodeLine{00199\ }
\DoxyCodeLine{00200\ \ \ \ \ ab\ =\ btFabs(\_a\ -\/\ \_b);}
\DoxyCodeLine{00201\ \ \ \ \ \textcolor{keywordflow}{if}\ (btFabs(ab)\ <\ SIMD\_EPSILON)}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{00203\ }
\DoxyCodeLine{00204\ \ \ \ \ a\ =\ btFabs(\_a);}
\DoxyCodeLine{00205\ \ \ \ \ b\ =\ btFabs(\_b);}
\DoxyCodeLine{00206\ \ \ \ \ \textcolor{keywordflow}{if}\ (b\ >\ a)}
\DoxyCodeLine{00207\ \ \ \ \ \{}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ab\ <\ SIMD\_EPSILON\ *\ b;}
\DoxyCodeLine{00209\ \ \ \ \ \}}
\DoxyCodeLine{00210\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00211\ \ \ \ \ \{}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ab\ <\ SIMD\_EPSILON\ *\ a;}
\DoxyCodeLine{00213\ \ \ \ \ \}}
\DoxyCodeLine{00214\ \}}
\DoxyCodeLine{00215\ }
\DoxyCodeLine{00216\ btScalar\ ccdVec3X(\textcolor{keyword}{const}\ btVector3\ *v)}
\DoxyCodeLine{00217\ \{}
\DoxyCodeLine{00218\ \ \ \ \ \textcolor{keywordflow}{return}\ v-\/>x();}
\DoxyCodeLine{00219\ \}}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00221\ btScalar\ ccdVec3Y(\textcolor{keyword}{const}\ btVector3\ *v)}
\DoxyCodeLine{00222\ \{}
\DoxyCodeLine{00223\ \ \ \ \ \textcolor{keywordflow}{return}\ v-\/>y();}
\DoxyCodeLine{00224\ \}}
\DoxyCodeLine{00225\ }
\DoxyCodeLine{00226\ btScalar\ ccdVec3Z(\textcolor{keyword}{const}\ btVector3\ *v)}
\DoxyCodeLine{00227\ \{}
\DoxyCodeLine{00228\ \ \ \ \ \textcolor{keywordflow}{return}\ v-\/>z();}
\DoxyCodeLine{00229\ \}}
\DoxyCodeLine{00230\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{int}\ btVec3Eq(\textcolor{keyword}{const}\ btVector3\ *a,\ \textcolor{keyword}{const}\ btVector3\ *b)}
\DoxyCodeLine{00231\ \{}
\DoxyCodeLine{00232\ \ \ \ \ \textcolor{keywordflow}{return}\ ccdEq(ccdVec3X(a),\ ccdVec3X(b))\ \&\&\ ccdEq(ccdVec3Y(a),\ ccdVec3Y(b))\ \&\&\ ccdEq(ccdVec3Z(a),\ ccdVec3Z(b));}
\DoxyCodeLine{00233\ \}}
\DoxyCodeLine{00234\ }
\DoxyCodeLine{00235\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ btSimplexAdd(\mbox{\hyperlink{structbt_simplex}{btSimplex}}\ *s,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structbt_support_vector}{btSupportVector}}\ *v)}
\DoxyCodeLine{00236\ \{}
\DoxyCodeLine{00237\ \ \ \ \ \textcolor{comment}{//\ here\ is\ no\ check\ on\ boundaries\ in\ sake\ of\ speed}}
\DoxyCodeLine{00238\ \ \ \ \ ++s-\/>\mbox{\hyperlink{structbt_simplex_a1baa5bdc98828bd6d40c46c88cbf9d01}{last}};}
\DoxyCodeLine{00239\ \ \ \ \ btSupportCopy(s-\/>ps\ +\ s-\/>\mbox{\hyperlink{structbt_simplex_a1baa5bdc98828bd6d40c46c88cbf9d01}{last}},\ v);}
\DoxyCodeLine{00240\ \}}
\DoxyCodeLine{00241\ }
\DoxyCodeLine{00242\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ btSimplexSet(\mbox{\hyperlink{structbt_simplex}{btSimplex}}\ *s,\ \textcolor{keywordtype}{size\_t}\ pos,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structbt_support_vector}{btSupportVector}}\ *a)}
\DoxyCodeLine{00243\ \{}
\DoxyCodeLine{00244\ \ \ \ \ btSupportCopy(s-\/>ps\ +\ pos,\ a);}
\DoxyCodeLine{00245\ \}}
\DoxyCodeLine{00246\ }
\DoxyCodeLine{00247\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ btSimplexSetSize(\mbox{\hyperlink{structbt_simplex}{btSimplex}}\ *s,\ \textcolor{keywordtype}{int}\ size)}
\DoxyCodeLine{00248\ \{}
\DoxyCodeLine{00249\ \ \ \ \ s-\/>\mbox{\hyperlink{structbt_simplex_a1baa5bdc98828bd6d40c46c88cbf9d01}{last}}\ =\ size\ -\/\ 1;}
\DoxyCodeLine{00250\ \}}
\DoxyCodeLine{00251\ }
\DoxyCodeLine{00252\ \textcolor{keyword}{inline}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structbt_support_vector}{btSupportVector}}\ *ccdSimplexLast(\textcolor{keyword}{const}\ \mbox{\hyperlink{structbt_simplex}{btSimplex}}\ *s)}
\DoxyCodeLine{00253\ \{}
\DoxyCodeLine{00254\ \ \ \ \ \textcolor{keywordflow}{return}\ btSimplexPoint(s,\ s-\/>\mbox{\hyperlink{structbt_simplex_a1baa5bdc98828bd6d40c46c88cbf9d01}{last}});}
\DoxyCodeLine{00255\ \}}
\DoxyCodeLine{00256\ }
\DoxyCodeLine{00257\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{int}\ ccdSign(btScalar\ val)}
\DoxyCodeLine{00258\ \{}
\DoxyCodeLine{00259\ \ \ \ \ \textcolor{keywordflow}{if}\ (btFuzzyZero(val))}
\DoxyCodeLine{00260\ \ \ \ \ \{}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00262\ \ \ \ \ \}}
\DoxyCodeLine{00263\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (val\ <\ btScalar(0))}
\DoxyCodeLine{00264\ \ \ \ \ \{}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00266\ \ \ \ \ \}}
\DoxyCodeLine{00267\ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{00268\ \}}
\DoxyCodeLine{00269\ }
\DoxyCodeLine{00270\ \textcolor{keyword}{inline}\ btScalar\ btVec3PointSegmentDist2(\textcolor{keyword}{const}\ btVector3\ *P,}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ btVector3\ *x0,}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ btVector3\ *b,}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ *witness)}
\DoxyCodeLine{00274\ \{}
\DoxyCodeLine{00275\ \ \ \ \ \textcolor{comment}{//\ The\ computation\ comes\ from\ solving\ equation\ of\ segment:}}
\DoxyCodeLine{00276\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ S(t)\ =\ x0\ +\ t.d}}
\DoxyCodeLine{00277\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ where\ -\/\ x0\ is\ initial\ point\ of\ segment}}
\DoxyCodeLine{00278\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/\ d\ is\ direction\ of\ segment\ from\ x0\ (|d|\ >\ 0)}}
\DoxyCodeLine{00279\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/\ t\ belongs\ to\ <0,\ 1>\ interval}}
\DoxyCodeLine{00280\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00281\ \ \ \ \ \textcolor{comment}{//\ Than,\ distance\ from\ a\ segment\ to\ some\ point\ P\ can\ be\ expressed:}}
\DoxyCodeLine{00282\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ D(t)\ =\ |x0\ +\ t.d\ -\/\ P|\string^2}}
\DoxyCodeLine{00283\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ which\ is\ distance\ from\ any\ point\ on\ segment.\ Minimization}}
\DoxyCodeLine{00284\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ of\ this\ function\ brings\ distance\ from\ P\ to\ segment.}}
\DoxyCodeLine{00285\ \ \ \ \ \textcolor{comment}{//\ Minimization\ of\ D(t)\ leads\ to\ simple\ quadratic\ equation\ that's}}
\DoxyCodeLine{00286\ \ \ \ \ \textcolor{comment}{//\ solving\ is\ straightforward.}}
\DoxyCodeLine{00287\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00288\ \ \ \ \ \textcolor{comment}{//\ Bonus\ of\ this\ method\ is\ witness\ point\ for\ free.}}
\DoxyCodeLine{00289\ }
\DoxyCodeLine{00290\ \ \ \ \ btScalar\ dist,\ t;}
\DoxyCodeLine{00291\ \ \ \ \ btVector3\ d,\ a;}
\DoxyCodeLine{00292\ }
\DoxyCodeLine{00293\ \ \ \ \ \textcolor{comment}{//\ direction\ of\ segment}}
\DoxyCodeLine{00294\ \ \ \ \ btVec3Sub2(\&d,\ b,\ x0);}
\DoxyCodeLine{00295\ }
\DoxyCodeLine{00296\ \ \ \ \ \textcolor{comment}{//\ precompute\ vector\ from\ P\ to\ x0}}
\DoxyCodeLine{00297\ \ \ \ \ btVec3Sub2(\&a,\ x0,\ P);}
\DoxyCodeLine{00298\ }
\DoxyCodeLine{00299\ \ \ \ \ t\ =\ -\/btScalar(1.)\ *\ btVec3Dot(\&a,\ \&d);}
\DoxyCodeLine{00300\ \ \ \ \ t\ /=\ btVec3Dot(\&d,\ \&d);}
\DoxyCodeLine{00301\ }
\DoxyCodeLine{00302\ \ \ \ \ \textcolor{keywordflow}{if}\ (t\ <\ btScalar(0)\ ||\ btFuzzyZero(t))}
\DoxyCodeLine{00303\ \ \ \ \ \{}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ dist\ =\ ccdVec3Dist2(x0,\ P);}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (witness)}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ \ \ \ \ btVec3Copy(witness,\ x0);}
\DoxyCodeLine{00307\ \ \ \ \ \}}
\DoxyCodeLine{00308\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (t\ >\ btScalar(1)\ ||\ ccdEq(t,\ btScalar(1)))}
\DoxyCodeLine{00309\ \ \ \ \ \{}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ dist\ =\ ccdVec3Dist2(b,\ P);}
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (witness)}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \ \ \ \ btVec3Copy(witness,\ b);}
\DoxyCodeLine{00313\ \ \ \ \ \}}
\DoxyCodeLine{00314\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00315\ \ \ \ \ \{}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (witness)}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ \ \ \ \ btVec3Copy(witness,\ \&d);}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ \ \ \ \ btVec3Scale(witness,\ t);}
\DoxyCodeLine{00320\ \ \ \ \ \ \ \ \ \ \ \ \ ccdVec3Add(witness,\ x0);}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \ \ \ \ dist\ =\ ccdVec3Dist2(witness,\ P);}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ recycling\ variables}}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \ \ \ \ btVec3Scale(\&d,\ t);}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ \ \ \ \ ccdVec3Add(\&d,\ \&a);}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \ \ \ \ dist\ =\ btVec3Dot(\&d,\ \&d);}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00330\ \ \ \ \ \}}
\DoxyCodeLine{00331\ }
\DoxyCodeLine{00332\ \ \ \ \ \textcolor{keywordflow}{return}\ dist;}
\DoxyCodeLine{00333\ \}}
\DoxyCodeLine{00334\ }
\DoxyCodeLine{00335\ btScalar\ btVec3PointTriDist2(\textcolor{keyword}{const}\ btVector3\ *P,}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ btVector3\ *x0,\ \textcolor{keyword}{const}\ btVector3\ *B,}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ btVector3\ *C,}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ *witness)}
\DoxyCodeLine{00339\ \{}
\DoxyCodeLine{00340\ \ \ \ \ \textcolor{comment}{//\ Computation\ comes\ from\ analytic\ expression\ for\ triangle\ (x0,\ B,\ C)}}
\DoxyCodeLine{00341\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ T(s,\ t)\ =\ x0\ +\ s.d1\ +\ t.d2,\ where\ d1\ =\ B\ -\/\ x0\ and\ d2\ =\ C\ -\/\ x0\ and}}
\DoxyCodeLine{00342\ \ \ \ \ \textcolor{comment}{//\ Then\ equation\ for\ distance\ is:}}
\DoxyCodeLine{00343\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ D(s,\ t)\ =\ |\ T(s,\ t)\ -\/\ P\ |\string^2}}
\DoxyCodeLine{00344\ \ \ \ \ \textcolor{comment}{//\ This\ leads\ to\ minimization\ of\ quadratic\ function\ of\ two\ variables.}}
\DoxyCodeLine{00345\ \ \ \ \ \textcolor{comment}{//\ The\ solution\ from\ is\ taken\ only\ if\ s\ is\ between\ 0\ and\ 1,\ t\ is}}
\DoxyCodeLine{00346\ \ \ \ \ \textcolor{comment}{//\ between\ 0\ and\ 1\ and\ t\ +\ s\ <\ 1,\ otherwise\ distance\ from\ segment\ is}}
\DoxyCodeLine{00347\ \ \ \ \ \textcolor{comment}{//\ computed.}}
\DoxyCodeLine{00348\ }
\DoxyCodeLine{00349\ \ \ \ \ btVector3\ d1,\ d2,\ a;}
\DoxyCodeLine{00350\ \ \ \ \ \textcolor{keywordtype}{double}\ u,\ v,\ w,\ p,\ q,\ r;}
\DoxyCodeLine{00351\ \ \ \ \ \textcolor{keywordtype}{double}\ s,\ t,\ dist,\ dist2;}
\DoxyCodeLine{00352\ \ \ \ \ btVector3\ witness2;}
\DoxyCodeLine{00353\ }
\DoxyCodeLine{00354\ \ \ \ \ btVec3Sub2(\&d1,\ B,\ x0);}
\DoxyCodeLine{00355\ \ \ \ \ btVec3Sub2(\&d2,\ C,\ x0);}
\DoxyCodeLine{00356\ \ \ \ \ btVec3Sub2(\&a,\ x0,\ P);}
\DoxyCodeLine{00357\ }
\DoxyCodeLine{00358\ \ \ \ \ u\ =\ btVec3Dot(\&a,\ \&a);}
\DoxyCodeLine{00359\ \ \ \ \ v\ =\ btVec3Dot(\&d1,\ \&d1);}
\DoxyCodeLine{00360\ \ \ \ \ w\ =\ btVec3Dot(\&d2,\ \&d2);}
\DoxyCodeLine{00361\ \ \ \ \ p\ =\ btVec3Dot(\&a,\ \&d1);}
\DoxyCodeLine{00362\ \ \ \ \ q\ =\ btVec3Dot(\&a,\ \&d2);}
\DoxyCodeLine{00363\ \ \ \ \ r\ =\ btVec3Dot(\&d1,\ \&d2);}
\DoxyCodeLine{00364\ }
\DoxyCodeLine{00365\ \ \ \ \ s\ =\ (q\ *\ r\ -\/\ w\ *\ p)\ /\ (w\ *\ v\ -\/\ r\ *\ r);}
\DoxyCodeLine{00366\ \ \ \ \ t\ =\ (-\/s\ *\ r\ -\/\ q)\ /\ w;}
\DoxyCodeLine{00367\ }
\DoxyCodeLine{00368\ \ \ \ \ \textcolor{keywordflow}{if}\ ((btFuzzyZero(s)\ ||\ s\ >\ btScalar(0))\ \&\&\ (ccdEq(s,\ btScalar(1))\ ||\ s\ <\ btScalar(1))\ \&\&\ (btFuzzyZero(t)\ ||\ t\ >\ btScalar(0))\ \&\&\ (ccdEq(t,\ btScalar(1))\ ||\ t\ <\ btScalar(1))\ \&\&\ (ccdEq(t\ +\ s,\ btScalar(1))\ ||\ t\ +\ s\ <\ btScalar(1)))}
\DoxyCodeLine{00369\ \ \ \ \ \{}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (witness)}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ \ \ \ \ btVec3Scale(\&d1,\ s);}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \ \ \ \ btVec3Scale(\&d2,\ t);}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \ \ \ \ btVec3Copy(witness,\ x0);}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \ \ \ \ ccdVec3Add(witness,\ \&d1);}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \ \ \ \ ccdVec3Add(witness,\ \&d2);}
\DoxyCodeLine{00377\ }
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \ \ \ \ dist\ =\ ccdVec3Dist2(witness,\ P);}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \ \ \ \ dist\ =\ s\ *\ s\ *\ v;}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \ \ \ \ dist\ +=\ t\ *\ t\ *\ w;}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \ \ \ \ dist\ +=\ btScalar(2.)\ *\ s\ *\ t\ *\ r;}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \ \ \ \ dist\ +=\ btScalar(2.)\ *\ s\ *\ p;}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \ \ \ \ dist\ +=\ btScalar(2.)\ *\ t\ *\ q;}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ \ \ \ \ dist\ +=\ u;}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00389\ \ \ \ \ \}}
\DoxyCodeLine{00390\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00391\ \ \ \ \ \{}
\DoxyCodeLine{00392\ \ \ \ \ \ \ \ \ dist\ =\ btVec3PointSegmentDist2(P,\ x0,\ B,\ witness);}
\DoxyCodeLine{00393\ }
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ dist2\ =\ btVec3PointSegmentDist2(P,\ x0,\ C,\ \&witness2);}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (dist2\ <\ dist)}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00397\ \ \ \ \ \ \ \ \ \ \ \ \ dist\ =\ dist2;}
\DoxyCodeLine{00398\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (witness)}
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVec3Copy(witness,\ \&witness2);}
\DoxyCodeLine{00400\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00401\ }
\DoxyCodeLine{00402\ \ \ \ \ \ \ \ \ dist2\ =\ btVec3PointSegmentDist2(P,\ B,\ C,\ \&witness2);}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (dist2\ <\ dist)}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \ \ \ \ \ \ dist\ =\ dist2;}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (witness)}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVec3Copy(witness,\ \&witness2);}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00409\ \ \ \ \ \}}
\DoxyCodeLine{00410\ }
\DoxyCodeLine{00411\ \ \ \ \ \textcolor{keywordflow}{return}\ dist;}
\DoxyCodeLine{00412\ \}}
\DoxyCodeLine{00413\ }
\DoxyCodeLine{00414\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ btDoSimplex2(\mbox{\hyperlink{structbt_simplex}{btSimplex}}\ *simplex,\ btVector3\ *dir)}
\DoxyCodeLine{00415\ \{}
\DoxyCodeLine{00416\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structbt_support_vector}{btSupportVector}}\ *A,\ *B;}
\DoxyCodeLine{00417\ \ \ \ \ btVector3\ AB,\ AO,\ tmp;}
\DoxyCodeLine{00418\ \ \ \ \ btScalar\ dot;}
\DoxyCodeLine{00419\ }
\DoxyCodeLine{00420\ \ \ \ \ \textcolor{comment}{//\ get\ last\ added\ as\ A}}
\DoxyCodeLine{00421\ \ \ \ \ A\ =\ ccdSimplexLast(simplex);}
\DoxyCodeLine{00422\ \ \ \ \ \textcolor{comment}{//\ get\ the\ other\ point}}
\DoxyCodeLine{00423\ \ \ \ \ B\ =\ btSimplexPoint(simplex,\ 0);}
\DoxyCodeLine{00424\ \ \ \ \ \textcolor{comment}{//\ compute\ AB\ oriented\ segment}}
\DoxyCodeLine{00425\ \ \ \ \ btVec3Sub2(\&AB,\ \&B-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}},\ \&A-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}});}
\DoxyCodeLine{00426\ \ \ \ \ \textcolor{comment}{//\ compute\ AO\ vector}}
\DoxyCodeLine{00427\ \ \ \ \ btVec3Copy(\&AO,\ \&A-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}});}
\DoxyCodeLine{00428\ \ \ \ \ btVec3Scale(\&AO,\ -\/btScalar(1));}
\DoxyCodeLine{00429\ }
\DoxyCodeLine{00430\ \ \ \ \ \textcolor{comment}{//\ dot\ product\ AB\ .\ AO}}
\DoxyCodeLine{00431\ \ \ \ \ dot\ =\ btVec3Dot(\&AB,\ \&AO);}
\DoxyCodeLine{00432\ }
\DoxyCodeLine{00433\ \ \ \ \ \textcolor{comment}{//\ check\ if\ origin\ doesn't\ lie\ on\ AB\ segment}}
\DoxyCodeLine{00434\ \ \ \ \ btVec3Cross(\&tmp,\ \&AB,\ \&AO);}
\DoxyCodeLine{00435\ \ \ \ \ \textcolor{keywordflow}{if}\ (btFuzzyZero(btVec3Dot(\&tmp,\ \&tmp))\ \&\&\ dot\ >\ btScalar(0))}
\DoxyCodeLine{00436\ \ \ \ \ \{}
\DoxyCodeLine{00437\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{00438\ \ \ \ \ \}}
\DoxyCodeLine{00439\ }
\DoxyCodeLine{00440\ \ \ \ \ \textcolor{comment}{//\ check\ if\ origin\ is\ in\ area\ where\ AB\ segment\ is}}
\DoxyCodeLine{00441\ \ \ \ \ \textcolor{keywordflow}{if}\ (btFuzzyZero(dot)\ ||\ dot\ <\ btScalar(0))}
\DoxyCodeLine{00442\ \ \ \ \ \{}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ origin\ is\ in\ outside\ are\ of\ A}}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \ \ btSimplexSet(simplex,\ 0,\ A);}
\DoxyCodeLine{00445\ \ \ \ \ \ \ \ \ btSimplexSetSize(simplex,\ 1);}
\DoxyCodeLine{00446\ \ \ \ \ \ \ \ \ btVec3Copy(dir,\ \&AO);}
\DoxyCodeLine{00447\ \ \ \ \ \}}
\DoxyCodeLine{00448\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00449\ \ \ \ \ \{}
\DoxyCodeLine{00450\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ origin\ is\ in\ area\ where\ AB\ segment\ is}}
\DoxyCodeLine{00451\ }
\DoxyCodeLine{00452\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ keep\ simplex\ untouched\ and\ set\ direction\ to}}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ AB\ x\ AO\ x\ AB}}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ btTripleCross(\&AB,\ \&AO,\ \&AB,\ dir);}
\DoxyCodeLine{00455\ \ \ \ \ \}}
\DoxyCodeLine{00456\ }
\DoxyCodeLine{00457\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00458\ \}}
\DoxyCodeLine{00459\ }
\DoxyCodeLine{00460\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ btDoSimplex3(\mbox{\hyperlink{structbt_simplex}{btSimplex}}\ *simplex,\ btVector3\ *dir)}
\DoxyCodeLine{00461\ \{}
\DoxyCodeLine{00462\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structbt_support_vector}{btSupportVector}}\ *A,\ *B,\ *C;}
\DoxyCodeLine{00463\ \ \ \ \ btVector3\ AO,\ AB,\ AC,\ ABC,\ tmp;}
\DoxyCodeLine{00464\ \ \ \ \ btScalar\ dot,\ dist;}
\DoxyCodeLine{00465\ }
\DoxyCodeLine{00466\ \ \ \ \ \textcolor{comment}{//\ get\ last\ added\ as\ A}}
\DoxyCodeLine{00467\ \ \ \ \ A\ =\ ccdSimplexLast(simplex);}
\DoxyCodeLine{00468\ \ \ \ \ \textcolor{comment}{//\ get\ the\ other\ points}}
\DoxyCodeLine{00469\ \ \ \ \ B\ =\ btSimplexPoint(simplex,\ 1);}
\DoxyCodeLine{00470\ \ \ \ \ C\ =\ btSimplexPoint(simplex,\ 0);}
\DoxyCodeLine{00471\ }
\DoxyCodeLine{00472\ \ \ \ \ \textcolor{comment}{//\ check\ touching\ contact}}
\DoxyCodeLine{00473\ \ \ \ \ dist\ =\ btVec3PointTriDist2(\&ccd\_vec3\_origin,\ \&A-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}},\ \&B-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}},\ \&C-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}},\ 0);}
\DoxyCodeLine{00474\ \ \ \ \ \textcolor{keywordflow}{if}\ (btFuzzyZero(dist))}
\DoxyCodeLine{00475\ \ \ \ \ \{}
\DoxyCodeLine{00476\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{00477\ \ \ \ \ \}}
\DoxyCodeLine{00478\ }
\DoxyCodeLine{00479\ \ \ \ \ \textcolor{comment}{//\ check\ if\ triangle\ is\ really\ triangle\ (has\ area\ >\ 0)}}
\DoxyCodeLine{00480\ \ \ \ \ \textcolor{comment}{//\ if\ not\ simplex\ can't\ be\ expanded\ and\ thus\ no\ itersection\ is\ found}}
\DoxyCodeLine{00481\ \ \ \ \ \textcolor{keywordflow}{if}\ (btVec3Eq(\&A-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}},\ \&B-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}})\ ||\ btVec3Eq(\&A-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}},\ \&C-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}}))}
\DoxyCodeLine{00482\ \ \ \ \ \{}
\DoxyCodeLine{00483\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00484\ \ \ \ \ \}}
\DoxyCodeLine{00485\ }
\DoxyCodeLine{00486\ \ \ \ \ \textcolor{comment}{//\ compute\ AO\ vector}}
\DoxyCodeLine{00487\ \ \ \ \ btVec3Copy(\&AO,\ \&A-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}});}
\DoxyCodeLine{00488\ \ \ \ \ btVec3Scale(\&AO,\ -\/btScalar(1));}
\DoxyCodeLine{00489\ }
\DoxyCodeLine{00490\ \ \ \ \ \textcolor{comment}{//\ compute\ AB\ and\ AC\ segments\ and\ ABC\ vector\ (perpendircular\ to\ triangle)}}
\DoxyCodeLine{00491\ \ \ \ \ btVec3Sub2(\&AB,\ \&B-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}},\ \&A-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}});}
\DoxyCodeLine{00492\ \ \ \ \ btVec3Sub2(\&AC,\ \&C-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}},\ \&A-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}});}
\DoxyCodeLine{00493\ \ \ \ \ btVec3Cross(\&ABC,\ \&AB,\ \&AC);}
\DoxyCodeLine{00494\ }
\DoxyCodeLine{00495\ \ \ \ \ btVec3Cross(\&tmp,\ \&ABC,\ \&AC);}
\DoxyCodeLine{00496\ \ \ \ \ dot\ =\ btVec3Dot(\&tmp,\ \&AO);}
\DoxyCodeLine{00497\ \ \ \ \ \textcolor{keywordflow}{if}\ (btFuzzyZero(dot)\ ||\ dot\ >\ btScalar(0))}
\DoxyCodeLine{00498\ \ \ \ \ \{}
\DoxyCodeLine{00499\ \ \ \ \ \ \ \ \ dot\ =\ btVec3Dot(\&AC,\ \&AO);}
\DoxyCodeLine{00500\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (btFuzzyZero(dot)\ ||\ dot\ >\ btScalar(0))}
\DoxyCodeLine{00501\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00502\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ C\ is\ already\ in\ place}}
\DoxyCodeLine{00503\ \ \ \ \ \ \ \ \ \ \ \ \ btSimplexSet(simplex,\ 1,\ A);}
\DoxyCodeLine{00504\ \ \ \ \ \ \ \ \ \ \ \ \ btSimplexSetSize(simplex,\ 2);}
\DoxyCodeLine{00505\ \ \ \ \ \ \ \ \ \ \ \ \ btTripleCross(\&AC,\ \&AO,\ \&AC,\ dir);}
\DoxyCodeLine{00506\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00507\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00508\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00509\ \ \ \ \ \ \ \ \ \ \ \ \ dot\ =\ btVec3Dot(\&AB,\ \&AO);}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (btFuzzyZero(dot)\ ||\ dot\ >\ btScalar(0))}
\DoxyCodeLine{00511\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00512\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btSimplexSet(simplex,\ 0,\ B);}
\DoxyCodeLine{00513\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btSimplexSet(simplex,\ 1,\ A);}
\DoxyCodeLine{00514\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btSimplexSetSize(simplex,\ 2);}
\DoxyCodeLine{00515\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btTripleCross(\&AB,\ \&AO,\ \&AB,\ dir);}
\DoxyCodeLine{00516\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00518\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00519\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btSimplexSet(simplex,\ 0,\ A);}
\DoxyCodeLine{00520\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btSimplexSetSize(simplex,\ 1);}
\DoxyCodeLine{00521\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVec3Copy(dir,\ \&AO);}
\DoxyCodeLine{00522\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00523\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00524\ \ \ \ \ \}}
\DoxyCodeLine{00525\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00526\ \ \ \ \ \{}
\DoxyCodeLine{00527\ \ \ \ \ \ \ \ \ btVec3Cross(\&tmp,\ \&AB,\ \&ABC);}
\DoxyCodeLine{00528\ \ \ \ \ \ \ \ \ dot\ =\ btVec3Dot(\&tmp,\ \&AO);}
\DoxyCodeLine{00529\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (btFuzzyZero(dot)\ ||\ dot\ >\ btScalar(0))}
\DoxyCodeLine{00530\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00531\ \ \ \ \ \ \ \ \ \ \ \ \ dot\ =\ btVec3Dot(\&AB,\ \&AO);}
\DoxyCodeLine{00532\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (btFuzzyZero(dot)\ ||\ dot\ >\ btScalar(0))}
\DoxyCodeLine{00533\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00534\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btSimplexSet(simplex,\ 0,\ B);}
\DoxyCodeLine{00535\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btSimplexSet(simplex,\ 1,\ A);}
\DoxyCodeLine{00536\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btSimplexSetSize(simplex,\ 2);}
\DoxyCodeLine{00537\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btTripleCross(\&AB,\ \&AO,\ \&AB,\ dir);}
\DoxyCodeLine{00538\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00539\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00540\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00541\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btSimplexSet(simplex,\ 0,\ A);}
\DoxyCodeLine{00542\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btSimplexSetSize(simplex,\ 1);}
\DoxyCodeLine{00543\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVec3Copy(dir,\ \&AO);}
\DoxyCodeLine{00544\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00545\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00546\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00547\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00548\ \ \ \ \ \ \ \ \ \ \ \ \ dot\ =\ btVec3Dot(\&ABC,\ \&AO);}
\DoxyCodeLine{00549\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (btFuzzyZero(dot)\ ||\ dot\ >\ btScalar(0))}
\DoxyCodeLine{00550\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00551\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVec3Copy(dir,\ \&ABC);}
\DoxyCodeLine{00552\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00553\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00554\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00555\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structbt_support_vector}{btSupportVector}}\ tmp;}
\DoxyCodeLine{00556\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btSupportCopy(\&tmp,\ C);}
\DoxyCodeLine{00557\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btSimplexSet(simplex,\ 0,\ B);}
\DoxyCodeLine{00558\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btSimplexSet(simplex,\ 1,\ \&tmp);}
\DoxyCodeLine{00559\ }
\DoxyCodeLine{00560\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVec3Copy(dir,\ \&ABC);}
\DoxyCodeLine{00561\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVec3Scale(dir,\ -\/btScalar(1));}
\DoxyCodeLine{00562\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00563\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00564\ \ \ \ \ \}}
\DoxyCodeLine{00565\ }
\DoxyCodeLine{00566\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00567\ \}}
\DoxyCodeLine{00568\ }
\DoxyCodeLine{00569\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ btDoSimplex4(\mbox{\hyperlink{structbt_simplex}{btSimplex}}\ *simplex,\ btVector3\ *dir)}
\DoxyCodeLine{00570\ \{}
\DoxyCodeLine{00571\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structbt_support_vector}{btSupportVector}}\ *A,\ *B,\ *C,\ *D;}
\DoxyCodeLine{00572\ \ \ \ \ btVector3\ AO,\ AB,\ AC,\ AD,\ ABC,\ ACD,\ ADB;}
\DoxyCodeLine{00573\ \ \ \ \ \textcolor{keywordtype}{int}\ B\_on\_ACD,\ C\_on\_ADB,\ D\_on\_ABC;}
\DoxyCodeLine{00574\ \ \ \ \ \textcolor{keywordtype}{int}\ AB\_O,\ AC\_O,\ AD\_O;}
\DoxyCodeLine{00575\ \ \ \ \ btScalar\ dist;}
\DoxyCodeLine{00576\ }
\DoxyCodeLine{00577\ \ \ \ \ \textcolor{comment}{//\ get\ last\ added\ as\ A}}
\DoxyCodeLine{00578\ \ \ \ \ A\ =\ ccdSimplexLast(simplex);}
\DoxyCodeLine{00579\ \ \ \ \ \textcolor{comment}{//\ get\ the\ other\ points}}
\DoxyCodeLine{00580\ \ \ \ \ B\ =\ btSimplexPoint(simplex,\ 2);}
\DoxyCodeLine{00581\ \ \ \ \ C\ =\ btSimplexPoint(simplex,\ 1);}
\DoxyCodeLine{00582\ \ \ \ \ D\ =\ btSimplexPoint(simplex,\ 0);}
\DoxyCodeLine{00583\ }
\DoxyCodeLine{00584\ \ \ \ \ \textcolor{comment}{//\ check\ if\ tetrahedron\ is\ really\ tetrahedron\ (has\ volume\ >\ 0)}}
\DoxyCodeLine{00585\ \ \ \ \ \textcolor{comment}{//\ if\ it\ is\ not\ simplex\ can't\ be\ expanded\ and\ thus\ no\ intersection\ is}}
\DoxyCodeLine{00586\ \ \ \ \ \textcolor{comment}{//\ found}}
\DoxyCodeLine{00587\ \ \ \ \ dist\ =\ btVec3PointTriDist2(\&A-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}},\ \&B-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}},\ \&C-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}},\ \&D-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}},\ 0);}
\DoxyCodeLine{00588\ \ \ \ \ \textcolor{keywordflow}{if}\ (btFuzzyZero(dist))}
\DoxyCodeLine{00589\ \ \ \ \ \{}
\DoxyCodeLine{00590\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00591\ \ \ \ \ \}}
\DoxyCodeLine{00592\ }
\DoxyCodeLine{00593\ \ \ \ \ \textcolor{comment}{//\ check\ if\ origin\ lies\ on\ some\ of\ tetrahedron's\ face\ -\/\ if\ so\ objects}}
\DoxyCodeLine{00594\ \ \ \ \ \textcolor{comment}{//\ intersect}}
\DoxyCodeLine{00595\ \ \ \ \ dist\ =\ btVec3PointTriDist2(\&ccd\_vec3\_origin,\ \&A-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}},\ \&B-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}},\ \&C-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}},\ 0);}
\DoxyCodeLine{00596\ \ \ \ \ \textcolor{keywordflow}{if}\ (btFuzzyZero(dist))}
\DoxyCodeLine{00597\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{00598\ \ \ \ \ dist\ =\ btVec3PointTriDist2(\&ccd\_vec3\_origin,\ \&A-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}},\ \&C-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}},\ \&D-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}},\ 0);}
\DoxyCodeLine{00599\ \ \ \ \ \textcolor{keywordflow}{if}\ (btFuzzyZero(dist))}
\DoxyCodeLine{00600\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{00601\ \ \ \ \ dist\ =\ btVec3PointTriDist2(\&ccd\_vec3\_origin,\ \&A-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}},\ \&B-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}},\ \&D-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}},\ 0);}
\DoxyCodeLine{00602\ \ \ \ \ \textcolor{keywordflow}{if}\ (btFuzzyZero(dist))}
\DoxyCodeLine{00603\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{00604\ \ \ \ \ dist\ =\ btVec3PointTriDist2(\&ccd\_vec3\_origin,\ \&B-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}},\ \&C-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}},\ \&D-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}},\ 0);}
\DoxyCodeLine{00605\ \ \ \ \ \textcolor{keywordflow}{if}\ (btFuzzyZero(dist))}
\DoxyCodeLine{00606\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{00607\ }
\DoxyCodeLine{00608\ \ \ \ \ \textcolor{comment}{//\ compute\ AO,\ AB,\ AC,\ AD\ segments\ and\ ABC,\ ACD,\ ADB\ normal\ vectors}}
\DoxyCodeLine{00609\ \ \ \ \ btVec3Copy(\&AO,\ \&A-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}});}
\DoxyCodeLine{00610\ \ \ \ \ btVec3Scale(\&AO,\ -\/btScalar(1));}
\DoxyCodeLine{00611\ \ \ \ \ btVec3Sub2(\&AB,\ \&B-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}},\ \&A-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}});}
\DoxyCodeLine{00612\ \ \ \ \ btVec3Sub2(\&AC,\ \&C-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}},\ \&A-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}});}
\DoxyCodeLine{00613\ \ \ \ \ btVec3Sub2(\&AD,\ \&D-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}},\ \&A-\/>\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}});}
\DoxyCodeLine{00614\ \ \ \ \ btVec3Cross(\&ABC,\ \&AB,\ \&AC);}
\DoxyCodeLine{00615\ \ \ \ \ btVec3Cross(\&ACD,\ \&AC,\ \&AD);}
\DoxyCodeLine{00616\ \ \ \ \ btVec3Cross(\&ADB,\ \&AD,\ \&AB);}
\DoxyCodeLine{00617\ }
\DoxyCodeLine{00618\ \ \ \ \ \textcolor{comment}{//\ side\ (positive\ or\ negative)\ of\ B,\ C,\ D\ relative\ to\ planes\ ACD,\ ADB}}
\DoxyCodeLine{00619\ \ \ \ \ \textcolor{comment}{//\ and\ ABC\ respectively}}
\DoxyCodeLine{00620\ \ \ \ \ B\_on\_ACD\ =\ ccdSign(btVec3Dot(\&ACD,\ \&AB));}
\DoxyCodeLine{00621\ \ \ \ \ C\_on\_ADB\ =\ ccdSign(btVec3Dot(\&ADB,\ \&AC));}
\DoxyCodeLine{00622\ \ \ \ \ D\_on\_ABC\ =\ ccdSign(btVec3Dot(\&ABC,\ \&AD));}
\DoxyCodeLine{00623\ }
\DoxyCodeLine{00624\ \ \ \ \ \textcolor{comment}{//\ whether\ origin\ is\ on\ same\ side\ of\ ACD,\ ADB,\ ABC\ as\ B,\ C,\ D}}
\DoxyCodeLine{00625\ \ \ \ \ \textcolor{comment}{//\ respectively}}
\DoxyCodeLine{00626\ \ \ \ \ AB\_O\ =\ ccdSign(btVec3Dot(\&ACD,\ \&AO))\ ==\ B\_on\_ACD;}
\DoxyCodeLine{00627\ \ \ \ \ AC\_O\ =\ ccdSign(btVec3Dot(\&ADB,\ \&AO))\ ==\ C\_on\_ADB;}
\DoxyCodeLine{00628\ \ \ \ \ AD\_O\ =\ ccdSign(btVec3Dot(\&ABC,\ \&AO))\ ==\ D\_on\_ABC;}
\DoxyCodeLine{00629\ }
\DoxyCodeLine{00630\ \ \ \ \ \textcolor{keywordflow}{if}\ (AB\_O\ \&\&\ AC\_O\ \&\&\ AD\_O)}
\DoxyCodeLine{00631\ \ \ \ \ \{}
\DoxyCodeLine{00632\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ origin\ is\ in\ tetrahedron}}
\DoxyCodeLine{00633\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{00634\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ rearrange\ simplex\ to\ triangle\ and\ call\ btDoSimplex3()}}
\DoxyCodeLine{00635\ \ \ \ \ \}}
\DoxyCodeLine{00636\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!AB\_O)}
\DoxyCodeLine{00637\ \ \ \ \ \{}
\DoxyCodeLine{00638\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ B\ is\ farthest\ from\ the\ origin\ among\ all\ of\ the\ tetrahedron's}}
\DoxyCodeLine{00639\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ points,\ so\ remove\ it\ from\ the\ list\ and\ go\ on\ with\ the\ triangle}}
\DoxyCodeLine{00640\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ case}}
\DoxyCodeLine{00641\ }
\DoxyCodeLine{00642\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ D\ and\ C\ are\ in\ place}}
\DoxyCodeLine{00643\ \ \ \ \ \ \ \ \ btSimplexSet(simplex,\ 2,\ A);}
\DoxyCodeLine{00644\ \ \ \ \ \ \ \ \ btSimplexSetSize(simplex,\ 3);}
\DoxyCodeLine{00645\ \ \ \ \ \}}
\DoxyCodeLine{00646\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!AC\_O)}
\DoxyCodeLine{00647\ \ \ \ \ \{}
\DoxyCodeLine{00648\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ C\ is\ farthest}}
\DoxyCodeLine{00649\ \ \ \ \ \ \ \ \ btSimplexSet(simplex,\ 1,\ D);}
\DoxyCodeLine{00650\ \ \ \ \ \ \ \ \ btSimplexSet(simplex,\ 0,\ B);}
\DoxyCodeLine{00651\ \ \ \ \ \ \ \ \ btSimplexSet(simplex,\ 2,\ A);}
\DoxyCodeLine{00652\ \ \ \ \ \ \ \ \ btSimplexSetSize(simplex,\ 3);}
\DoxyCodeLine{00653\ \ \ \ \ \}}
\DoxyCodeLine{00654\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00655\ \ \ \ \ \{\ \ \textcolor{comment}{//\ (!AD\_O)}}
\DoxyCodeLine{00656\ \ \ \ \ \ \ \ \ btSimplexSet(simplex,\ 0,\ C);}
\DoxyCodeLine{00657\ \ \ \ \ \ \ \ \ btSimplexSet(simplex,\ 1,\ B);}
\DoxyCodeLine{00658\ \ \ \ \ \ \ \ \ btSimplexSet(simplex,\ 2,\ A);}
\DoxyCodeLine{00659\ \ \ \ \ \ \ \ \ btSimplexSetSize(simplex,\ 3);}
\DoxyCodeLine{00660\ \ \ \ \ \}}
\DoxyCodeLine{00661\ }
\DoxyCodeLine{00662\ \ \ \ \ \textcolor{keywordflow}{return}\ btDoSimplex3(simplex,\ dir);}
\DoxyCodeLine{00663\ \}}
\DoxyCodeLine{00664\ }
\DoxyCodeLine{00665\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ btDoSimplex(\mbox{\hyperlink{structbt_simplex}{btSimplex}}\ *simplex,\ btVector3\ *dir)}
\DoxyCodeLine{00666\ \{}
\DoxyCodeLine{00667\ \ \ \ \ \textcolor{keywordflow}{if}\ (btSimplexSize(simplex)\ ==\ 2)}
\DoxyCodeLine{00668\ \ \ \ \ \{}
\DoxyCodeLine{00669\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ simplex\ contains\ segment\ only\ one\ segment}}
\DoxyCodeLine{00670\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ btDoSimplex2(simplex,\ dir);}
\DoxyCodeLine{00671\ \ \ \ \ \}}
\DoxyCodeLine{00672\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (btSimplexSize(simplex)\ ==\ 3)}
\DoxyCodeLine{00673\ \ \ \ \ \{}
\DoxyCodeLine{00674\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ simplex\ contains\ triangle}}
\DoxyCodeLine{00675\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ btDoSimplex3(simplex,\ dir);}
\DoxyCodeLine{00676\ \ \ \ \ \}}
\DoxyCodeLine{00677\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00678\ \ \ \ \ \{\ \ \textcolor{comment}{//\ btSimplexSize(simplex)\ ==\ 4}}
\DoxyCodeLine{00679\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ tetrahedron\ -\/\ this\ is\ the\ only\ shape\ which\ can\ encapsule\ origin}}
\DoxyCodeLine{00680\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ so\ btDoSimplex4()\ also\ contains\ test\ on\ it}}
\DoxyCodeLine{00681\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ btDoSimplex4(simplex,\ dir);}
\DoxyCodeLine{00682\ \ \ \ \ \}}
\DoxyCodeLine{00683\ \}}
\DoxyCodeLine{00684\ }
\DoxyCodeLine{00685\ \textcolor{preprocessor}{\#ifdef\ \_\_SPU\_\_}}
\DoxyCodeLine{00686\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classbt_gjk_pair_detector_abc29953dd7aee59e9ca887963c26c8c2}{btGjkPairDetector::getClosestPointsNonVirtual}}(\textcolor{keyword}{const}\ ClosestPointInput\ \&input,\ Result\ \&output,\ \textcolor{keyword}{class}\ \mbox{\hyperlink{classbt_i_debug_draw}{btIDebugDraw}}\ *debugDraw)}
\DoxyCodeLine{00687\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00688\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classbt_gjk_pair_detector_abc29953dd7aee59e9ca887963c26c8c2}{btGjkPairDetector::getClosestPointsNonVirtual}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structbt_discrete_collision_detector_interface_1_1_closest_point_input}{ClosestPointInput}}\ \&input,\ \mbox{\hyperlink{structbt_discrete_collision_detector_interface_1_1_result}{Result}}\ \&output,\ \textcolor{keyword}{class}\ \mbox{\hyperlink{classbt_i_debug_draw}{btIDebugDraw}}\ *debugDraw)}
\DoxyCodeLine{00689\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00690\ \{}
\DoxyCodeLine{00691\ \ \ \ \ m\_cachedSeparatingDistance\ =\ 0.f;}
\DoxyCodeLine{00692\ }
\DoxyCodeLine{00693\ \ \ \ \ btScalar\ distance\ =\ btScalar(0.);}
\DoxyCodeLine{00694\ \ \ \ \ btVector3\ normalInB(btScalar(0.),\ btScalar(0.),\ btScalar(0.));}
\DoxyCodeLine{00695\ }
\DoxyCodeLine{00696\ \ \ \ \ btVector3\ pointOnA,\ pointOnB;}
\DoxyCodeLine{00697\ \ \ \ \ btTransform\ localTransA\ =\ input.m\_transformA;}
\DoxyCodeLine{00698\ \ \ \ \ btTransform\ localTransB\ =\ input.m\_transformB;}
\DoxyCodeLine{00699\ \ \ \ \ btVector3\ positionOffset\ =\ (localTransA.getOrigin()\ +\ localTransB.getOrigin())\ *\ btScalar(0.5);}
\DoxyCodeLine{00700\ \ \ \ \ localTransA.getOrigin()\ -\/=\ positionOffset;}
\DoxyCodeLine{00701\ \ \ \ \ localTransB.getOrigin()\ -\/=\ positionOffset;}
\DoxyCodeLine{00702\ }
\DoxyCodeLine{00703\ \ \ \ \ \textcolor{keywordtype}{bool}\ check2d\ =\ m\_minkowskiA-\/>isConvex2d()\ \&\&\ m\_minkowskiB-\/>isConvex2d();}
\DoxyCodeLine{00704\ }
\DoxyCodeLine{00705\ \ \ \ \ btScalar\ marginA\ =\ m\_marginA;}
\DoxyCodeLine{00706\ \ \ \ \ btScalar\ marginB\ =\ m\_marginB;}
\DoxyCodeLine{00707\ }
\DoxyCodeLine{00708\ }
\DoxyCodeLine{00709\ \ \ \ \ \textcolor{comment}{//for\ CCD\ we\ don't\ use\ margins}}
\DoxyCodeLine{00710\ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_ignoreMargin)}
\DoxyCodeLine{00711\ \ \ \ \ \{}
\DoxyCodeLine{00712\ \ \ \ \ \ \ \ \ marginA\ =\ btScalar(0.);}
\DoxyCodeLine{00713\ \ \ \ \ \ \ \ \ marginB\ =\ btScalar(0.);}
\DoxyCodeLine{00714\ \ \ \ \ \}}
\DoxyCodeLine{00715\ }
\DoxyCodeLine{00716\ \ \ \ \ m\_curIter\ =\ 0;}
\DoxyCodeLine{00717\ \ \ \ \ \textcolor{keywordtype}{int}\ gGjkMaxIter\ =\ 1000;\ \ \textcolor{comment}{//this\ is\ to\ catch\ invalid\ input,\ perhaps\ check\ for\ \#NaN?}}
\DoxyCodeLine{00718\ \ \ \ \ m\_cachedSeparatingAxis.setValue(0,\ 1,\ 0);}
\DoxyCodeLine{00719\ }
\DoxyCodeLine{00720\ \ \ \ \ \textcolor{keywordtype}{bool}\ isValid\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00721\ \ \ \ \ \textcolor{keywordtype}{bool}\ checkSimplex\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00722\ \ \ \ \ \textcolor{keywordtype}{bool}\ checkPenetration\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00723\ \ \ \ \ m\_degenerateSimplex\ =\ 0;}
\DoxyCodeLine{00724\ }
\DoxyCodeLine{00725\ \ \ \ \ m\_lastUsedMethod\ =\ -\/1;}
\DoxyCodeLine{00726\ \ \ \ \ \textcolor{keywordtype}{int}\ status\ =\ -\/2;}
\DoxyCodeLine{00727\ \ \ \ \ btVector3\ orgNormalInB(0,\ 0,\ 0);}
\DoxyCodeLine{00728\ \ \ \ \ btScalar\ margin\ =\ marginA\ +\ marginB;}
\DoxyCodeLine{00729\ }
\DoxyCodeLine{00730\ \ \ \ \ \textcolor{comment}{//we\ add\ a\ separate\ implementation\ to\ check\ if\ the\ convex\ shapes\ intersect}}
\DoxyCodeLine{00731\ \ \ \ \ \textcolor{comment}{//See\ also\ "{}Real-\/time\ Collision\ Detection\ with\ Implicit\ Objects"{}\ by\ Leif\ Olvang}}
\DoxyCodeLine{00732\ \ \ \ \ \textcolor{comment}{//Todo:\ integrate\ the\ simplex\ penetration\ check\ directly\ inside\ the\ Bullet\ btVoronoiSimplexSolver}}
\DoxyCodeLine{00733\ \ \ \ \ \textcolor{comment}{//and\ remove\ this\ temporary\ code\ from\ libCCD}}
\DoxyCodeLine{00734\ \ \ \ \ \textcolor{comment}{//this\ fixes\ issue\ https://github.com/bulletphysics/bullet3/issues/1703}}
\DoxyCodeLine{00735\ \ \ \ \ \textcolor{comment}{//note,\ for\ large\ differences\ in\ shapes,\ use\ double\ precision\ build!}}
\DoxyCodeLine{00736\ \ \ \ \ \{}
\DoxyCodeLine{00737\ \ \ \ \ \ \ \ \ btScalar\ squaredDistance\ =\ BT\_LARGE\_FLOAT;}
\DoxyCodeLine{00738\ \ \ \ \ \ \ \ \ btScalar\ delta\ =\ btScalar(0.);}
\DoxyCodeLine{00739\ }
\DoxyCodeLine{00740\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structbt_simplex}{btSimplex}}\ simplex1;}
\DoxyCodeLine{00741\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structbt_simplex}{btSimplex}}\ *simplex\ =\ \&simplex1;}
\DoxyCodeLine{00742\ \ \ \ \ \ \ \ \ btSimplexInit(simplex);}
\DoxyCodeLine{00743\ }
\DoxyCodeLine{00744\ \ \ \ \ \ \ \ \ btVector3\ dir(1,\ 0,\ 0);}
\DoxyCodeLine{00745\ }
\DoxyCodeLine{00746\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00747\ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ lastSupV;}
\DoxyCodeLine{00748\ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ supAworld;}
\DoxyCodeLine{00749\ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ supBworld;}
\DoxyCodeLine{00750\ \ \ \ \ \ \ \ \ \ \ \ \ btComputeSupport(m\_minkowskiA,\ localTransA,\ m\_minkowskiB,\ localTransB,\ dir,\ check2d,\ supAworld,\ supBworld,\ lastSupV);}
\DoxyCodeLine{00751\ }
\DoxyCodeLine{00752\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structbt_support_vector}{btSupportVector}}\ last;}
\DoxyCodeLine{00753\ \ \ \ \ \ \ \ \ \ \ \ \ last.\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}}\ =\ lastSupV;}
\DoxyCodeLine{00754\ \ \ \ \ \ \ \ \ \ \ \ \ last.\mbox{\hyperlink{structbt_support_vector_a8d1c19756c15c781286e715069746f5d}{v1}}\ =\ supAworld;}
\DoxyCodeLine{00755\ \ \ \ \ \ \ \ \ \ \ \ \ last.\mbox{\hyperlink{structbt_support_vector_a0c435fed23c213b39fe69fb40d784392}{v2}}\ =\ supBworld;}
\DoxyCodeLine{00756\ }
\DoxyCodeLine{00757\ \ \ \ \ \ \ \ \ \ \ \ \ btSimplexAdd(simplex,\ \&last);}
\DoxyCodeLine{00758\ }
\DoxyCodeLine{00759\ \ \ \ \ \ \ \ \ \ \ \ \ dir\ =\ -\/lastSupV;}
\DoxyCodeLine{00760\ }
\DoxyCodeLine{00761\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ start\ iterations}}
\DoxyCodeLine{00762\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ iterations\ =\ 0;\ iterations\ <\ gGjkMaxIter;\ iterations++)}
\DoxyCodeLine{00763\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00764\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ obtain\ support\ point}}
\DoxyCodeLine{00765\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btComputeSupport(m\_minkowskiA,\ localTransA,\ m\_minkowskiB,\ localTransB,\ dir,\ check2d,\ supAworld,\ supBworld,\ lastSupV);}
\DoxyCodeLine{00766\ }
\DoxyCodeLine{00767\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ check\ if\ farthest\ point\ in\ Minkowski\ difference\ in\ direction\ dir}}
\DoxyCodeLine{00768\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ isn't\ somewhere\ before\ origin\ (the\ test\ on\ negative\ dot\ product)}}
\DoxyCodeLine{00769\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ -\/\ because\ if\ it\ is,\ objects\ are\ not\ intersecting\ at\ all.}}
\DoxyCodeLine{00770\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ delta\ =\ lastSupV.dot(dir);}
\DoxyCodeLine{00771\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (delta\ <\ 0)}
\DoxyCodeLine{00772\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00773\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//no\ intersection,\ besides\ margin}}
\DoxyCodeLine{00774\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ status\ =\ -\/1;}
\DoxyCodeLine{00775\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00776\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00777\ }
\DoxyCodeLine{00778\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ add\ last\ support\ vector\ to\ simplex}}
\DoxyCodeLine{00779\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ last.\mbox{\hyperlink{structbt_support_vector_ae89e07a6ef2b121a9678a1e9889d0abe}{v}}\ =\ lastSupV;}
\DoxyCodeLine{00780\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ last.\mbox{\hyperlink{structbt_support_vector_a8d1c19756c15c781286e715069746f5d}{v1}}\ =\ supAworld;}
\DoxyCodeLine{00781\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ last.\mbox{\hyperlink{structbt_support_vector_a0c435fed23c213b39fe69fb40d784392}{v2}}\ =\ supBworld;}
\DoxyCodeLine{00782\ }
\DoxyCodeLine{00783\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btSimplexAdd(simplex,\ \&last);}
\DoxyCodeLine{00784\ }
\DoxyCodeLine{00785\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ btDoSimplex\ returns\ 1\ if\ objects\ intersect,\ -\/1\ if\ objects\ don't}}
\DoxyCodeLine{00786\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ intersect\ and\ 0\ if\ algorithm\ should\ continue}}
\DoxyCodeLine{00787\ }
\DoxyCodeLine{00788\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ newDir;}
\DoxyCodeLine{00789\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ do\_simplex\_res\ =\ btDoSimplex(simplex,\ \&dir);}
\DoxyCodeLine{00790\ }
\DoxyCodeLine{00791\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (do\_simplex\_res\ ==\ 1)}
\DoxyCodeLine{00792\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00793\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ status\ =\ 0;\ \ \textcolor{comment}{//\ intersection\ found}}
\DoxyCodeLine{00794\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00795\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00796\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (do\_simplex\_res\ ==\ -\/1)}
\DoxyCodeLine{00797\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00798\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ intersection\ not\ found}}
\DoxyCodeLine{00799\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ status\ =\ -\/1;}
\DoxyCodeLine{00800\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00801\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00802\ }
\DoxyCodeLine{00803\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (btFuzzyZero(btVec3Dot(\&dir,\ \&dir)))}
\DoxyCodeLine{00804\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00805\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ intersection\ not\ found}}
\DoxyCodeLine{00806\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ status\ =\ -\/1;}
\DoxyCodeLine{00807\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00808\ }
\DoxyCodeLine{00809\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (dir.length2()\ <\ SIMD\_EPSILON)}
\DoxyCodeLine{00810\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00811\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//no\ intersection,\ besides\ margin}}
\DoxyCodeLine{00812\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ status\ =\ -\/1;}
\DoxyCodeLine{00813\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00814\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00815\ }
\DoxyCodeLine{00816\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (dir.fuzzyZero())}
\DoxyCodeLine{00817\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00818\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ intersection\ not\ found}}
\DoxyCodeLine{00819\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ status\ =\ -\/1;}
\DoxyCodeLine{00820\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00821\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00822\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00823\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00824\ }
\DoxyCodeLine{00825\ \ \ \ \ \ \ \ \ m\_simplexSolver-\/>reset();}
\DoxyCodeLine{00826\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (status\ ==\ 0)}
\DoxyCodeLine{00827\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00828\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//status\ =\ 0;}}
\DoxyCodeLine{00829\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//printf("{}Intersect!\(\backslash\)n"{});}}
\DoxyCodeLine{00830\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00831\ }
\DoxyCodeLine{00832\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (status\ ==\ -\/1)}
\DoxyCodeLine{00833\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00834\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//printf("{}not\ intersect\(\backslash\)n"{});}}
\DoxyCodeLine{00835\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00836\ \ \ \ \ \ \ \ \ \textcolor{comment}{//printf("{}dir=\%f,\%f,\%f\(\backslash\)n"{},dir[0],dir[1],dir[2]);}}
\DoxyCodeLine{00837\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (1)}
\DoxyCodeLine{00838\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00839\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;;)}
\DoxyCodeLine{00840\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//while\ (true)}}
\DoxyCodeLine{00841\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00842\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ separatingAxisInA\ =\ (-\/m\_cachedSeparatingAxis)\ *\ localTransA.getBasis();}
\DoxyCodeLine{00843\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ separatingAxisInB\ =\ m\_cachedSeparatingAxis\ *\ localTransB.getBasis();}
\DoxyCodeLine{00844\ }
\DoxyCodeLine{00845\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ pInA\ =\ m\_minkowskiA-\/>localGetSupportVertexWithoutMarginNonVirtual(separatingAxisInA);}
\DoxyCodeLine{00846\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ qInB\ =\ m\_minkowskiB-\/>localGetSupportVertexWithoutMarginNonVirtual(separatingAxisInB);}
\DoxyCodeLine{00847\ }
\DoxyCodeLine{00848\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ pWorld\ =\ localTransA(pInA);}
\DoxyCodeLine{00849\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ qWorld\ =\ localTransB(qInB);}
\DoxyCodeLine{00850\ }
\DoxyCodeLine{00851\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (check2d)}
\DoxyCodeLine{00852\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00853\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pWorld[2]\ =\ 0.f;}
\DoxyCodeLine{00854\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ qWorld[2]\ =\ 0.f;}
\DoxyCodeLine{00855\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00856\ }
\DoxyCodeLine{00857\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ w\ =\ pWorld\ -\/\ qWorld;}
\DoxyCodeLine{00858\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ delta\ =\ m\_cachedSeparatingAxis.dot(w);}
\DoxyCodeLine{00859\ }
\DoxyCodeLine{00860\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ potential\ exit,\ they\ don't\ overlap}}
\DoxyCodeLine{00861\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((delta\ >\ btScalar(0.0))\ \&\&\ (delta\ *\ delta\ >\ squaredDistance\ *\ input.m\_maximumDistanceSquared))}
\DoxyCodeLine{00862\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00863\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_degenerateSimplex\ =\ 10;}
\DoxyCodeLine{00864\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ checkSimplex\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00865\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//checkPenetration\ =\ false;}}
\DoxyCodeLine{00866\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00867\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00868\ }
\DoxyCodeLine{00869\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//exit\ 0:\ the\ new\ point\ is\ already\ in\ the\ simplex,\ or\ we\ didn't\ come\ any\ closer}}
\DoxyCodeLine{00870\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_simplexSolver-\/>inSimplex(w))}
\DoxyCodeLine{00871\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00872\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_degenerateSimplex\ =\ 1;}
\DoxyCodeLine{00873\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ checkSimplex\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00874\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00875\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00876\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ are\ we\ getting\ any\ closer\ ?}}
\DoxyCodeLine{00877\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ f0\ =\ squaredDistance\ -\/\ delta;}
\DoxyCodeLine{00878\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ f1\ =\ squaredDistance\ *\ REL\_ERROR2;}
\DoxyCodeLine{00879\ }
\DoxyCodeLine{00880\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (f0\ <=\ f1)}
\DoxyCodeLine{00881\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00882\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (f0\ <=\ btScalar(0.))}
\DoxyCodeLine{00883\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00884\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_degenerateSimplex\ =\ 2;}
\DoxyCodeLine{00885\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00886\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00887\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00888\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_degenerateSimplex\ =\ 11;}
\DoxyCodeLine{00889\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00890\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ checkSimplex\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00891\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00892\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00893\ }
\DoxyCodeLine{00894\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//add\ current\ vertex\ to\ simplex}}
\DoxyCodeLine{00895\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_simplexSolver-\/>addVertex(w,\ pWorld,\ qWorld);}
\DoxyCodeLine{00896\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ newCachedSeparatingAxis;}
\DoxyCodeLine{00897\ }
\DoxyCodeLine{00898\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//calculate\ the\ closest\ point\ to\ the\ origin\ (update\ vector\ v)}}
\DoxyCodeLine{00899\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!m\_simplexSolver-\/>closest(newCachedSeparatingAxis))}
\DoxyCodeLine{00900\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00901\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_degenerateSimplex\ =\ 3;}
\DoxyCodeLine{00902\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ checkSimplex\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00903\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00904\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00905\ }
\DoxyCodeLine{00906\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (newCachedSeparatingAxis.length2()\ <\ REL\_ERROR2)}
\DoxyCodeLine{00907\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00908\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_cachedSeparatingAxis\ =\ newCachedSeparatingAxis;}
\DoxyCodeLine{00909\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_degenerateSimplex\ =\ 6;}
\DoxyCodeLine{00910\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ checkSimplex\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00911\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00912\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00913\ }
\DoxyCodeLine{00914\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ previousSquaredDistance\ =\ squaredDistance;}
\DoxyCodeLine{00915\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ squaredDistance\ =\ newCachedSeparatingAxis.length2();}
\DoxyCodeLine{00916\ \textcolor{preprocessor}{\#if\ 0}}
\DoxyCodeLine{00918\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (squaredDistance\ >\ previousSquaredDistance)}
\DoxyCodeLine{00919\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00920\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_degenerateSimplex\ =\ 7;}
\DoxyCodeLine{00921\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ squaredDistance\ =\ previousSquaredDistance;}
\DoxyCodeLine{00922\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ checkSimplex\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00923\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00924\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00925\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//}}
\DoxyCodeLine{00926\ }
\DoxyCodeLine{00927\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//redundant\ m\_simplexSolver-\/>compute\_points(pointOnA,\ pointOnB);}}
\DoxyCodeLine{00928\ }
\DoxyCodeLine{00929\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//are\ we\ getting\ any\ closer\ ?}}
\DoxyCodeLine{00930\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (previousSquaredDistance\ -\/\ squaredDistance\ <=\ SIMD\_EPSILON\ *\ previousSquaredDistance)}
\DoxyCodeLine{00931\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00932\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_simplexSolver-\/>backup\_closest(m\_cachedSeparatingAxis);}}
\DoxyCodeLine{00933\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ checkSimplex\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00934\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_degenerateSimplex\ =\ 12;}
\DoxyCodeLine{00935\ }
\DoxyCodeLine{00936\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00937\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00938\ }
\DoxyCodeLine{00939\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_cachedSeparatingAxis\ =\ newCachedSeparatingAxis;}
\DoxyCodeLine{00940\ }
\DoxyCodeLine{00941\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//degeneracy,\ this\ is\ typically\ due\ to\ invalid/uninitialized\ worldtransforms\ for\ a\ btCollisionObject}}
\DoxyCodeLine{00942\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_curIter++\ >\ gGjkMaxIter)}
\DoxyCodeLine{00943\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00944\ \textcolor{preprocessor}{\#if\ defined(DEBUG)\ ||\ defined(\_DEBUG)}}
\DoxyCodeLine{00945\ }
\DoxyCodeLine{00946\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}btGjkPairDetector\ maxIter\ exceeded:\%i\(\backslash\)n"{}},\ m\_curIter);}
\DoxyCodeLine{00947\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}sepAxis=(\%f,\%f,\%f),\ squaredDistance\ =\ \%f,\ shapeTypeA=\%i,shapeTypeB=\%i\(\backslash\)n"{}},}
\DoxyCodeLine{00948\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_cachedSeparatingAxis.getX(),}
\DoxyCodeLine{00949\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_cachedSeparatingAxis.getY(),}
\DoxyCodeLine{00950\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_cachedSeparatingAxis.getZ(),}
\DoxyCodeLine{00951\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ squaredDistance,}
\DoxyCodeLine{00952\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_minkowskiA-\/>getShapeType(),}
\DoxyCodeLine{00953\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_minkowskiB-\/>getShapeType());}
\DoxyCodeLine{00954\ }
\DoxyCodeLine{00955\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00956\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00957\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00958\ }
\DoxyCodeLine{00959\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ check\ =\ (!m\_simplexSolver-\/>fullSimplex());}
\DoxyCodeLine{00960\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//bool\ check\ =\ (!m\_simplexSolver-\/>fullSimplex()\ \&\&\ squaredDistance\ >\ SIMD\_EPSILON\ *\ m\_simplexSolver-\/>maxVertex());}}
\DoxyCodeLine{00961\ }
\DoxyCodeLine{00962\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!check)}
\DoxyCodeLine{00963\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00964\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//do\ we\ need\ this\ backup\_closest\ here\ ?}}
\DoxyCodeLine{00965\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_simplexSolver-\/>backup\_closest(m\_cachedSeparatingAxis);}}
\DoxyCodeLine{00966\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_degenerateSimplex\ =\ 13;}
\DoxyCodeLine{00967\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00968\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00969\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00970\ }
\DoxyCodeLine{00971\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (checkSimplex)}
\DoxyCodeLine{00972\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00973\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_simplexSolver-\/>compute\_points(pointOnA,\ pointOnB);}
\DoxyCodeLine{00974\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ normalInB\ =\ m\_cachedSeparatingAxis;}
\DoxyCodeLine{00975\ }
\DoxyCodeLine{00976\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ lenSqr\ =\ m\_cachedSeparatingAxis.length2();}
\DoxyCodeLine{00977\ }
\DoxyCodeLine{00978\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//valid\ normal}}
\DoxyCodeLine{00979\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lenSqr\ <\ REL\_ERROR2)}
\DoxyCodeLine{00980\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00981\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_degenerateSimplex\ =\ 5;}
\DoxyCodeLine{00982\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00983\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lenSqr\ >\ SIMD\_EPSILON\ *\ SIMD\_EPSILON)}
\DoxyCodeLine{00984\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00985\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ rlen\ =\ btScalar(1.)\ /\ btSqrt(lenSqr);}
\DoxyCodeLine{00986\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ normalInB\ *=\ rlen;\ \ \textcolor{comment}{//normalize}}
\DoxyCodeLine{00987\ }
\DoxyCodeLine{00988\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ s\ =\ btSqrt(squaredDistance);}
\DoxyCodeLine{00989\ }
\DoxyCodeLine{00990\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btAssert(s\ >\ btScalar(0.0));}
\DoxyCodeLine{00991\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pointOnA\ -\/=\ m\_cachedSeparatingAxis\ *\ (marginA\ /\ s);}
\DoxyCodeLine{00992\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pointOnB\ +=\ m\_cachedSeparatingAxis\ *\ (marginB\ /\ s);}
\DoxyCodeLine{00993\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ distance\ =\ ((btScalar(1.)\ /\ rlen)\ -\/\ margin);}
\DoxyCodeLine{00994\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ isValid\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00995\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ orgNormalInB\ =\ normalInB;}
\DoxyCodeLine{00996\ }
\DoxyCodeLine{00997\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_lastUsedMethod\ =\ 1;}
\DoxyCodeLine{00998\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00999\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01000\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01001\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_lastUsedMethod\ =\ 2;}
\DoxyCodeLine{01002\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01003\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01004\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01005\ }
\DoxyCodeLine{01006\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ catchDegeneratePenetrationCase\ =}
\DoxyCodeLine{01007\ \ \ \ \ \ \ \ \ \ \ \ \ (m\_catchDegeneracies\ \&\&\ m\_penetrationDepthSolver\ \&\&\ m\_degenerateSimplex\ \&\&\ ((distance\ +\ margin)\ <\ gGjkEpaPenetrationTolerance));}
\DoxyCodeLine{01008\ }
\DoxyCodeLine{01009\ \ \ \ \ \ \ \ \ \textcolor{comment}{//if\ (checkPenetration\ \&\&\ !isValid)}}
\DoxyCodeLine{01010\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((checkPenetration\ \&\&\ (!isValid\ ||\ catchDegeneratePenetrationCase))\ ||\ (status\ ==\ 0))}
\DoxyCodeLine{01011\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01012\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//penetration\ case}}
\DoxyCodeLine{01013\ }
\DoxyCodeLine{01014\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//if\ there\ is\ no\ way\ to\ handle\ penetrations,\ bail\ out}}
\DoxyCodeLine{01015\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_penetrationDepthSolver)}
\DoxyCodeLine{01016\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01017\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Penetration\ depth\ case.}}
\DoxyCodeLine{01018\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ tmpPointOnA,\ tmpPointOnB;}
\DoxyCodeLine{01019\ }
\DoxyCodeLine{01020\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_cachedSeparatingAxis.setZero();}
\DoxyCodeLine{01021\ }
\DoxyCodeLine{01022\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ isValid2\ =\ m\_penetrationDepthSolver-\/>calcPenDepth(}
\DoxyCodeLine{01023\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *m\_simplexSolver,}
\DoxyCodeLine{01024\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_minkowskiA,\ m\_minkowskiB,}
\DoxyCodeLine{01025\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ localTransA,\ localTransB,}
\DoxyCodeLine{01026\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_cachedSeparatingAxis,\ tmpPointOnA,\ tmpPointOnB,}
\DoxyCodeLine{01027\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ debugDraw);}
\DoxyCodeLine{01028\ }
\DoxyCodeLine{01029\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_cachedSeparatingAxis.length2())}
\DoxyCodeLine{01030\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01031\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (isValid2)}
\DoxyCodeLine{01032\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01033\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ tmpNormalInB\ =\ tmpPointOnB\ -\/\ tmpPointOnA;}
\DoxyCodeLine{01034\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ lenSqr\ =\ tmpNormalInB.length2();}
\DoxyCodeLine{01035\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lenSqr\ <=\ (SIMD\_EPSILON\ *\ SIMD\_EPSILON))}
\DoxyCodeLine{01036\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01037\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tmpNormalInB\ =\ m\_cachedSeparatingAxis;}
\DoxyCodeLine{01038\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lenSqr\ =\ m\_cachedSeparatingAxis.length2();}
\DoxyCodeLine{01039\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01040\ }
\DoxyCodeLine{01041\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lenSqr\ >\ (SIMD\_EPSILON\ *\ SIMD\_EPSILON))}
\DoxyCodeLine{01042\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01043\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tmpNormalInB\ /=\ btSqrt(lenSqr);}
\DoxyCodeLine{01044\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ distance2\ =\ -\/(tmpPointOnA\ -\/\ tmpPointOnB).length();}
\DoxyCodeLine{01045\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_lastUsedMethod\ =\ 3;}
\DoxyCodeLine{01046\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//only\ replace\ valid\ penetrations\ when\ the\ result\ is\ deeper\ (check)}}
\DoxyCodeLine{01047\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!isValid\ ||\ (distance2\ <\ distance))}
\DoxyCodeLine{01048\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01049\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ distance\ =\ distance2;}
\DoxyCodeLine{01050\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pointOnA\ =\ tmpPointOnA;}
\DoxyCodeLine{01051\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pointOnB\ =\ tmpPointOnB;}
\DoxyCodeLine{01052\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ normalInB\ =\ tmpNormalInB;}
\DoxyCodeLine{01053\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ isValid\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01055\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01056\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01057\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_lastUsedMethod\ =\ 8;}
\DoxyCodeLine{01058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01061\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_lastUsedMethod\ =\ 9;}
\DoxyCodeLine{01063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01065\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01066\ }
\DoxyCodeLine{01067\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01073\ }
\DoxyCodeLine{01074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_cachedSeparatingAxis.length2()\ >\ btScalar(0.))}
\DoxyCodeLine{01075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ distance2\ =\ (tmpPointOnA\ -\/\ tmpPointOnB).length()\ -\/\ margin;}
\DoxyCodeLine{01077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//only\ replace\ valid\ distances\ when\ the\ distance\ is\ less}}
\DoxyCodeLine{01078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!isValid\ ||\ (distance2\ <\ distance))}
\DoxyCodeLine{01079\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01080\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ distance\ =\ distance2;}
\DoxyCodeLine{01081\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pointOnA\ =\ tmpPointOnA;}
\DoxyCodeLine{01082\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pointOnB\ =\ tmpPointOnB;}
\DoxyCodeLine{01083\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pointOnA\ -\/=\ m\_cachedSeparatingAxis\ *\ marginA;}
\DoxyCodeLine{01084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pointOnB\ +=\ m\_cachedSeparatingAxis\ *\ marginB;}
\DoxyCodeLine{01085\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ normalInB\ =\ m\_cachedSeparatingAxis;}
\DoxyCodeLine{01086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ normalInB.normalize();}
\DoxyCodeLine{01087\ }
\DoxyCodeLine{01088\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ isValid\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01089\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_lastUsedMethod\ =\ 6;}
\DoxyCodeLine{01090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01091\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01093\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_lastUsedMethod\ =\ 5;}
\DoxyCodeLine{01094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01095\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01096\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01097\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01098\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01099\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01100\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//printf("{}EPA\ didn't\ return\ a\ valid\ value\(\backslash\)n"{});}}
\DoxyCodeLine{01101\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01102\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01103\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01104\ \ \ \ \ \}}
\DoxyCodeLine{01105\ }
\DoxyCodeLine{01106\ \ \ \ \ \textcolor{keywordflow}{if}\ (isValid\ \&\&\ ((distance\ <\ 0)\ ||\ (distance\ *\ distance\ <\ input.m\_maximumDistanceSquared)))}
\DoxyCodeLine{01107\ \ \ \ \ \{}
\DoxyCodeLine{01108\ \ \ \ \ \ \ \ \ m\_cachedSeparatingAxis\ =\ normalInB;}
\DoxyCodeLine{01109\ \ \ \ \ \ \ \ \ m\_cachedSeparatingDistance\ =\ distance;}
\DoxyCodeLine{01110\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (1)}
\DoxyCodeLine{01111\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01116\ }
\DoxyCodeLine{01117\ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ d2\ =\ 0.f;}
\DoxyCodeLine{01118\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01119\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ separatingAxisInA\ =\ (-\/orgNormalInB)\ *\ localTransA.getBasis();}
\DoxyCodeLine{01120\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ separatingAxisInB\ =\ orgNormalInB\ *\ localTransB.getBasis();}
\DoxyCodeLine{01121\ }
\DoxyCodeLine{01122\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ pInA\ =\ m\_minkowskiA-\/>localGetSupportVertexWithoutMarginNonVirtual(separatingAxisInA);}
\DoxyCodeLine{01123\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ qInB\ =\ m\_minkowskiB-\/>localGetSupportVertexWithoutMarginNonVirtual(separatingAxisInB);}
\DoxyCodeLine{01124\ }
\DoxyCodeLine{01125\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ pWorld\ =\ localTransA(pInA);}
\DoxyCodeLine{01126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ qWorld\ =\ localTransB(qInB);}
\DoxyCodeLine{01127\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ w\ =\ pWorld\ -\/\ qWorld;}
\DoxyCodeLine{01128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d2\ =\ orgNormalInB.dot(w)\ -\/\ margin;}
\DoxyCodeLine{01129\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01130\ }
\DoxyCodeLine{01131\ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ d1\ =\ 0;}
\DoxyCodeLine{01132\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ separatingAxisInA\ =\ (normalInB)*localTransA.getBasis();}
\DoxyCodeLine{01134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ separatingAxisInB\ =\ -\/normalInB\ *\ localTransB.getBasis();}
\DoxyCodeLine{01135\ }
\DoxyCodeLine{01136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ pInA\ =\ m\_minkowskiA-\/>localGetSupportVertexWithoutMarginNonVirtual(separatingAxisInA);}
\DoxyCodeLine{01137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ qInB\ =\ m\_minkowskiB-\/>localGetSupportVertexWithoutMarginNonVirtual(separatingAxisInB);}
\DoxyCodeLine{01138\ }
\DoxyCodeLine{01139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ pWorld\ =\ localTransA(pInA);}
\DoxyCodeLine{01140\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ qWorld\ =\ localTransB(qInB);}
\DoxyCodeLine{01141\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ w\ =\ pWorld\ -\/\ qWorld;}
\DoxyCodeLine{01142\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d1\ =\ (-\/normalInB).dot(w)\ -\/\ margin;}
\DoxyCodeLine{01143\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01144\ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ d0\ =\ 0.f;}
\DoxyCodeLine{01145\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01146\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ separatingAxisInA\ =\ (-\/normalInB)\ *\ input.m\_transformA.getBasis();}
\DoxyCodeLine{01147\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ separatingAxisInB\ =\ normalInB\ *\ input.m\_transformB.getBasis();}
\DoxyCodeLine{01148\ }
\DoxyCodeLine{01149\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ pInA\ =\ m\_minkowskiA-\/>localGetSupportVertexWithoutMarginNonVirtual(separatingAxisInA);}
\DoxyCodeLine{01150\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ qInB\ =\ m\_minkowskiB-\/>localGetSupportVertexWithoutMarginNonVirtual(separatingAxisInB);}
\DoxyCodeLine{01151\ }
\DoxyCodeLine{01152\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ pWorld\ =\ localTransA(pInA);}
\DoxyCodeLine{01153\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ qWorld\ =\ localTransB(qInB);}
\DoxyCodeLine{01154\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btVector3\ w\ =\ pWorld\ -\/\ qWorld;}
\DoxyCodeLine{01155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d0\ =\ normalInB.dot(w)\ -\/\ margin;}
\DoxyCodeLine{01156\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01157\ }
\DoxyCodeLine{01158\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (d1\ >\ d0)}
\DoxyCodeLine{01159\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01160\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_lastUsedMethod\ =\ 10;}
\DoxyCodeLine{01161\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ normalInB\ *=\ -\/1;}
\DoxyCodeLine{01162\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01163\ }
\DoxyCodeLine{01164\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (orgNormalInB.length2())}
\DoxyCodeLine{01165\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01166\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (d2\ >\ d0\ \&\&\ d2\ >\ d1\ \&\&\ d2\ >\ distance)}
\DoxyCodeLine{01167\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01168\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ normalInB\ =\ orgNormalInB;}
\DoxyCodeLine{01169\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ distance\ =\ d2;}
\DoxyCodeLine{01170\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01171\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01172\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01173\ }
\DoxyCodeLine{01174\ \ \ \ \ \ \ \ \ output.addContactPoint(}
\DoxyCodeLine{01175\ \ \ \ \ \ \ \ \ \ \ \ \ normalInB,}
\DoxyCodeLine{01176\ \ \ \ \ \ \ \ \ \ \ \ \ pointOnB\ +\ positionOffset,}
\DoxyCodeLine{01177\ \ \ \ \ \ \ \ \ \ \ \ \ distance);}
\DoxyCodeLine{01178\ \ \ \ \ \}}
\DoxyCodeLine{01179\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01180\ \ \ \ \ \{}
\DoxyCodeLine{01181\ \ \ \ \ \ \ \ \ \textcolor{comment}{//printf("{}invalid\ gjk\ query\(\backslash\)n"{});}}
\DoxyCodeLine{01182\ \ \ \ \ \}}
\DoxyCodeLine{01183\ \}}

\end{DoxyCode}
