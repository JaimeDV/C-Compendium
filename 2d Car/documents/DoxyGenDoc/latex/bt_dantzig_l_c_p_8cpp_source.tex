\doxysection{bt\+Dantzig\+LCP.\+cpp}
\hypertarget{bt_dantzig_l_c_p_8cpp_source}{}\label{bt_dantzig_l_c_p_8cpp_source}\index{C:/Users/Usuario/Documents/pruebas-\/c/Practica Animación/libraries/bullet-\/3.17/src/BulletDynamics/MLCPSolvers/btDantzigLCP.cpp@{C:/Users/Usuario/Documents/pruebas-\/c/Practica Animación/libraries/bullet-\/3.17/src/BulletDynamics/MLCPSolvers/btDantzigLCP.cpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*************************************************************************}}
\DoxyCodeLine{00002\ \textcolor{comment}{*\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *}}
\DoxyCodeLine{00003\ \textcolor{comment}{*\ Open\ Dynamics\ Engine,\ Copyright\ (C)\ 2001,2002\ Russell\ L.\ Smith.\ \ \ \ \ \ \ *}}
\DoxyCodeLine{00004\ \textcolor{comment}{*\ All\ rights\ reserved.\ \ Email:\ russ@q12.org\ \ \ Web:\ www.q12.org\ \ \ \ \ \ \ \ \ \ *}}
\DoxyCodeLine{00005\ \textcolor{comment}{*\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *}}
\DoxyCodeLine{00006\ \textcolor{comment}{*\ This\ library\ is\ free\ software;\ you\ can\ redistribute\ it\ and/or\ \ \ \ \ \ \ \ \ *}}
\DoxyCodeLine{00007\ \textcolor{comment}{*\ modify\ it\ under\ the\ terms\ of\ EITHER:\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *}}
\DoxyCodeLine{00008\ \textcolor{comment}{*\ \ \ (1)\ The\ GNU\ Lesser\ General\ Public\ License\ as\ published\ by\ the\ Free\ \ *}}
\DoxyCodeLine{00009\ \textcolor{comment}{*\ \ \ \ \ \ \ Software\ Foundation;\ either\ version\ 2.1\ of\ the\ License,\ or\ (at\ \ *}}
\DoxyCodeLine{00010\ \textcolor{comment}{*\ \ \ \ \ \ \ your\ option)\ any\ later\ version.\ The\ text\ of\ the\ GNU\ Lesser\ \ \ \ \ \ *}}
\DoxyCodeLine{00011\ \textcolor{comment}{*\ \ \ \ \ \ \ General\ Public\ License\ is\ included\ with\ this\ library\ in\ the\ \ \ \ \ *}}
\DoxyCodeLine{00012\ \textcolor{comment}{*\ \ \ \ \ \ \ file\ LICENSE.TXT.\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *}}
\DoxyCodeLine{00013\ \textcolor{comment}{*\ \ \ (2)\ The\ BSD-\/style\ license\ that\ is\ included\ with\ this\ library\ in\ \ \ \ \ *}}
\DoxyCodeLine{00014\ \textcolor{comment}{*\ \ \ \ \ \ \ the\ file\ LICENSE-\/BSD.TXT.\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *}}
\DoxyCodeLine{00015\ \textcolor{comment}{*\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *}}
\DoxyCodeLine{00016\ \textcolor{comment}{*\ This\ library\ is\ distributed\ in\ the\ hope\ that\ it\ will\ be\ useful,\ \ \ \ \ \ \ *}}
\DoxyCodeLine{00017\ \textcolor{comment}{*\ but\ WITHOUT\ ANY\ WARRANTY;\ without\ even\ the\ implied\ warranty\ of\ \ \ \ \ \ \ \ *}}
\DoxyCodeLine{00018\ \textcolor{comment}{*\ MERCHANTABILITY\ or\ FITNESS\ FOR\ A\ PARTICULAR\ PURPOSE.\ See\ the\ files\ \ \ \ *}}
\DoxyCodeLine{00019\ \textcolor{comment}{*\ LICENSE.TXT\ and\ LICENSE-\/BSD.TXT\ for\ more\ details.\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *}}
\DoxyCodeLine{00020\ \textcolor{comment}{*\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *}}
\DoxyCodeLine{00021\ \textcolor{comment}{*************************************************************************/}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{comment}{/*}}
\DoxyCodeLine{00024\ \textcolor{comment}{}}
\DoxyCodeLine{00025\ \textcolor{comment}{}}
\DoxyCodeLine{00026\ \textcolor{comment}{THE\ ALGORITHM}}
\DoxyCodeLine{00027\ \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00028\ \textcolor{comment}{}}
\DoxyCodeLine{00029\ \textcolor{comment}{solve\ A*x\ =\ b+w,\ with\ x\ and\ w\ subject\ to\ certain\ LCP\ conditions.}}
\DoxyCodeLine{00030\ \textcolor{comment}{each\ x(i),w(i)\ must\ lie\ on\ one\ of\ the\ three\ line\ segments\ in\ the\ following}}
\DoxyCodeLine{00031\ \textcolor{comment}{diagram.\ each\ line\ segment\ corresponds\ to\ one\ index\ set\ :}}
\DoxyCodeLine{00032\ \textcolor{comment}{}}
\DoxyCodeLine{00033\ \textcolor{comment}{\ \ \ \ \ w(i)}}
\DoxyCodeLine{00034\ \textcolor{comment}{\ \ \ \ \ /|\(\backslash\)\ \ \ \ \ \ |\ \ \ \ \ \ \ \ \ \ \ :}}
\DoxyCodeLine{00035\ \textcolor{comment}{\ \ \ \ \ \ |\ \ \ \ \ \ \ |\ \ \ \ \ \ \ \ \ \ \ :}}
\DoxyCodeLine{00036\ \textcolor{comment}{\ \ \ \ \ \ |\ \ \ \ \ \ \ |i\ in\ N\ \ \ \ \ :}}
\DoxyCodeLine{00037\ \textcolor{comment}{\ \ w>0\ |\ \ \ \ \ \ \ |state[i]=0\ :}}
\DoxyCodeLine{00038\ \textcolor{comment}{\ \ \ \ \ \ |\ \ \ \ \ \ \ |\ \ \ \ \ \ \ \ \ \ \ :}}
\DoxyCodeLine{00039\ \textcolor{comment}{\ \ \ \ \ \ |\ \ \ \ \ \ \ |\ \ \ \ \ \ \ \ \ \ \ :\ \ i\ in\ C}}
\DoxyCodeLine{00040\ \textcolor{comment}{\ \ w=0\ +\ \ \ \ \ \ \ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+}}
\DoxyCodeLine{00041\ \textcolor{comment}{\ \ \ \ \ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00042\ \textcolor{comment}{\ \ \ \ \ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00043\ \textcolor{comment}{\ \ w<0\ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ \ \ |i\ in\ N}}
\DoxyCodeLine{00044\ \textcolor{comment}{\ \ \ \ \ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ \ \ |state[i]=1}}
\DoxyCodeLine{00045\ \textcolor{comment}{\ \ \ \ \ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00046\ \textcolor{comment}{\ \ \ \ \ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00047\ \textcolor{comment}{\ \ \ \ \ \ +-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/>\ x(i)}}
\DoxyCodeLine{00048\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ lo\ \ \ \ \ \ \ \ \ \ \ 0\ \ \ \ \ \ \ \ \ \ \ hi}}
\DoxyCodeLine{00049\ \textcolor{comment}{}}
\DoxyCodeLine{00050\ \textcolor{comment}{the\ Dantzig\ algorithm\ proceeds\ as\ follows:}}
\DoxyCodeLine{00051\ \textcolor{comment}{\ \ for\ i=1:n}}
\DoxyCodeLine{00052\ \textcolor{comment}{\ \ \ \ *\ if\ (x(i),w(i))\ is\ not\ on\ the\ line,\ push\ x(i)\ and\ w(i)\ positive\ or}}
\DoxyCodeLine{00053\ \textcolor{comment}{\ \ \ \ \ \ negative\ towards\ the\ line.\ as\ this\ is\ done,\ the\ other\ (x(j),w(j))}}
\DoxyCodeLine{00054\ \textcolor{comment}{\ \ \ \ \ \ for\ j<i\ are\ constrained\ to\ be\ on\ the\ line.\ if\ any\ (x,w)\ reaches\ the}}
\DoxyCodeLine{00055\ \textcolor{comment}{\ \ \ \ \ \ end\ of\ a\ line\ segment\ then\ it\ is\ switched\ between\ index\ sets.}}
\DoxyCodeLine{00056\ \textcolor{comment}{\ \ \ \ *\ i\ is\ added\ to\ the\ appropriate\ index\ set\ depending\ on\ what\ line\ segment}}
\DoxyCodeLine{00057\ \textcolor{comment}{\ \ \ \ \ \ it\ hits.}}
\DoxyCodeLine{00058\ \textcolor{comment}{}}
\DoxyCodeLine{00059\ \textcolor{comment}{we\ restrict\ lo(i)\ <=\ 0\ and\ hi(i)\ >=\ 0.\ this\ makes\ the\ algorithm\ a\ bit}}
\DoxyCodeLine{00060\ \textcolor{comment}{simpler,\ because\ the\ starting\ point\ for\ x(i),w(i)\ is\ always\ on\ the\ dotted}}
\DoxyCodeLine{00061\ \textcolor{comment}{line\ x=0\ and\ x\ will\ only\ ever\ increase\ in\ one\ direction,\ so\ it\ can\ only\ hit}}
\DoxyCodeLine{00062\ \textcolor{comment}{two\ out\ of\ the\ three\ line\ segments.}}
\DoxyCodeLine{00063\ \textcolor{comment}{}}
\DoxyCodeLine{00064\ \textcolor{comment}{}}
\DoxyCodeLine{00065\ \textcolor{comment}{NOTES}}
\DoxyCodeLine{00066\ \textcolor{comment}{-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00067\ \textcolor{comment}{}}
\DoxyCodeLine{00068\ \textcolor{comment}{this\ is\ an\ implementation\ of\ "{}lcp\_dantzig2\_ldlt.m"{}\ and\ "{}lcp\_dantzig\_lohi.m"{}.}}
\DoxyCodeLine{00069\ \textcolor{comment}{the\ implementation\ is\ split\ into\ an\ LCP\ problem\ object\ (btLCP)\ and\ an\ LCP}}
\DoxyCodeLine{00070\ \textcolor{comment}{driver\ function.\ most\ optimization\ occurs\ in\ the\ btLCP\ object.}}
\DoxyCodeLine{00071\ \textcolor{comment}{}}
\DoxyCodeLine{00072\ \textcolor{comment}{a\ naive\ implementation\ of\ the\ algorithm\ requires\ either\ a\ lot\ of\ data\ motion}}
\DoxyCodeLine{00073\ \textcolor{comment}{or\ a\ lot\ of\ permutation-\/array\ lookup,\ because\ we\ are\ constantly\ re-\/ordering}}
\DoxyCodeLine{00074\ \textcolor{comment}{rows\ and\ columns.\ to\ avoid\ this\ and\ make\ a\ more\ optimized\ algorithm,\ a}}
\DoxyCodeLine{00075\ \textcolor{comment}{non-\/trivial\ data\ structure\ is\ used\ to\ represent\ the\ matrix\ A\ (this\ is}}
\DoxyCodeLine{00076\ \textcolor{comment}{implemented\ in\ the\ fast\ version\ of\ the\ btLCP\ object).}}
\DoxyCodeLine{00077\ \textcolor{comment}{}}
\DoxyCodeLine{00078\ \textcolor{comment}{during\ execution\ of\ this\ algorithm,\ some\ indexes\ in\ A\ are\ clamped\ (set\ C),}}
\DoxyCodeLine{00079\ \textcolor{comment}{some\ are\ non-\/clamped\ (set\ N),\ and\ some\ are\ "{}don't\ care"{}\ (where\ x=0).}}
\DoxyCodeLine{00080\ \textcolor{comment}{A,x,b,w\ (and\ other\ problem\ vectors)\ are\ permuted\ such\ that\ the\ clamped}}
\DoxyCodeLine{00081\ \textcolor{comment}{indexes\ are\ first,\ the\ unclamped\ indexes\ are\ next,\ and\ the\ don't-\/care}}
\DoxyCodeLine{00082\ \textcolor{comment}{indexes\ are\ last.\ this\ permutation\ is\ recorded\ in\ the\ array\ \`{}p'.}}
\DoxyCodeLine{00083\ \textcolor{comment}{initially\ p\ =\ 0..n-\/1,\ and\ as\ the\ rows\ and\ columns\ of\ A,x,b,w\ are\ swapped,}}
\DoxyCodeLine{00084\ \textcolor{comment}{the\ corresponding\ elements\ of\ p\ are\ swapped.}}
\DoxyCodeLine{00085\ \textcolor{comment}{}}
\DoxyCodeLine{00086\ \textcolor{comment}{because\ the\ C\ and\ N\ elements\ are\ grouped\ together\ in\ the\ rows\ of\ A,\ we\ can\ do}}
\DoxyCodeLine{00087\ \textcolor{comment}{lots\ of\ work\ with\ a\ fast\ dot\ product\ function.\ if\ A,x,etc\ were\ not\ permuted}}
\DoxyCodeLine{00088\ \textcolor{comment}{and\ we\ only\ had\ a\ permutation\ array,\ then\ those\ dot\ products\ would\ be\ much}}
\DoxyCodeLine{00089\ \textcolor{comment}{slower\ as\ we\ would\ have\ a\ permutation\ array\ lookup\ in\ some\ inner\ loops.}}
\DoxyCodeLine{00090\ \textcolor{comment}{}}
\DoxyCodeLine{00091\ \textcolor{comment}{A\ is\ accessed\ through\ an\ array\ of\ row\ pointers,\ so\ that\ element\ (i,j)\ of\ the}}
\DoxyCodeLine{00092\ \textcolor{comment}{permuted\ matrix\ is\ A[i][j].\ this\ makes\ row\ swapping\ fast.\ for\ column\ swapping}}
\DoxyCodeLine{00093\ \textcolor{comment}{we\ still\ have\ to\ actually\ move\ the\ data.}}
\DoxyCodeLine{00094\ \textcolor{comment}{}}
\DoxyCodeLine{00095\ \textcolor{comment}{during\ execution\ of\ this\ algorithm\ we\ maintain\ an\ L*D*L'\ factorization\ of}}
\DoxyCodeLine{00096\ \textcolor{comment}{the\ clamped\ submatrix\ of\ A\ (call\ it\ \`{}AC')\ which\ is\ the\ top\ left\ nC*nC}}
\DoxyCodeLine{00097\ \textcolor{comment}{submatrix\ of\ A.\ there\ are\ two\ ways\ we\ could\ arrange\ the\ rows/columns\ in\ AC.}}
\DoxyCodeLine{00098\ \textcolor{comment}{}}
\DoxyCodeLine{00099\ \textcolor{comment}{(1)\ AC\ is\ always\ permuted\ such\ that\ L*D*L'\ =\ AC.\ this\ causes\ a\ problem}}
\DoxyCodeLine{00100\ \textcolor{comment}{when\ a\ row/column\ is\ removed\ from\ C,\ because\ then\ all\ the\ rows/columns\ of\ A}}
\DoxyCodeLine{00101\ \textcolor{comment}{between\ the\ deleted\ index\ and\ the\ end\ of\ C\ need\ to\ be\ rotated\ downward.}}
\DoxyCodeLine{00102\ \textcolor{comment}{this\ results\ in\ a\ lot\ of\ data\ motion\ and\ slows\ things\ down.}}
\DoxyCodeLine{00103\ \textcolor{comment}{(2)\ L*D*L'\ is\ actually\ a\ factorization\ of\ a\ *permutation*\ of\ AC\ (which\ is}}
\DoxyCodeLine{00104\ \textcolor{comment}{itself\ a\ permutation\ of\ the\ underlying\ A).\ this\ is\ what\ we\ do\ -\/\ the}}
\DoxyCodeLine{00105\ \textcolor{comment}{permutation\ is\ recorded\ in\ the\ vector\ C.\ call\ this\ permutation\ A[C,C].}}
\DoxyCodeLine{00106\ \textcolor{comment}{when\ a\ row/column\ is\ removed\ from\ C,\ all\ we\ have\ to\ do\ is\ swap\ two}}
\DoxyCodeLine{00107\ \textcolor{comment}{rows/columns\ and\ manipulate\ C.}}
\DoxyCodeLine{00108\ \textcolor{comment}{}}
\DoxyCodeLine{00109\ \textcolor{comment}{*/}}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00111\ \textcolor{preprocessor}{\#include\ "{}btDantzigLCP.h"{}}}
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00113\ \textcolor{preprocessor}{\#include\ <string.h>}\ \ \textcolor{comment}{//memcpy}}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \textcolor{keywordtype}{bool}\ s\_error\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00117\ \textcolor{comment}{//***************************************************************************}}
\DoxyCodeLine{00118\ \textcolor{comment}{//\ code\ generation\ parameters}}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \textcolor{preprocessor}{\#define\ btLCP\_FAST\ \ }\textcolor{comment}{//\ use\ fast\ btLCP\ object}}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \textcolor{comment}{//\ option\ 1\ :\ matrix\ row\ pointers\ (less\ data\ copying)}}
\DoxyCodeLine{00123\ \textcolor{preprocessor}{\#define\ BTROWPTRS}}
\DoxyCodeLine{00124\ \textcolor{preprocessor}{\#define\ BTATYPE\ btScalar\ **}}
\DoxyCodeLine{00125\ \textcolor{preprocessor}{\#define\ BTAROW(i)\ (m\_A[i])}}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00127\ \textcolor{comment}{//\ option\ 2\ :\ no\ matrix\ row\ pointers\ (slightly\ faster\ inner\ loops)}}
\DoxyCodeLine{00128\ \textcolor{comment}{//\#define\ NOROWPTRS}}
\DoxyCodeLine{00129\ \textcolor{comment}{//\#define\ BTATYPE\ btScalar\ *}}
\DoxyCodeLine{00130\ \textcolor{comment}{//\#define\ BTAROW(i)\ (m\_A+(i)*m\_nskip)}}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00132\ \textcolor{preprocessor}{\#define\ BTNUB\_OPTIMIZATIONS}}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00134\ \textcolor{comment}{/*\ solve\ L*X=B,\ with\ B\ containing\ 1\ right\ hand\ sides.}}
\DoxyCodeLine{00135\ \textcolor{comment}{\ *\ L\ is\ an\ n*n\ lower\ triangular\ matrix\ with\ ones\ on\ the\ diagonal.}}
\DoxyCodeLine{00136\ \textcolor{comment}{\ *\ L\ is\ stored\ by\ rows\ and\ its\ leading\ dimension\ is\ lskip.}}
\DoxyCodeLine{00137\ \textcolor{comment}{\ *\ B\ is\ an\ n*1\ matrix\ that\ contains\ the\ right\ hand\ sides.}}
\DoxyCodeLine{00138\ \textcolor{comment}{\ *\ B\ is\ stored\ by\ columns\ and\ its\ leading\ dimension\ is\ also\ lskip.}}
\DoxyCodeLine{00139\ \textcolor{comment}{\ *\ B\ is\ overwritten\ with\ X.}}
\DoxyCodeLine{00140\ \textcolor{comment}{\ *\ this\ processes\ blocks\ of\ 2*2.}}
\DoxyCodeLine{00141\ \textcolor{comment}{\ *\ if\ this\ is\ in\ the\ factorizer\ source\ file,\ n\ must\ be\ a\ multiple\ of\ 2.}}
\DoxyCodeLine{00142\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ btSolveL1\_1(\textcolor{keyword}{const}\ btScalar\ *L,\ btScalar\ *B,\ \textcolor{keywordtype}{int}\ n,\ \textcolor{keywordtype}{int}\ lskip1)}
\DoxyCodeLine{00145\ \{}
\DoxyCodeLine{00146\ \ \ \ \ \textcolor{comment}{/*\ declare\ variables\ -\/\ Z\ matrix,\ p\ and\ q\ vectors,\ etc\ */}}
\DoxyCodeLine{00147\ \ \ \ \ btScalar\ Z11,\ m11,\ Z21,\ m21,\ p1,\ q1,\ p2,\ *ex;}
\DoxyCodeLine{00148\ \ \ \ \ \textcolor{keyword}{const}\ btScalar\ *ell;}
\DoxyCodeLine{00149\ \ \ \ \ \textcolor{keywordtype}{int}\ i,\ j;}
\DoxyCodeLine{00150\ \ \ \ \ \textcolor{comment}{/*\ compute\ all\ 2\ x\ 1\ blocks\ of\ X\ */}}
\DoxyCodeLine{00151\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ n;\ i\ +=\ 2)}
\DoxyCodeLine{00152\ \ \ \ \ \{}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ all\ 2\ x\ 1\ block\ of\ X,\ from\ rows\ i..i+2-\/1\ */}}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ set\ the\ Z\ matrix\ to\ 0\ */}}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ Z11\ =\ 0;}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ Z21\ =\ 0;}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ ell\ =\ L\ +\ i\ *\ lskip1;}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ ex\ =\ B;}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ the\ inner\ loop\ that\ computes\ outer\ products\ and\ adds\ them\ to\ Z\ */}}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ i\ -\/\ 2;\ j\ >=\ 0;\ j\ -\/=\ 2)}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[0];}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[0];}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \ \ \ \ m11\ =\ p1\ *\ q1;}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ ell[lskip1];}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \ \ \ \ m21\ =\ p2\ *\ q1;}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ m11;}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \ \ \ \ Z21\ +=\ m21;}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[1];}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[1];}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \ \ \ \ m11\ =\ p1\ *\ q1;}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ ell[1\ +\ lskip1];}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ \ \ m21\ =\ p2\ *\ q1;}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ advance\ pointers\ */}}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ ell\ +=\ 2;}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \ \ \ \ ex\ +=\ 2;}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ m11;}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \ \ \ \ Z21\ +=\ m21;}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ end\ of\ inner\ loop\ */}}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ left-\/over\ iterations\ */}}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ j\ +=\ 2;}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ j\ >\ 0;\ j-\/-\/)}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[0];}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[0];}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \ \ \ \ m11\ =\ p1\ *\ q1;}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ ell[lskip1];}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \ \ \ \ m21\ =\ p2\ *\ q1;}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ advance\ pointers\ */}}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \ \ \ \ ell\ +=\ 1;}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \ \ \ \ ex\ +=\ 1;}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ m11;}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \ \ \ \ Z21\ +=\ m21;}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ finish\ computing\ the\ X(i)\ block\ */}}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ Z11\ =\ ex[0]\ -\/\ Z11;}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ ex[0]\ =\ Z11;}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ p1\ =\ ell[lskip1];}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ Z21\ =\ ex[1]\ -\/\ Z21\ -\/\ p1\ *\ Z11;}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ ex[1]\ =\ Z21;}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ end\ of\ outer\ loop\ */}}
\DoxyCodeLine{00206\ \ \ \ \ \}}
\DoxyCodeLine{00207\ \}}
\DoxyCodeLine{00208\ }
\DoxyCodeLine{00209\ \textcolor{comment}{/*\ solve\ L*X=B,\ with\ B\ containing\ 2\ right\ hand\ sides.}}
\DoxyCodeLine{00210\ \textcolor{comment}{\ *\ L\ is\ an\ n*n\ lower\ triangular\ matrix\ with\ ones\ on\ the\ diagonal.}}
\DoxyCodeLine{00211\ \textcolor{comment}{\ *\ L\ is\ stored\ by\ rows\ and\ its\ leading\ dimension\ is\ lskip.}}
\DoxyCodeLine{00212\ \textcolor{comment}{\ *\ B\ is\ an\ n*2\ matrix\ that\ contains\ the\ right\ hand\ sides.}}
\DoxyCodeLine{00213\ \textcolor{comment}{\ *\ B\ is\ stored\ by\ columns\ and\ its\ leading\ dimension\ is\ also\ lskip.}}
\DoxyCodeLine{00214\ \textcolor{comment}{\ *\ B\ is\ overwritten\ with\ X.}}
\DoxyCodeLine{00215\ \textcolor{comment}{\ *\ this\ processes\ blocks\ of\ 2*2.}}
\DoxyCodeLine{00216\ \textcolor{comment}{\ *\ if\ this\ is\ in\ the\ factorizer\ source\ file,\ n\ must\ be\ a\ multiple\ of\ 2.}}
\DoxyCodeLine{00217\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00218\ }
\DoxyCodeLine{00219\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ btSolveL1\_2(\textcolor{keyword}{const}\ btScalar\ *L,\ btScalar\ *B,\ \textcolor{keywordtype}{int}\ n,\ \textcolor{keywordtype}{int}\ lskip1)}
\DoxyCodeLine{00220\ \{}
\DoxyCodeLine{00221\ \ \ \ \ \textcolor{comment}{/*\ declare\ variables\ -\/\ Z\ matrix,\ p\ and\ q\ vectors,\ etc\ */}}
\DoxyCodeLine{00222\ \ \ \ \ btScalar\ Z11,\ m11,\ Z12,\ m12,\ Z21,\ m21,\ Z22,\ m22,\ p1,\ q1,\ p2,\ q2,\ *ex;}
\DoxyCodeLine{00223\ \ \ \ \ \textcolor{keyword}{const}\ btScalar\ *ell;}
\DoxyCodeLine{00224\ \ \ \ \ \textcolor{keywordtype}{int}\ i,\ j;}
\DoxyCodeLine{00225\ \ \ \ \ \textcolor{comment}{/*\ compute\ all\ 2\ x\ 2\ blocks\ of\ X\ */}}
\DoxyCodeLine{00226\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ n;\ i\ +=\ 2)}
\DoxyCodeLine{00227\ \ \ \ \ \{}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ all\ 2\ x\ 2\ block\ of\ X,\ from\ rows\ i..i+2-\/1\ */}}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ set\ the\ Z\ matrix\ to\ 0\ */}}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ Z11\ =\ 0;}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ Z12\ =\ 0;}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ Z21\ =\ 0;}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ Z22\ =\ 0;}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ ell\ =\ L\ +\ i\ *\ lskip1;}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ ex\ =\ B;}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ the\ inner\ loop\ that\ computes\ outer\ products\ and\ adds\ them\ to\ Z\ */}}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ i\ -\/\ 2;\ j\ >=\ 0;\ j\ -\/=\ 2)}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[0];}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[0];}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \ \ m11\ =\ p1\ *\ q1;}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \ \ \ \ q2\ =\ ex[lskip1];}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \ \ \ \ m12\ =\ p1\ *\ q2;}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ ell[lskip1];}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \ \ \ \ m21\ =\ p2\ *\ q1;}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \ \ \ \ m22\ =\ p2\ *\ q2;}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ m11;}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \ \ \ \ Z12\ +=\ m12;}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ \ \ Z21\ +=\ m21;}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \ \ Z22\ +=\ m22;}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[1];}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[1];}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ \ \ m11\ =\ p1\ *\ q1;}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \ \ \ \ q2\ =\ ex[1\ +\ lskip1];}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \ \ \ \ m12\ =\ p1\ *\ q2;}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ ell[1\ +\ lskip1];}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \ \ \ \ m21\ =\ p2\ *\ q1;}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \ \ \ \ m22\ =\ p2\ *\ q2;}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ advance\ pointers\ */}}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ \ \ \ \ ell\ +=\ 2;}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \ \ \ \ ex\ +=\ 2;}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ m11;}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \ \ \ \ Z12\ +=\ m12;}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ \ \ \ \ Z21\ +=\ m21;}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ \ \ \ \ Z22\ +=\ m22;}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ end\ of\ inner\ loop\ */}}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ left-\/over\ iterations\ */}}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ j\ +=\ 2;}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ j\ >\ 0;\ j-\/-\/)}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[0];}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[0];}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \ \ \ \ m11\ =\ p1\ *\ q1;}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \ \ \ \ q2\ =\ ex[lskip1];}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \ \ \ \ m12\ =\ p1\ *\ q2;}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ ell[lskip1];}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \ \ \ \ \ \ m21\ =\ p2\ *\ q1;}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ \ \ \ \ m22\ =\ p2\ *\ q2;}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ advance\ pointers\ */}}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \ \ \ \ ell\ +=\ 1;}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ \ \ \ \ ex\ +=\ 1;}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ m11;}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ \ \ \ \ Z12\ +=\ m12;}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \ \ \ \ Z21\ +=\ m21;}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ \ \ \ \ Z22\ +=\ m22;}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ finish\ computing\ the\ X(i)\ block\ */}}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ Z11\ =\ ex[0]\ -\/\ Z11;}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ ex[0]\ =\ Z11;}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ Z12\ =\ ex[lskip1]\ -\/\ Z12;}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ ex[lskip1]\ =\ Z12;}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ p1\ =\ ell[lskip1];}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ Z21\ =\ ex[1]\ -\/\ Z21\ -\/\ p1\ *\ Z11;}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ ex[1]\ =\ Z21;}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ Z22\ =\ ex[1\ +\ lskip1]\ -\/\ Z22\ -\/\ p1\ *\ Z12;}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ ex[1\ +\ lskip1]\ =\ Z22;}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ end\ of\ outer\ loop\ */}}
\DoxyCodeLine{00302\ \ \ \ \ \}}
\DoxyCodeLine{00303\ \}}
\DoxyCodeLine{00304\ }
\DoxyCodeLine{00305\ \textcolor{keywordtype}{void}\ btFactorLDLT(btScalar\ *A,\ btScalar\ *d,\ \textcolor{keywordtype}{int}\ n,\ \textcolor{keywordtype}{int}\ nskip1)}
\DoxyCodeLine{00306\ \{}
\DoxyCodeLine{00307\ \ \ \ \ \textcolor{keywordtype}{int}\ i,\ j;}
\DoxyCodeLine{00308\ \ \ \ \ btScalar\ sum,\ *ell,\ *dee,\ dd,\ p1,\ p2,\ q1,\ q2,\ Z11,\ m11,\ Z21,\ m21,\ Z22,\ m22;}
\DoxyCodeLine{00309\ \ \ \ \ \textcolor{keywordflow}{if}\ (n\ <\ 1)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00310\ }
\DoxyCodeLine{00311\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <=\ n\ -\/\ 2;\ i\ +=\ 2)}
\DoxyCodeLine{00312\ \ \ \ \ \{}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ solve\ L*(D*l)=a,\ l\ is\ scaled\ elements\ in\ 2\ x\ i\ block\ at\ A(i,0)\ */}}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ btSolveL1\_2(A,\ A\ +\ i\ *\ nskip1,\ i,\ nskip1);}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ scale\ the\ elements\ in\ a\ 2\ x\ i\ block\ at\ A(i,0),\ and\ also\ */}}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ Z\ =\ the\ outer\ product\ matrix\ that\ we'll\ need.\ */}}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ Z11\ =\ 0;}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ Z21\ =\ 0;}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ Z22\ =\ 0;}
\DoxyCodeLine{00320\ \ \ \ \ \ \ \ \ ell\ =\ A\ +\ i\ *\ nskip1;}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ dee\ =\ d;}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ i\ -\/\ 6;\ j\ >=\ 0;\ j\ -\/=\ 6)}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[0];}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ ell[nskip1];}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \ \ \ \ dd\ =\ dee[0];}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ p1\ *\ dd;}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \ \ \ \ q2\ =\ p2\ *\ dd;}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \ \ \ \ ell[0]\ =\ q1;}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \ \ \ \ ell[nskip1]\ =\ q2;}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ \ \ \ \ m11\ =\ p1\ *\ q1;}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ \ \ \ \ m21\ =\ p2\ *\ q1;}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ \ \ \ \ m22\ =\ p2\ *\ q2;}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ m11;}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ \ \ \ \ Z21\ +=\ m21;}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \ \ \ \ Z22\ +=\ m22;}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[1];}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ ell[1\ +\ nskip1];}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \ \ \ \ dd\ =\ dee[1];}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ p1\ *\ dd;}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ \ \ \ \ q2\ =\ p2\ *\ dd;}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \ \ \ \ ell[1]\ =\ q1;}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ \ \ \ \ ell[1\ +\ nskip1]\ =\ q2;}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ \ \ \ \ m11\ =\ p1\ *\ q1;}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ \ \ \ \ m21\ =\ p2\ *\ q1;}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ \ \ \ \ m22\ =\ p2\ *\ q2;}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ m11;}
\DoxyCodeLine{00348\ \ \ \ \ \ \ \ \ \ \ \ \ Z21\ +=\ m21;}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \ \ \ \ \ \ Z22\ +=\ m22;}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[2];}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ ell[2\ +\ nskip1];}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ \ \ \ \ dd\ =\ dee[2];}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ p1\ *\ dd;}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \ \ \ \ q2\ =\ p2\ *\ dd;}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \ \ \ \ ell[2]\ =\ q1;}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ \ \ \ \ ell[2\ +\ nskip1]\ =\ q2;}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \ \ \ \ m11\ =\ p1\ *\ q1;}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ \ \ \ \ m21\ =\ p2\ *\ q1;}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \ \ \ \ m22\ =\ p2\ *\ q2;}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ m11;}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \ \ \ \ Z21\ +=\ m21;}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \ \ \ \ Z22\ +=\ m22;}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[3];}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ ell[3\ +\ nskip1];}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \ \ \ \ dd\ =\ dee[3];}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ p1\ *\ dd;}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \ \ \ \ q2\ =\ p2\ *\ dd;}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \ \ \ \ ell[3]\ =\ q1;}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \ \ \ \ ell[3\ +\ nskip1]\ =\ q2;}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \ \ \ \ \ \ m11\ =\ p1\ *\ q1;}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \ \ \ \ \ \ m21\ =\ p2\ *\ q1;}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ \ \ \ \ m22\ =\ p2\ *\ q2;}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ m11;}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \ \ \ \ Z21\ +=\ m21;}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \ \ \ \ Z22\ +=\ m22;}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[4];}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ ell[4\ +\ nskip1];}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \ \ \ \ dd\ =\ dee[4];}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ p1\ *\ dd;}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \ \ \ \ q2\ =\ p2\ *\ dd;}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \ \ \ \ ell[4]\ =\ q1;}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \ \ \ \ ell[4\ +\ nskip1]\ =\ q2;}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \ \ \ \ m11\ =\ p1\ *\ q1;}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \ \ \ \ m21\ =\ p2\ *\ q1;}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \ \ \ \ m22\ =\ p2\ *\ q2;}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ m11;}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ \ \ \ \ Z21\ +=\ m21;}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \ \ \ \ Z22\ +=\ m22;}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[5];}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ ell[5\ +\ nskip1];}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \ \ \ \ \ \ dd\ =\ dee[5];}
\DoxyCodeLine{00392\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ p1\ *\ dd;}
\DoxyCodeLine{00393\ \ \ \ \ \ \ \ \ \ \ \ \ q2\ =\ p2\ *\ dd;}
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ \ \ \ \ ell[5]\ =\ q1;}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \ \ \ \ \ ell[5\ +\ nskip1]\ =\ q2;}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \ \ \ \ \ \ m11\ =\ p1\ *\ q1;}
\DoxyCodeLine{00397\ \ \ \ \ \ \ \ \ \ \ \ \ m21\ =\ p2\ *\ q1;}
\DoxyCodeLine{00398\ \ \ \ \ \ \ \ \ \ \ \ \ m22\ =\ p2\ *\ q2;}
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ m11;}
\DoxyCodeLine{00400\ \ \ \ \ \ \ \ \ \ \ \ \ Z21\ +=\ m21;}
\DoxyCodeLine{00401\ \ \ \ \ \ \ \ \ \ \ \ \ Z22\ +=\ m22;}
\DoxyCodeLine{00402\ \ \ \ \ \ \ \ \ \ \ \ \ ell\ +=\ 6;}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \ \ \ \ \ \ dee\ +=\ 6;}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ left-\/over\ iterations\ */}}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ j\ +=\ 6;}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ j\ >\ 0;\ j-\/-\/)}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00409\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[0];}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ ell[nskip1];}
\DoxyCodeLine{00411\ \ \ \ \ \ \ \ \ \ \ \ \ dd\ =\ dee[0];}
\DoxyCodeLine{00412\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ p1\ *\ dd;}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \ \ \ \ \ \ q2\ =\ p2\ *\ dd;}
\DoxyCodeLine{00414\ \ \ \ \ \ \ \ \ \ \ \ \ ell[0]\ =\ q1;}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \ \ \ \ \ \ ell[nskip1]\ =\ q2;}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \ \ \ \ \ \ m11\ =\ p1\ *\ q1;}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ \ \ \ \ m21\ =\ p2\ *\ q1;}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ \ \ \ \ m22\ =\ p2\ *\ q2;}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ m11;}
\DoxyCodeLine{00420\ \ \ \ \ \ \ \ \ \ \ \ \ Z21\ +=\ m21;}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \ \ \ \ \ \ Z22\ +=\ m22;}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \ \ \ \ \ \ ell++;}
\DoxyCodeLine{00423\ \ \ \ \ \ \ \ \ \ \ \ \ dee++;}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00425\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ solve\ for\ diagonal\ 2\ x\ 2\ block\ at\ A(i,i)\ */}}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \ \ Z11\ =\ ell[0]\ -\/\ Z11;}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ Z21\ =\ ell[nskip1]\ -\/\ Z21;}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ Z22\ =\ ell[1\ +\ nskip1]\ -\/\ Z22;}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \ \ dee\ =\ d\ +\ i;}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ factorize\ 2\ x\ 2\ block\ Z,dee\ */}}
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ factorize\ row\ 1\ */}}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ dee[0]\ =\ btRecip(Z11);}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ factorize\ row\ 2\ */}}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \ \ sum\ =\ 0;}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ q1\ =\ Z21;}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \ \ q2\ =\ q1\ *\ dee[0];}
\DoxyCodeLine{00437\ \ \ \ \ \ \ \ \ Z21\ =\ q2;}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \ \ sum\ +=\ q1\ *\ q2;}
\DoxyCodeLine{00439\ \ \ \ \ \ \ \ \ dee[1]\ =\ btRecip(Z22\ -\/\ sum);}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ done\ factorizing\ 2\ x\ 2\ block\ */}}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ ell[nskip1]\ =\ Z21;}
\DoxyCodeLine{00442\ \ \ \ \ \}}
\DoxyCodeLine{00443\ \ \ \ \ \textcolor{comment}{/*\ compute\ the\ (less\ than\ 2)\ rows\ at\ the\ bottom\ */}}
\DoxyCodeLine{00444\ \ \ \ \ \textcolor{keywordflow}{switch}\ (n\ -\/\ i)}
\DoxyCodeLine{00445\ \ \ \ \ \{}
\DoxyCodeLine{00446\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 0:}
\DoxyCodeLine{00447\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00448\ }
\DoxyCodeLine{00449\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{00450\ \ \ \ \ \ \ \ \ \ \ \ \ btSolveL1\_1(A,\ A\ +\ i\ *\ nskip1,\ i,\ nskip1);}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ scale\ the\ elements\ in\ a\ 1\ x\ i\ block\ at\ A(i,0),\ and\ also\ */}}
\DoxyCodeLine{00452\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ Z\ =\ the\ outer\ product\ matrix\ that\ we'll\ need.\ */}}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ =\ 0;}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ \ \ \ \ ell\ =\ A\ +\ i\ *\ nskip1;}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \ \ \ \ \ \ dee\ =\ d;}
\DoxyCodeLine{00456\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ i\ -\/\ 6;\ j\ >=\ 0;\ j\ -\/=\ 6)}
\DoxyCodeLine{00457\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00458\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[0];}
\DoxyCodeLine{00459\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dd\ =\ dee[0];}
\DoxyCodeLine{00460\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ p1\ *\ dd;}
\DoxyCodeLine{00461\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ell[0]\ =\ q1;}
\DoxyCodeLine{00462\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m11\ =\ p1\ *\ q1;}
\DoxyCodeLine{00463\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ m11;}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[1];}
\DoxyCodeLine{00465\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dd\ =\ dee[1];}
\DoxyCodeLine{00466\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ p1\ *\ dd;}
\DoxyCodeLine{00467\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ell[1]\ =\ q1;}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m11\ =\ p1\ *\ q1;}
\DoxyCodeLine{00469\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ m11;}
\DoxyCodeLine{00470\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[2];}
\DoxyCodeLine{00471\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dd\ =\ dee[2];}
\DoxyCodeLine{00472\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ p1\ *\ dd;}
\DoxyCodeLine{00473\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ell[2]\ =\ q1;}
\DoxyCodeLine{00474\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m11\ =\ p1\ *\ q1;}
\DoxyCodeLine{00475\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ m11;}
\DoxyCodeLine{00476\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[3];}
\DoxyCodeLine{00477\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dd\ =\ dee[3];}
\DoxyCodeLine{00478\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ p1\ *\ dd;}
\DoxyCodeLine{00479\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ell[3]\ =\ q1;}
\DoxyCodeLine{00480\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m11\ =\ p1\ *\ q1;}
\DoxyCodeLine{00481\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ m11;}
\DoxyCodeLine{00482\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[4];}
\DoxyCodeLine{00483\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dd\ =\ dee[4];}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ p1\ *\ dd;}
\DoxyCodeLine{00485\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ell[4]\ =\ q1;}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m11\ =\ p1\ *\ q1;}
\DoxyCodeLine{00487\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ m11;}
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[5];}
\DoxyCodeLine{00489\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dd\ =\ dee[5];}
\DoxyCodeLine{00490\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ p1\ *\ dd;}
\DoxyCodeLine{00491\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ell[5]\ =\ q1;}
\DoxyCodeLine{00492\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m11\ =\ p1\ *\ q1;}
\DoxyCodeLine{00493\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ m11;}
\DoxyCodeLine{00494\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ell\ +=\ 6;}
\DoxyCodeLine{00495\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dee\ +=\ 6;}
\DoxyCodeLine{00496\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00497\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ left-\/over\ iterations\ */}}
\DoxyCodeLine{00498\ \ \ \ \ \ \ \ \ \ \ \ \ j\ +=\ 6;}
\DoxyCodeLine{00499\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ j\ >\ 0;\ j-\/-\/)}
\DoxyCodeLine{00500\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00501\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[0];}
\DoxyCodeLine{00502\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dd\ =\ dee[0];}
\DoxyCodeLine{00503\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ p1\ *\ dd;}
\DoxyCodeLine{00504\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ell[0]\ =\ q1;}
\DoxyCodeLine{00505\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m11\ =\ p1\ *\ q1;}
\DoxyCodeLine{00506\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ m11;}
\DoxyCodeLine{00507\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ell++;}
\DoxyCodeLine{00508\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dee++;}
\DoxyCodeLine{00509\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ solve\ for\ diagonal\ 1\ x\ 1\ block\ at\ A(i,i)\ */}}
\DoxyCodeLine{00511\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ =\ ell[0]\ -\/\ Z11;}
\DoxyCodeLine{00512\ \ \ \ \ \ \ \ \ \ \ \ \ dee\ =\ d\ +\ i;}
\DoxyCodeLine{00513\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ factorize\ 1\ x\ 1\ block\ Z,dee\ */}}
\DoxyCodeLine{00514\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ factorize\ row\ 1\ */}}
\DoxyCodeLine{00515\ \ \ \ \ \ \ \ \ \ \ \ \ dee[0]\ =\ btRecip(Z11);}
\DoxyCodeLine{00516\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ done\ factorizing\ 1\ x\ 1\ block\ */}}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00518\ }
\DoxyCodeLine{00519\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//default:\ *((char*)0)=0;\ \ /*\ this\ should\ never\ happen!\ */}}
\DoxyCodeLine{00520\ \ \ \ \ \}}
\DoxyCodeLine{00521\ \}}
\DoxyCodeLine{00522\ }
\DoxyCodeLine{00523\ \textcolor{comment}{/*\ solve\ L*X=B,\ with\ B\ containing\ 1\ right\ hand\ sides.}}
\DoxyCodeLine{00524\ \textcolor{comment}{\ *\ L\ is\ an\ n*n\ lower\ triangular\ matrix\ with\ ones\ on\ the\ diagonal.}}
\DoxyCodeLine{00525\ \textcolor{comment}{\ *\ L\ is\ stored\ by\ rows\ and\ its\ leading\ dimension\ is\ lskip.}}
\DoxyCodeLine{00526\ \textcolor{comment}{\ *\ B\ is\ an\ n*1\ matrix\ that\ contains\ the\ right\ hand\ sides.}}
\DoxyCodeLine{00527\ \textcolor{comment}{\ *\ B\ is\ stored\ by\ columns\ and\ its\ leading\ dimension\ is\ also\ lskip.}}
\DoxyCodeLine{00528\ \textcolor{comment}{\ *\ B\ is\ overwritten\ with\ X.}}
\DoxyCodeLine{00529\ \textcolor{comment}{\ *\ this\ processes\ blocks\ of\ 4*4.}}
\DoxyCodeLine{00530\ \textcolor{comment}{\ *\ if\ this\ is\ in\ the\ factorizer\ source\ file,\ n\ must\ be\ a\ multiple\ of\ 4.}}
\DoxyCodeLine{00531\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00532\ }
\DoxyCodeLine{00533\ \textcolor{keywordtype}{void}\ btSolveL1(\textcolor{keyword}{const}\ btScalar\ *L,\ btScalar\ *B,\ \textcolor{keywordtype}{int}\ n,\ \textcolor{keywordtype}{int}\ lskip1)}
\DoxyCodeLine{00534\ \{}
\DoxyCodeLine{00535\ \ \ \ \ \textcolor{comment}{/*\ declare\ variables\ -\/\ Z\ matrix,\ p\ and\ q\ vectors,\ etc\ */}}
\DoxyCodeLine{00536\ \ \ \ \ btScalar\ Z11,\ Z21,\ Z31,\ Z41,\ p1,\ q1,\ p2,\ p3,\ p4,\ *ex;}
\DoxyCodeLine{00537\ \ \ \ \ \textcolor{keyword}{const}\ btScalar\ *ell;}
\DoxyCodeLine{00538\ \ \ \ \ \textcolor{keywordtype}{int}\ lskip2,\ lskip3,\ i,\ j;}
\DoxyCodeLine{00539\ \ \ \ \ \textcolor{comment}{/*\ compute\ lskip\ values\ */}}
\DoxyCodeLine{00540\ \ \ \ \ lskip2\ =\ 2\ *\ lskip1;}
\DoxyCodeLine{00541\ \ \ \ \ lskip3\ =\ 3\ *\ lskip1;}
\DoxyCodeLine{00542\ \ \ \ \ \textcolor{comment}{/*\ compute\ all\ 4\ x\ 1\ blocks\ of\ X\ */}}
\DoxyCodeLine{00543\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <=\ n\ -\/\ 4;\ i\ +=\ 4)}
\DoxyCodeLine{00544\ \ \ \ \ \{}
\DoxyCodeLine{00545\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ all\ 4\ x\ 1\ block\ of\ X,\ from\ rows\ i..i+4-\/1\ */}}
\DoxyCodeLine{00546\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ set\ the\ Z\ matrix\ to\ 0\ */}}
\DoxyCodeLine{00547\ \ \ \ \ \ \ \ \ Z11\ =\ 0;}
\DoxyCodeLine{00548\ \ \ \ \ \ \ \ \ Z21\ =\ 0;}
\DoxyCodeLine{00549\ \ \ \ \ \ \ \ \ Z31\ =\ 0;}
\DoxyCodeLine{00550\ \ \ \ \ \ \ \ \ Z41\ =\ 0;}
\DoxyCodeLine{00551\ \ \ \ \ \ \ \ \ ell\ =\ L\ +\ i\ *\ lskip1;}
\DoxyCodeLine{00552\ \ \ \ \ \ \ \ \ ex\ =\ B;}
\DoxyCodeLine{00553\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ the\ inner\ loop\ that\ computes\ outer\ products\ and\ adds\ them\ to\ Z\ */}}
\DoxyCodeLine{00554\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ i\ -\/\ 12;\ j\ >=\ 0;\ j\ -\/=\ 12)}
\DoxyCodeLine{00555\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00556\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00557\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[0];}
\DoxyCodeLine{00558\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[0];}
\DoxyCodeLine{00559\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ ell[lskip1];}
\DoxyCodeLine{00560\ \ \ \ \ \ \ \ \ \ \ \ \ p3\ =\ ell[lskip2];}
\DoxyCodeLine{00561\ \ \ \ \ \ \ \ \ \ \ \ \ p4\ =\ ell[lskip3];}
\DoxyCodeLine{00562\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00563\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ p1\ *\ q1;}
\DoxyCodeLine{00564\ \ \ \ \ \ \ \ \ \ \ \ \ Z21\ +=\ p2\ *\ q1;}
\DoxyCodeLine{00565\ \ \ \ \ \ \ \ \ \ \ \ \ Z31\ +=\ p3\ *\ q1;}
\DoxyCodeLine{00566\ \ \ \ \ \ \ \ \ \ \ \ \ Z41\ +=\ p4\ *\ q1;}
\DoxyCodeLine{00567\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00568\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[1];}
\DoxyCodeLine{00569\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[1];}
\DoxyCodeLine{00570\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ ell[1\ +\ lskip1];}
\DoxyCodeLine{00571\ \ \ \ \ \ \ \ \ \ \ \ \ p3\ =\ ell[1\ +\ lskip2];}
\DoxyCodeLine{00572\ \ \ \ \ \ \ \ \ \ \ \ \ p4\ =\ ell[1\ +\ lskip3];}
\DoxyCodeLine{00573\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00574\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ p1\ *\ q1;}
\DoxyCodeLine{00575\ \ \ \ \ \ \ \ \ \ \ \ \ Z21\ +=\ p2\ *\ q1;}
\DoxyCodeLine{00576\ \ \ \ \ \ \ \ \ \ \ \ \ Z31\ +=\ p3\ *\ q1;}
\DoxyCodeLine{00577\ \ \ \ \ \ \ \ \ \ \ \ \ Z41\ +=\ p4\ *\ q1;}
\DoxyCodeLine{00578\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00579\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[2];}
\DoxyCodeLine{00580\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[2];}
\DoxyCodeLine{00581\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ ell[2\ +\ lskip1];}
\DoxyCodeLine{00582\ \ \ \ \ \ \ \ \ \ \ \ \ p3\ =\ ell[2\ +\ lskip2];}
\DoxyCodeLine{00583\ \ \ \ \ \ \ \ \ \ \ \ \ p4\ =\ ell[2\ +\ lskip3];}
\DoxyCodeLine{00584\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00585\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ p1\ *\ q1;}
\DoxyCodeLine{00586\ \ \ \ \ \ \ \ \ \ \ \ \ Z21\ +=\ p2\ *\ q1;}
\DoxyCodeLine{00587\ \ \ \ \ \ \ \ \ \ \ \ \ Z31\ +=\ p3\ *\ q1;}
\DoxyCodeLine{00588\ \ \ \ \ \ \ \ \ \ \ \ \ Z41\ +=\ p4\ *\ q1;}
\DoxyCodeLine{00589\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00590\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[3];}
\DoxyCodeLine{00591\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[3];}
\DoxyCodeLine{00592\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ ell[3\ +\ lskip1];}
\DoxyCodeLine{00593\ \ \ \ \ \ \ \ \ \ \ \ \ p3\ =\ ell[3\ +\ lskip2];}
\DoxyCodeLine{00594\ \ \ \ \ \ \ \ \ \ \ \ \ p4\ =\ ell[3\ +\ lskip3];}
\DoxyCodeLine{00595\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00596\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ p1\ *\ q1;}
\DoxyCodeLine{00597\ \ \ \ \ \ \ \ \ \ \ \ \ Z21\ +=\ p2\ *\ q1;}
\DoxyCodeLine{00598\ \ \ \ \ \ \ \ \ \ \ \ \ Z31\ +=\ p3\ *\ q1;}
\DoxyCodeLine{00599\ \ \ \ \ \ \ \ \ \ \ \ \ Z41\ +=\ p4\ *\ q1;}
\DoxyCodeLine{00600\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00601\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[4];}
\DoxyCodeLine{00602\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[4];}
\DoxyCodeLine{00603\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ ell[4\ +\ lskip1];}
\DoxyCodeLine{00604\ \ \ \ \ \ \ \ \ \ \ \ \ p3\ =\ ell[4\ +\ lskip2];}
\DoxyCodeLine{00605\ \ \ \ \ \ \ \ \ \ \ \ \ p4\ =\ ell[4\ +\ lskip3];}
\DoxyCodeLine{00606\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00607\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ p1\ *\ q1;}
\DoxyCodeLine{00608\ \ \ \ \ \ \ \ \ \ \ \ \ Z21\ +=\ p2\ *\ q1;}
\DoxyCodeLine{00609\ \ \ \ \ \ \ \ \ \ \ \ \ Z31\ +=\ p3\ *\ q1;}
\DoxyCodeLine{00610\ \ \ \ \ \ \ \ \ \ \ \ \ Z41\ +=\ p4\ *\ q1;}
\DoxyCodeLine{00611\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00612\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[5];}
\DoxyCodeLine{00613\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[5];}
\DoxyCodeLine{00614\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ ell[5\ +\ lskip1];}
\DoxyCodeLine{00615\ \ \ \ \ \ \ \ \ \ \ \ \ p3\ =\ ell[5\ +\ lskip2];}
\DoxyCodeLine{00616\ \ \ \ \ \ \ \ \ \ \ \ \ p4\ =\ ell[5\ +\ lskip3];}
\DoxyCodeLine{00617\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00618\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ p1\ *\ q1;}
\DoxyCodeLine{00619\ \ \ \ \ \ \ \ \ \ \ \ \ Z21\ +=\ p2\ *\ q1;}
\DoxyCodeLine{00620\ \ \ \ \ \ \ \ \ \ \ \ \ Z31\ +=\ p3\ *\ q1;}
\DoxyCodeLine{00621\ \ \ \ \ \ \ \ \ \ \ \ \ Z41\ +=\ p4\ *\ q1;}
\DoxyCodeLine{00622\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00623\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[6];}
\DoxyCodeLine{00624\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[6];}
\DoxyCodeLine{00625\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ ell[6\ +\ lskip1];}
\DoxyCodeLine{00626\ \ \ \ \ \ \ \ \ \ \ \ \ p3\ =\ ell[6\ +\ lskip2];}
\DoxyCodeLine{00627\ \ \ \ \ \ \ \ \ \ \ \ \ p4\ =\ ell[6\ +\ lskip3];}
\DoxyCodeLine{00628\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00629\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ p1\ *\ q1;}
\DoxyCodeLine{00630\ \ \ \ \ \ \ \ \ \ \ \ \ Z21\ +=\ p2\ *\ q1;}
\DoxyCodeLine{00631\ \ \ \ \ \ \ \ \ \ \ \ \ Z31\ +=\ p3\ *\ q1;}
\DoxyCodeLine{00632\ \ \ \ \ \ \ \ \ \ \ \ \ Z41\ +=\ p4\ *\ q1;}
\DoxyCodeLine{00633\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00634\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[7];}
\DoxyCodeLine{00635\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[7];}
\DoxyCodeLine{00636\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ ell[7\ +\ lskip1];}
\DoxyCodeLine{00637\ \ \ \ \ \ \ \ \ \ \ \ \ p3\ =\ ell[7\ +\ lskip2];}
\DoxyCodeLine{00638\ \ \ \ \ \ \ \ \ \ \ \ \ p4\ =\ ell[7\ +\ lskip3];}
\DoxyCodeLine{00639\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00640\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ p1\ *\ q1;}
\DoxyCodeLine{00641\ \ \ \ \ \ \ \ \ \ \ \ \ Z21\ +=\ p2\ *\ q1;}
\DoxyCodeLine{00642\ \ \ \ \ \ \ \ \ \ \ \ \ Z31\ +=\ p3\ *\ q1;}
\DoxyCodeLine{00643\ \ \ \ \ \ \ \ \ \ \ \ \ Z41\ +=\ p4\ *\ q1;}
\DoxyCodeLine{00644\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00645\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[8];}
\DoxyCodeLine{00646\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[8];}
\DoxyCodeLine{00647\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ ell[8\ +\ lskip1];}
\DoxyCodeLine{00648\ \ \ \ \ \ \ \ \ \ \ \ \ p3\ =\ ell[8\ +\ lskip2];}
\DoxyCodeLine{00649\ \ \ \ \ \ \ \ \ \ \ \ \ p4\ =\ ell[8\ +\ lskip3];}
\DoxyCodeLine{00650\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00651\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ p1\ *\ q1;}
\DoxyCodeLine{00652\ \ \ \ \ \ \ \ \ \ \ \ \ Z21\ +=\ p2\ *\ q1;}
\DoxyCodeLine{00653\ \ \ \ \ \ \ \ \ \ \ \ \ Z31\ +=\ p3\ *\ q1;}
\DoxyCodeLine{00654\ \ \ \ \ \ \ \ \ \ \ \ \ Z41\ +=\ p4\ *\ q1;}
\DoxyCodeLine{00655\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00656\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[9];}
\DoxyCodeLine{00657\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[9];}
\DoxyCodeLine{00658\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ ell[9\ +\ lskip1];}
\DoxyCodeLine{00659\ \ \ \ \ \ \ \ \ \ \ \ \ p3\ =\ ell[9\ +\ lskip2];}
\DoxyCodeLine{00660\ \ \ \ \ \ \ \ \ \ \ \ \ p4\ =\ ell[9\ +\ lskip3];}
\DoxyCodeLine{00661\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00662\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ p1\ *\ q1;}
\DoxyCodeLine{00663\ \ \ \ \ \ \ \ \ \ \ \ \ Z21\ +=\ p2\ *\ q1;}
\DoxyCodeLine{00664\ \ \ \ \ \ \ \ \ \ \ \ \ Z31\ +=\ p3\ *\ q1;}
\DoxyCodeLine{00665\ \ \ \ \ \ \ \ \ \ \ \ \ Z41\ +=\ p4\ *\ q1;}
\DoxyCodeLine{00666\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00667\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[10];}
\DoxyCodeLine{00668\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[10];}
\DoxyCodeLine{00669\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ ell[10\ +\ lskip1];}
\DoxyCodeLine{00670\ \ \ \ \ \ \ \ \ \ \ \ \ p3\ =\ ell[10\ +\ lskip2];}
\DoxyCodeLine{00671\ \ \ \ \ \ \ \ \ \ \ \ \ p4\ =\ ell[10\ +\ lskip3];}
\DoxyCodeLine{00672\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00673\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ p1\ *\ q1;}
\DoxyCodeLine{00674\ \ \ \ \ \ \ \ \ \ \ \ \ Z21\ +=\ p2\ *\ q1;}
\DoxyCodeLine{00675\ \ \ \ \ \ \ \ \ \ \ \ \ Z31\ +=\ p3\ *\ q1;}
\DoxyCodeLine{00676\ \ \ \ \ \ \ \ \ \ \ \ \ Z41\ +=\ p4\ *\ q1;}
\DoxyCodeLine{00677\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00678\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[11];}
\DoxyCodeLine{00679\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[11];}
\DoxyCodeLine{00680\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ ell[11\ +\ lskip1];}
\DoxyCodeLine{00681\ \ \ \ \ \ \ \ \ \ \ \ \ p3\ =\ ell[11\ +\ lskip2];}
\DoxyCodeLine{00682\ \ \ \ \ \ \ \ \ \ \ \ \ p4\ =\ ell[11\ +\ lskip3];}
\DoxyCodeLine{00683\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00684\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ p1\ *\ q1;}
\DoxyCodeLine{00685\ \ \ \ \ \ \ \ \ \ \ \ \ Z21\ +=\ p2\ *\ q1;}
\DoxyCodeLine{00686\ \ \ \ \ \ \ \ \ \ \ \ \ Z31\ +=\ p3\ *\ q1;}
\DoxyCodeLine{00687\ \ \ \ \ \ \ \ \ \ \ \ \ Z41\ +=\ p4\ *\ q1;}
\DoxyCodeLine{00688\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ advance\ pointers\ */}}
\DoxyCodeLine{00689\ \ \ \ \ \ \ \ \ \ \ \ \ ell\ +=\ 12;}
\DoxyCodeLine{00690\ \ \ \ \ \ \ \ \ \ \ \ \ ex\ +=\ 12;}
\DoxyCodeLine{00691\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ end\ of\ inner\ loop\ */}}
\DoxyCodeLine{00692\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00693\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ left-\/over\ iterations\ */}}
\DoxyCodeLine{00694\ \ \ \ \ \ \ \ \ j\ +=\ 12;}
\DoxyCodeLine{00695\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ j\ >\ 0;\ j-\/-\/)}
\DoxyCodeLine{00696\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00697\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00698\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[0];}
\DoxyCodeLine{00699\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[0];}
\DoxyCodeLine{00700\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ ell[lskip1];}
\DoxyCodeLine{00701\ \ \ \ \ \ \ \ \ \ \ \ \ p3\ =\ ell[lskip2];}
\DoxyCodeLine{00702\ \ \ \ \ \ \ \ \ \ \ \ \ p4\ =\ ell[lskip3];}
\DoxyCodeLine{00703\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00704\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ p1\ *\ q1;}
\DoxyCodeLine{00705\ \ \ \ \ \ \ \ \ \ \ \ \ Z21\ +=\ p2\ *\ q1;}
\DoxyCodeLine{00706\ \ \ \ \ \ \ \ \ \ \ \ \ Z31\ +=\ p3\ *\ q1;}
\DoxyCodeLine{00707\ \ \ \ \ \ \ \ \ \ \ \ \ Z41\ +=\ p4\ *\ q1;}
\DoxyCodeLine{00708\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ advance\ pointers\ */}}
\DoxyCodeLine{00709\ \ \ \ \ \ \ \ \ \ \ \ \ ell\ +=\ 1;}
\DoxyCodeLine{00710\ \ \ \ \ \ \ \ \ \ \ \ \ ex\ +=\ 1;}
\DoxyCodeLine{00711\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00712\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ finish\ computing\ the\ X(i)\ block\ */}}
\DoxyCodeLine{00713\ \ \ \ \ \ \ \ \ Z11\ =\ ex[0]\ -\/\ Z11;}
\DoxyCodeLine{00714\ \ \ \ \ \ \ \ \ ex[0]\ =\ Z11;}
\DoxyCodeLine{00715\ \ \ \ \ \ \ \ \ p1\ =\ ell[lskip1];}
\DoxyCodeLine{00716\ \ \ \ \ \ \ \ \ Z21\ =\ ex[1]\ -\/\ Z21\ -\/\ p1\ *\ Z11;}
\DoxyCodeLine{00717\ \ \ \ \ \ \ \ \ ex[1]\ =\ Z21;}
\DoxyCodeLine{00718\ \ \ \ \ \ \ \ \ p1\ =\ ell[lskip2];}
\DoxyCodeLine{00719\ \ \ \ \ \ \ \ \ p2\ =\ ell[1\ +\ lskip2];}
\DoxyCodeLine{00720\ \ \ \ \ \ \ \ \ Z31\ =\ ex[2]\ -\/\ Z31\ -\/\ p1\ *\ Z11\ -\/\ p2\ *\ Z21;}
\DoxyCodeLine{00721\ \ \ \ \ \ \ \ \ ex[2]\ =\ Z31;}
\DoxyCodeLine{00722\ \ \ \ \ \ \ \ \ p1\ =\ ell[lskip3];}
\DoxyCodeLine{00723\ \ \ \ \ \ \ \ \ p2\ =\ ell[1\ +\ lskip3];}
\DoxyCodeLine{00724\ \ \ \ \ \ \ \ \ p3\ =\ ell[2\ +\ lskip3];}
\DoxyCodeLine{00725\ \ \ \ \ \ \ \ \ Z41\ =\ ex[3]\ -\/\ Z41\ -\/\ p1\ *\ Z11\ -\/\ p2\ *\ Z21\ -\/\ p3\ *\ Z31;}
\DoxyCodeLine{00726\ \ \ \ \ \ \ \ \ ex[3]\ =\ Z41;}
\DoxyCodeLine{00727\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ end\ of\ outer\ loop\ */}}
\DoxyCodeLine{00728\ \ \ \ \ \}}
\DoxyCodeLine{00729\ \ \ \ \ \textcolor{comment}{/*\ compute\ rows\ at\ end\ that\ are\ not\ a\ multiple\ of\ block\ size\ */}}
\DoxyCodeLine{00730\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ i\ <\ n;\ i++)}
\DoxyCodeLine{00731\ \ \ \ \ \{}
\DoxyCodeLine{00732\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ all\ 1\ x\ 1\ block\ of\ X,\ from\ rows\ i..i+1-\/1\ */}}
\DoxyCodeLine{00733\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ set\ the\ Z\ matrix\ to\ 0\ */}}
\DoxyCodeLine{00734\ \ \ \ \ \ \ \ \ Z11\ =\ 0;}
\DoxyCodeLine{00735\ \ \ \ \ \ \ \ \ ell\ =\ L\ +\ i\ *\ lskip1;}
\DoxyCodeLine{00736\ \ \ \ \ \ \ \ \ ex\ =\ B;}
\DoxyCodeLine{00737\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ the\ inner\ loop\ that\ computes\ outer\ products\ and\ adds\ them\ to\ Z\ */}}
\DoxyCodeLine{00738\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ i\ -\/\ 12;\ j\ >=\ 0;\ j\ -\/=\ 12)}
\DoxyCodeLine{00739\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00740\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00741\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[0];}
\DoxyCodeLine{00742\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[0];}
\DoxyCodeLine{00743\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00744\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ p1\ *\ q1;}
\DoxyCodeLine{00745\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00746\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[1];}
\DoxyCodeLine{00747\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[1];}
\DoxyCodeLine{00748\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00749\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ p1\ *\ q1;}
\DoxyCodeLine{00750\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00751\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[2];}
\DoxyCodeLine{00752\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[2];}
\DoxyCodeLine{00753\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00754\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ p1\ *\ q1;}
\DoxyCodeLine{00755\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00756\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[3];}
\DoxyCodeLine{00757\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[3];}
\DoxyCodeLine{00758\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00759\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ p1\ *\ q1;}
\DoxyCodeLine{00760\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00761\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[4];}
\DoxyCodeLine{00762\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[4];}
\DoxyCodeLine{00763\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00764\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ p1\ *\ q1;}
\DoxyCodeLine{00765\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00766\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[5];}
\DoxyCodeLine{00767\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[5];}
\DoxyCodeLine{00768\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00769\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ p1\ *\ q1;}
\DoxyCodeLine{00770\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00771\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[6];}
\DoxyCodeLine{00772\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[6];}
\DoxyCodeLine{00773\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00774\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ p1\ *\ q1;}
\DoxyCodeLine{00775\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00776\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[7];}
\DoxyCodeLine{00777\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[7];}
\DoxyCodeLine{00778\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00779\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ p1\ *\ q1;}
\DoxyCodeLine{00780\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00781\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[8];}
\DoxyCodeLine{00782\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[8];}
\DoxyCodeLine{00783\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00784\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ p1\ *\ q1;}
\DoxyCodeLine{00785\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00786\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[9];}
\DoxyCodeLine{00787\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[9];}
\DoxyCodeLine{00788\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00789\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ p1\ *\ q1;}
\DoxyCodeLine{00790\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00791\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[10];}
\DoxyCodeLine{00792\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[10];}
\DoxyCodeLine{00793\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00794\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ p1\ *\ q1;}
\DoxyCodeLine{00795\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00796\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[11];}
\DoxyCodeLine{00797\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[11];}
\DoxyCodeLine{00798\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00799\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ p1\ *\ q1;}
\DoxyCodeLine{00800\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ advance\ pointers\ */}}
\DoxyCodeLine{00801\ \ \ \ \ \ \ \ \ \ \ \ \ ell\ +=\ 12;}
\DoxyCodeLine{00802\ \ \ \ \ \ \ \ \ \ \ \ \ ex\ +=\ 12;}
\DoxyCodeLine{00803\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ end\ of\ inner\ loop\ */}}
\DoxyCodeLine{00804\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00805\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ left-\/over\ iterations\ */}}
\DoxyCodeLine{00806\ \ \ \ \ \ \ \ \ j\ +=\ 12;}
\DoxyCodeLine{00807\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ j\ >\ 0;\ j-\/-\/)}
\DoxyCodeLine{00808\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00809\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00810\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[0];}
\DoxyCodeLine{00811\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[0];}
\DoxyCodeLine{00812\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00813\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ p1\ *\ q1;}
\DoxyCodeLine{00814\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ advance\ pointers\ */}}
\DoxyCodeLine{00815\ \ \ \ \ \ \ \ \ \ \ \ \ ell\ +=\ 1;}
\DoxyCodeLine{00816\ \ \ \ \ \ \ \ \ \ \ \ \ ex\ +=\ 1;}
\DoxyCodeLine{00817\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00818\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ finish\ computing\ the\ X(i)\ block\ */}}
\DoxyCodeLine{00819\ \ \ \ \ \ \ \ \ Z11\ =\ ex[0]\ -\/\ Z11;}
\DoxyCodeLine{00820\ \ \ \ \ \ \ \ \ ex[0]\ =\ Z11;}
\DoxyCodeLine{00821\ \ \ \ \ \}}
\DoxyCodeLine{00822\ \}}
\DoxyCodeLine{00823\ }
\DoxyCodeLine{00824\ \textcolor{comment}{/*\ solve\ L\string^T\ *\ x=b,\ with\ b\ containing\ 1\ right\ hand\ side.}}
\DoxyCodeLine{00825\ \textcolor{comment}{\ *\ L\ is\ an\ n*n\ lower\ triangular\ matrix\ with\ ones\ on\ the\ diagonal.}}
\DoxyCodeLine{00826\ \textcolor{comment}{\ *\ L\ is\ stored\ by\ rows\ and\ its\ leading\ dimension\ is\ lskip.}}
\DoxyCodeLine{00827\ \textcolor{comment}{\ *\ b\ is\ an\ n*1\ matrix\ that\ contains\ the\ right\ hand\ side.}}
\DoxyCodeLine{00828\ \textcolor{comment}{\ *\ b\ is\ overwritten\ with\ x.}}
\DoxyCodeLine{00829\ \textcolor{comment}{\ *\ this\ processes\ blocks\ of\ 4.}}
\DoxyCodeLine{00830\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00831\ }
\DoxyCodeLine{00832\ \textcolor{keywordtype}{void}\ btSolveL1T(\textcolor{keyword}{const}\ btScalar\ *L,\ btScalar\ *B,\ \textcolor{keywordtype}{int}\ n,\ \textcolor{keywordtype}{int}\ lskip1)}
\DoxyCodeLine{00833\ \{}
\DoxyCodeLine{00834\ \ \ \ \ \textcolor{comment}{/*\ declare\ variables\ -\/\ Z\ matrix,\ p\ and\ q\ vectors,\ etc\ */}}
\DoxyCodeLine{00835\ \ \ \ \ btScalar\ Z11,\ m11,\ Z21,\ m21,\ Z31,\ m31,\ Z41,\ m41,\ p1,\ q1,\ p2,\ p3,\ p4,\ *ex;}
\DoxyCodeLine{00836\ \ \ \ \ \textcolor{keyword}{const}\ btScalar\ *ell;}
\DoxyCodeLine{00837\ \ \ \ \ \textcolor{keywordtype}{int}\ lskip2,\ i,\ j;}
\DoxyCodeLine{00838\ \ \ \ \ \textcolor{comment}{//\ \ int\ lskip3;}}
\DoxyCodeLine{00839\ \ \ \ \ \textcolor{comment}{/*\ special\ handling\ for\ L\ and\ B\ because\ we're\ solving\ L1\ *transpose*\ */}}
\DoxyCodeLine{00840\ \ \ \ \ L\ =\ L\ +\ (n\ -\/\ 1)\ *\ (lskip1\ +\ 1);}
\DoxyCodeLine{00841\ \ \ \ \ B\ =\ B\ +\ n\ -\/\ 1;}
\DoxyCodeLine{00842\ \ \ \ \ lskip1\ =\ -\/lskip1;}
\DoxyCodeLine{00843\ \ \ \ \ \textcolor{comment}{/*\ compute\ lskip\ values\ */}}
\DoxyCodeLine{00844\ \ \ \ \ lskip2\ =\ 2\ *\ lskip1;}
\DoxyCodeLine{00845\ \ \ \ \ \textcolor{comment}{//lskip3\ =\ 3*lskip1;}}
\DoxyCodeLine{00846\ \ \ \ \ \textcolor{comment}{/*\ compute\ all\ 4\ x\ 1\ blocks\ of\ X\ */}}
\DoxyCodeLine{00847\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <=\ n\ -\/\ 4;\ i\ +=\ 4)}
\DoxyCodeLine{00848\ \ \ \ \ \{}
\DoxyCodeLine{00849\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ all\ 4\ x\ 1\ block\ of\ X,\ from\ rows\ i..i+4-\/1\ */}}
\DoxyCodeLine{00850\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ set\ the\ Z\ matrix\ to\ 0\ */}}
\DoxyCodeLine{00851\ \ \ \ \ \ \ \ \ Z11\ =\ 0;}
\DoxyCodeLine{00852\ \ \ \ \ \ \ \ \ Z21\ =\ 0;}
\DoxyCodeLine{00853\ \ \ \ \ \ \ \ \ Z31\ =\ 0;}
\DoxyCodeLine{00854\ \ \ \ \ \ \ \ \ Z41\ =\ 0;}
\DoxyCodeLine{00855\ \ \ \ \ \ \ \ \ ell\ =\ L\ -\/\ i;}
\DoxyCodeLine{00856\ \ \ \ \ \ \ \ \ ex\ =\ B;}
\DoxyCodeLine{00857\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ the\ inner\ loop\ that\ computes\ outer\ products\ and\ adds\ them\ to\ Z\ */}}
\DoxyCodeLine{00858\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ i\ -\/\ 4;\ j\ >=\ 0;\ j\ -\/=\ 4)}
\DoxyCodeLine{00859\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00860\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00861\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[0];}
\DoxyCodeLine{00862\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[0];}
\DoxyCodeLine{00863\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ ell[-\/1];}
\DoxyCodeLine{00864\ \ \ \ \ \ \ \ \ \ \ \ \ p3\ =\ ell[-\/2];}
\DoxyCodeLine{00865\ \ \ \ \ \ \ \ \ \ \ \ \ p4\ =\ ell[-\/3];}
\DoxyCodeLine{00866\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00867\ \ \ \ \ \ \ \ \ \ \ \ \ m11\ =\ p1\ *\ q1;}
\DoxyCodeLine{00868\ \ \ \ \ \ \ \ \ \ \ \ \ m21\ =\ p2\ *\ q1;}
\DoxyCodeLine{00869\ \ \ \ \ \ \ \ \ \ \ \ \ m31\ =\ p3\ *\ q1;}
\DoxyCodeLine{00870\ \ \ \ \ \ \ \ \ \ \ \ \ m41\ =\ p4\ *\ q1;}
\DoxyCodeLine{00871\ \ \ \ \ \ \ \ \ \ \ \ \ ell\ +=\ lskip1;}
\DoxyCodeLine{00872\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ m11;}
\DoxyCodeLine{00873\ \ \ \ \ \ \ \ \ \ \ \ \ Z21\ +=\ m21;}
\DoxyCodeLine{00874\ \ \ \ \ \ \ \ \ \ \ \ \ Z31\ +=\ m31;}
\DoxyCodeLine{00875\ \ \ \ \ \ \ \ \ \ \ \ \ Z41\ +=\ m41;}
\DoxyCodeLine{00876\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00877\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[0];}
\DoxyCodeLine{00878\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[-\/1];}
\DoxyCodeLine{00879\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ ell[-\/1];}
\DoxyCodeLine{00880\ \ \ \ \ \ \ \ \ \ \ \ \ p3\ =\ ell[-\/2];}
\DoxyCodeLine{00881\ \ \ \ \ \ \ \ \ \ \ \ \ p4\ =\ ell[-\/3];}
\DoxyCodeLine{00882\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00883\ \ \ \ \ \ \ \ \ \ \ \ \ m11\ =\ p1\ *\ q1;}
\DoxyCodeLine{00884\ \ \ \ \ \ \ \ \ \ \ \ \ m21\ =\ p2\ *\ q1;}
\DoxyCodeLine{00885\ \ \ \ \ \ \ \ \ \ \ \ \ m31\ =\ p3\ *\ q1;}
\DoxyCodeLine{00886\ \ \ \ \ \ \ \ \ \ \ \ \ m41\ =\ p4\ *\ q1;}
\DoxyCodeLine{00887\ \ \ \ \ \ \ \ \ \ \ \ \ ell\ +=\ lskip1;}
\DoxyCodeLine{00888\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ m11;}
\DoxyCodeLine{00889\ \ \ \ \ \ \ \ \ \ \ \ \ Z21\ +=\ m21;}
\DoxyCodeLine{00890\ \ \ \ \ \ \ \ \ \ \ \ \ Z31\ +=\ m31;}
\DoxyCodeLine{00891\ \ \ \ \ \ \ \ \ \ \ \ \ Z41\ +=\ m41;}
\DoxyCodeLine{00892\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00893\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[0];}
\DoxyCodeLine{00894\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[-\/2];}
\DoxyCodeLine{00895\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ ell[-\/1];}
\DoxyCodeLine{00896\ \ \ \ \ \ \ \ \ \ \ \ \ p3\ =\ ell[-\/2];}
\DoxyCodeLine{00897\ \ \ \ \ \ \ \ \ \ \ \ \ p4\ =\ ell[-\/3];}
\DoxyCodeLine{00898\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00899\ \ \ \ \ \ \ \ \ \ \ \ \ m11\ =\ p1\ *\ q1;}
\DoxyCodeLine{00900\ \ \ \ \ \ \ \ \ \ \ \ \ m21\ =\ p2\ *\ q1;}
\DoxyCodeLine{00901\ \ \ \ \ \ \ \ \ \ \ \ \ m31\ =\ p3\ *\ q1;}
\DoxyCodeLine{00902\ \ \ \ \ \ \ \ \ \ \ \ \ m41\ =\ p4\ *\ q1;}
\DoxyCodeLine{00903\ \ \ \ \ \ \ \ \ \ \ \ \ ell\ +=\ lskip1;}
\DoxyCodeLine{00904\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ m11;}
\DoxyCodeLine{00905\ \ \ \ \ \ \ \ \ \ \ \ \ Z21\ +=\ m21;}
\DoxyCodeLine{00906\ \ \ \ \ \ \ \ \ \ \ \ \ Z31\ +=\ m31;}
\DoxyCodeLine{00907\ \ \ \ \ \ \ \ \ \ \ \ \ Z41\ +=\ m41;}
\DoxyCodeLine{00908\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00909\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[0];}
\DoxyCodeLine{00910\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[-\/3];}
\DoxyCodeLine{00911\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ ell[-\/1];}
\DoxyCodeLine{00912\ \ \ \ \ \ \ \ \ \ \ \ \ p3\ =\ ell[-\/2];}
\DoxyCodeLine{00913\ \ \ \ \ \ \ \ \ \ \ \ \ p4\ =\ ell[-\/3];}
\DoxyCodeLine{00914\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00915\ \ \ \ \ \ \ \ \ \ \ \ \ m11\ =\ p1\ *\ q1;}
\DoxyCodeLine{00916\ \ \ \ \ \ \ \ \ \ \ \ \ m21\ =\ p2\ *\ q1;}
\DoxyCodeLine{00917\ \ \ \ \ \ \ \ \ \ \ \ \ m31\ =\ p3\ *\ q1;}
\DoxyCodeLine{00918\ \ \ \ \ \ \ \ \ \ \ \ \ m41\ =\ p4\ *\ q1;}
\DoxyCodeLine{00919\ \ \ \ \ \ \ \ \ \ \ \ \ ell\ +=\ lskip1;}
\DoxyCodeLine{00920\ \ \ \ \ \ \ \ \ \ \ \ \ ex\ -\/=\ 4;}
\DoxyCodeLine{00921\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ m11;}
\DoxyCodeLine{00922\ \ \ \ \ \ \ \ \ \ \ \ \ Z21\ +=\ m21;}
\DoxyCodeLine{00923\ \ \ \ \ \ \ \ \ \ \ \ \ Z31\ +=\ m31;}
\DoxyCodeLine{00924\ \ \ \ \ \ \ \ \ \ \ \ \ Z41\ +=\ m41;}
\DoxyCodeLine{00925\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ end\ of\ inner\ loop\ */}}
\DoxyCodeLine{00926\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00927\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ left-\/over\ iterations\ */}}
\DoxyCodeLine{00928\ \ \ \ \ \ \ \ \ j\ +=\ 4;}
\DoxyCodeLine{00929\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ j\ >\ 0;\ j-\/-\/)}
\DoxyCodeLine{00930\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00931\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00932\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[0];}
\DoxyCodeLine{00933\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[0];}
\DoxyCodeLine{00934\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ ell[-\/1];}
\DoxyCodeLine{00935\ \ \ \ \ \ \ \ \ \ \ \ \ p3\ =\ ell[-\/2];}
\DoxyCodeLine{00936\ \ \ \ \ \ \ \ \ \ \ \ \ p4\ =\ ell[-\/3];}
\DoxyCodeLine{00937\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00938\ \ \ \ \ \ \ \ \ \ \ \ \ m11\ =\ p1\ *\ q1;}
\DoxyCodeLine{00939\ \ \ \ \ \ \ \ \ \ \ \ \ m21\ =\ p2\ *\ q1;}
\DoxyCodeLine{00940\ \ \ \ \ \ \ \ \ \ \ \ \ m31\ =\ p3\ *\ q1;}
\DoxyCodeLine{00941\ \ \ \ \ \ \ \ \ \ \ \ \ m41\ =\ p4\ *\ q1;}
\DoxyCodeLine{00942\ \ \ \ \ \ \ \ \ \ \ \ \ ell\ +=\ lskip1;}
\DoxyCodeLine{00943\ \ \ \ \ \ \ \ \ \ \ \ \ ex\ -\/=\ 1;}
\DoxyCodeLine{00944\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ m11;}
\DoxyCodeLine{00945\ \ \ \ \ \ \ \ \ \ \ \ \ Z21\ +=\ m21;}
\DoxyCodeLine{00946\ \ \ \ \ \ \ \ \ \ \ \ \ Z31\ +=\ m31;}
\DoxyCodeLine{00947\ \ \ \ \ \ \ \ \ \ \ \ \ Z41\ +=\ m41;}
\DoxyCodeLine{00948\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00949\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ finish\ computing\ the\ X(i)\ block\ */}}
\DoxyCodeLine{00950\ \ \ \ \ \ \ \ \ Z11\ =\ ex[0]\ -\/\ Z11;}
\DoxyCodeLine{00951\ \ \ \ \ \ \ \ \ ex[0]\ =\ Z11;}
\DoxyCodeLine{00952\ \ \ \ \ \ \ \ \ p1\ =\ ell[-\/1];}
\DoxyCodeLine{00953\ \ \ \ \ \ \ \ \ Z21\ =\ ex[-\/1]\ -\/\ Z21\ -\/\ p1\ *\ Z11;}
\DoxyCodeLine{00954\ \ \ \ \ \ \ \ \ ex[-\/1]\ =\ Z21;}
\DoxyCodeLine{00955\ \ \ \ \ \ \ \ \ p1\ =\ ell[-\/2];}
\DoxyCodeLine{00956\ \ \ \ \ \ \ \ \ p2\ =\ ell[-\/2\ +\ lskip1];}
\DoxyCodeLine{00957\ \ \ \ \ \ \ \ \ Z31\ =\ ex[-\/2]\ -\/\ Z31\ -\/\ p1\ *\ Z11\ -\/\ p2\ *\ Z21;}
\DoxyCodeLine{00958\ \ \ \ \ \ \ \ \ ex[-\/2]\ =\ Z31;}
\DoxyCodeLine{00959\ \ \ \ \ \ \ \ \ p1\ =\ ell[-\/3];}
\DoxyCodeLine{00960\ \ \ \ \ \ \ \ \ p2\ =\ ell[-\/3\ +\ lskip1];}
\DoxyCodeLine{00961\ \ \ \ \ \ \ \ \ p3\ =\ ell[-\/3\ +\ lskip2];}
\DoxyCodeLine{00962\ \ \ \ \ \ \ \ \ Z41\ =\ ex[-\/3]\ -\/\ Z41\ -\/\ p1\ *\ Z11\ -\/\ p2\ *\ Z21\ -\/\ p3\ *\ Z31;}
\DoxyCodeLine{00963\ \ \ \ \ \ \ \ \ ex[-\/3]\ =\ Z41;}
\DoxyCodeLine{00964\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ end\ of\ outer\ loop\ */}}
\DoxyCodeLine{00965\ \ \ \ \ \}}
\DoxyCodeLine{00966\ \ \ \ \ \textcolor{comment}{/*\ compute\ rows\ at\ end\ that\ are\ not\ a\ multiple\ of\ block\ size\ */}}
\DoxyCodeLine{00967\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ i\ <\ n;\ i++)}
\DoxyCodeLine{00968\ \ \ \ \ \{}
\DoxyCodeLine{00969\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ all\ 1\ x\ 1\ block\ of\ X,\ from\ rows\ i..i+1-\/1\ */}}
\DoxyCodeLine{00970\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ set\ the\ Z\ matrix\ to\ 0\ */}}
\DoxyCodeLine{00971\ \ \ \ \ \ \ \ \ Z11\ =\ 0;}
\DoxyCodeLine{00972\ \ \ \ \ \ \ \ \ ell\ =\ L\ -\/\ i;}
\DoxyCodeLine{00973\ \ \ \ \ \ \ \ \ ex\ =\ B;}
\DoxyCodeLine{00974\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ the\ inner\ loop\ that\ computes\ outer\ products\ and\ adds\ them\ to\ Z\ */}}
\DoxyCodeLine{00975\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ i\ -\/\ 4;\ j\ >=\ 0;\ j\ -\/=\ 4)}
\DoxyCodeLine{00976\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00977\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00978\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[0];}
\DoxyCodeLine{00979\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[0];}
\DoxyCodeLine{00980\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00981\ \ \ \ \ \ \ \ \ \ \ \ \ m11\ =\ p1\ *\ q1;}
\DoxyCodeLine{00982\ \ \ \ \ \ \ \ \ \ \ \ \ ell\ +=\ lskip1;}
\DoxyCodeLine{00983\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ m11;}
\DoxyCodeLine{00984\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00985\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[0];}
\DoxyCodeLine{00986\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[-\/1];}
\DoxyCodeLine{00987\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00988\ \ \ \ \ \ \ \ \ \ \ \ \ m11\ =\ p1\ *\ q1;}
\DoxyCodeLine{00989\ \ \ \ \ \ \ \ \ \ \ \ \ ell\ +=\ lskip1;}
\DoxyCodeLine{00990\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ m11;}
\DoxyCodeLine{00991\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00992\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[0];}
\DoxyCodeLine{00993\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[-\/2];}
\DoxyCodeLine{00994\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{00995\ \ \ \ \ \ \ \ \ \ \ \ \ m11\ =\ p1\ *\ q1;}
\DoxyCodeLine{00996\ \ \ \ \ \ \ \ \ \ \ \ \ ell\ +=\ lskip1;}
\DoxyCodeLine{00997\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ m11;}
\DoxyCodeLine{00998\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{00999\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[0];}
\DoxyCodeLine{01000\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[-\/3];}
\DoxyCodeLine{01001\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{01002\ \ \ \ \ \ \ \ \ \ \ \ \ m11\ =\ p1\ *\ q1;}
\DoxyCodeLine{01003\ \ \ \ \ \ \ \ \ \ \ \ \ ell\ +=\ lskip1;}
\DoxyCodeLine{01004\ \ \ \ \ \ \ \ \ \ \ \ \ ex\ -\/=\ 4;}
\DoxyCodeLine{01005\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ m11;}
\DoxyCodeLine{01006\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ end\ of\ inner\ loop\ */}}
\DoxyCodeLine{01007\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01008\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ left-\/over\ iterations\ */}}
\DoxyCodeLine{01009\ \ \ \ \ \ \ \ \ j\ +=\ 4;}
\DoxyCodeLine{01010\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ j\ >\ 0;\ j-\/-\/)}
\DoxyCodeLine{01011\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01012\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ load\ p\ and\ q\ values\ */}}
\DoxyCodeLine{01013\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ ell[0];}
\DoxyCodeLine{01014\ \ \ \ \ \ \ \ \ \ \ \ \ q1\ =\ ex[0];}
\DoxyCodeLine{01015\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ outer\ product\ and\ add\ it\ to\ the\ Z\ matrix\ */}}
\DoxyCodeLine{01016\ \ \ \ \ \ \ \ \ \ \ \ \ m11\ =\ p1\ *\ q1;}
\DoxyCodeLine{01017\ \ \ \ \ \ \ \ \ \ \ \ \ ell\ +=\ lskip1;}
\DoxyCodeLine{01018\ \ \ \ \ \ \ \ \ \ \ \ \ ex\ -\/=\ 1;}
\DoxyCodeLine{01019\ \ \ \ \ \ \ \ \ \ \ \ \ Z11\ +=\ m11;}
\DoxyCodeLine{01020\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01021\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ finish\ computing\ the\ X(i)\ block\ */}}
\DoxyCodeLine{01022\ \ \ \ \ \ \ \ \ Z11\ =\ ex[0]\ -\/\ Z11;}
\DoxyCodeLine{01023\ \ \ \ \ \ \ \ \ ex[0]\ =\ Z11;}
\DoxyCodeLine{01024\ \ \ \ \ \}}
\DoxyCodeLine{01025\ \}}
\DoxyCodeLine{01026\ }
\DoxyCodeLine{01027\ \textcolor{keywordtype}{void}\ btVectorScale(btScalar\ *a,\ \textcolor{keyword}{const}\ btScalar\ *d,\ \textcolor{keywordtype}{int}\ n)}
\DoxyCodeLine{01028\ \{}
\DoxyCodeLine{01029\ \ \ \ \ btAssert(a\ \&\&\ d\ \&\&\ n\ >=\ 0);}
\DoxyCodeLine{01030\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ n;\ i++)}
\DoxyCodeLine{01031\ \ \ \ \ \{}
\DoxyCodeLine{01032\ \ \ \ \ \ \ \ \ a[i]\ *=\ d[i];}
\DoxyCodeLine{01033\ \ \ \ \ \}}
\DoxyCodeLine{01034\ \}}
\DoxyCodeLine{01035\ }
\DoxyCodeLine{01036\ \textcolor{keywordtype}{void}\ btSolveLDLT(\textcolor{keyword}{const}\ btScalar\ *L,\ \textcolor{keyword}{const}\ btScalar\ *d,\ btScalar\ *b,\ \textcolor{keywordtype}{int}\ n,\ \textcolor{keywordtype}{int}\ nskip)}
\DoxyCodeLine{01037\ \{}
\DoxyCodeLine{01038\ \ \ \ \ btAssert(L\ \&\&\ d\ \&\&\ b\ \&\&\ n\ >\ 0\ \&\&\ nskip\ >=\ n);}
\DoxyCodeLine{01039\ \ \ \ \ btSolveL1(L,\ b,\ n,\ nskip);}
\DoxyCodeLine{01040\ \ \ \ \ btVectorScale(b,\ d,\ n);}
\DoxyCodeLine{01041\ \ \ \ \ btSolveL1T(L,\ b,\ n,\ nskip);}
\DoxyCodeLine{01042\ \}}
\DoxyCodeLine{01043\ }
\DoxyCodeLine{01044\ \textcolor{comment}{//***************************************************************************}}
\DoxyCodeLine{01045\ }
\DoxyCodeLine{01046\ \textcolor{comment}{//\ swap\ row/column\ i1\ with\ i2\ in\ the\ n*n\ matrix\ A.\ the\ leading\ dimension\ of}}
\DoxyCodeLine{01047\ \textcolor{comment}{//\ A\ is\ nskip.\ this\ only\ references\ and\ swaps\ the\ lower\ triangle.}}
\DoxyCodeLine{01048\ \textcolor{comment}{//\ if\ \`{}do\_fast\_row\_swaps'\ is\ nonzero\ and\ row\ pointers\ are\ being\ used,\ then}}
\DoxyCodeLine{01049\ \textcolor{comment}{//\ rows\ will\ be\ swapped\ by\ exchanging\ row\ pointers.\ otherwise\ the\ data\ will}}
\DoxyCodeLine{01050\ \textcolor{comment}{//\ be\ copied.}}
\DoxyCodeLine{01051\ }
\DoxyCodeLine{01052\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ btSwapRowsAndCols(BTATYPE\ A,\ \textcolor{keywordtype}{int}\ n,\ \textcolor{keywordtype}{int}\ i1,\ \textcolor{keywordtype}{int}\ i2,\ \textcolor{keywordtype}{int}\ nskip,}
\DoxyCodeLine{01053\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ do\_fast\_row\_swaps)}
\DoxyCodeLine{01054\ \{}
\DoxyCodeLine{01055\ \ \ \ \ btAssert(A\ \&\&\ n\ >\ 0\ \&\&\ i1\ >=\ 0\ \&\&\ i2\ >=\ 0\ \&\&\ i1\ <\ n\ \&\&\ i2\ <\ n\ \&\&}
\DoxyCodeLine{01056\ \ \ \ \ \ \ \ \ \ \ \ \ \ nskip\ >=\ n\ \&\&\ i1\ <\ i2);}
\DoxyCodeLine{01057\ }
\DoxyCodeLine{01058\ \textcolor{preprocessor}{\#ifdef\ BTROWPTRS}}
\DoxyCodeLine{01059\ \ \ \ \ btScalar\ *A\_i1\ =\ A[i1];}
\DoxyCodeLine{01060\ \ \ \ \ btScalar\ *A\_i2\ =\ A[i2];}
\DoxyCodeLine{01061\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ i1\ +\ 1;\ i\ <\ i2;\ ++i)}
\DoxyCodeLine{01062\ \ \ \ \ \{}
\DoxyCodeLine{01063\ \ \ \ \ \ \ \ \ btScalar\ *A\_i\_i1\ =\ A[i]\ +\ i1;}
\DoxyCodeLine{01064\ \ \ \ \ \ \ \ \ A\_i1[i]\ =\ *A\_i\_i1;}
\DoxyCodeLine{01065\ \ \ \ \ \ \ \ \ *A\_i\_i1\ =\ A\_i2[i];}
\DoxyCodeLine{01066\ \ \ \ \ \}}
\DoxyCodeLine{01067\ \ \ \ \ A\_i1[i2]\ =\ A\_i1[i1];}
\DoxyCodeLine{01068\ \ \ \ \ A\_i1[i1]\ =\ A\_i2[i1];}
\DoxyCodeLine{01069\ \ \ \ \ A\_i2[i1]\ =\ A\_i2[i2];}
\DoxyCodeLine{01070\ \ \ \ \ \textcolor{comment}{//\ swap\ rows,\ by\ swapping\ row\ pointers}}
\DoxyCodeLine{01071\ \ \ \ \ \textcolor{keywordflow}{if}\ (do\_fast\_row\_swaps)}
\DoxyCodeLine{01072\ \ \ \ \ \{}
\DoxyCodeLine{01073\ \ \ \ \ \ \ \ \ A[i1]\ =\ A\_i2;}
\DoxyCodeLine{01074\ \ \ \ \ \ \ \ \ A[i2]\ =\ A\_i1;}
\DoxyCodeLine{01075\ \ \ \ \ \}}
\DoxyCodeLine{01076\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01077\ \ \ \ \ \{}
\DoxyCodeLine{01078\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Only\ swap\ till\ i2\ column\ to\ match\ A\ plain\ storage\ variant.}}
\DoxyCodeLine{01079\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <=\ i2;\ ++k)}
\DoxyCodeLine{01080\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01081\ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ tmp\ =\ A\_i1[k];}
\DoxyCodeLine{01082\ \ \ \ \ \ \ \ \ \ \ \ \ A\_i1[k]\ =\ A\_i2[k];}
\DoxyCodeLine{01083\ \ \ \ \ \ \ \ \ \ \ \ \ A\_i2[k]\ =\ tmp;}
\DoxyCodeLine{01084\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01085\ \ \ \ \ \}}
\DoxyCodeLine{01086\ \ \ \ \ \textcolor{comment}{//\ swap\ columns\ the\ hard\ way}}
\DoxyCodeLine{01087\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ i2\ +\ 1;\ j\ <\ n;\ ++j)}
\DoxyCodeLine{01088\ \ \ \ \ \{}
\DoxyCodeLine{01089\ \ \ \ \ \ \ \ \ btScalar\ *A\_j\ =\ A[j];}
\DoxyCodeLine{01090\ \ \ \ \ \ \ \ \ btScalar\ tmp\ =\ A\_j[i1];}
\DoxyCodeLine{01091\ \ \ \ \ \ \ \ \ A\_j[i1]\ =\ A\_j[i2];}
\DoxyCodeLine{01092\ \ \ \ \ \ \ \ \ A\_j[i2]\ =\ tmp;}
\DoxyCodeLine{01093\ \ \ \ \ \}}
\DoxyCodeLine{01094\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01095\ \ \ \ \ btScalar\ *A\_i1\ =\ A\ +\ i1\ *\ nskip;}
\DoxyCodeLine{01096\ \ \ \ \ btScalar\ *A\_i2\ =\ A\ +\ i2\ *\ nskip;}
\DoxyCodeLine{01097\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ i1;\ ++k)}
\DoxyCodeLine{01098\ \ \ \ \ \{}
\DoxyCodeLine{01099\ \ \ \ \ \ \ \ \ btScalar\ tmp\ =\ A\_i1[k];}
\DoxyCodeLine{01100\ \ \ \ \ \ \ \ \ A\_i1[k]\ =\ A\_i2[k];}
\DoxyCodeLine{01101\ \ \ \ \ \ \ \ \ A\_i2[k]\ =\ tmp;}
\DoxyCodeLine{01102\ \ \ \ \ \}}
\DoxyCodeLine{01103\ \ \ \ \ btScalar\ *A\_i\ =\ A\_i1\ +\ nskip;}
\DoxyCodeLine{01104\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ i1\ +\ 1;\ i\ <\ i2;\ A\_i\ +=\ nskip,\ ++i)}
\DoxyCodeLine{01105\ \ \ \ \ \{}
\DoxyCodeLine{01106\ \ \ \ \ \ \ \ \ btScalar\ tmp\ =\ A\_i2[i];}
\DoxyCodeLine{01107\ \ \ \ \ \ \ \ \ A\_i2[i]\ =\ A\_i[i1];}
\DoxyCodeLine{01108\ \ \ \ \ \ \ \ \ A\_i[i1]\ =\ tmp;}
\DoxyCodeLine{01109\ \ \ \ \ \}}
\DoxyCodeLine{01110\ \ \ \ \ \{}
\DoxyCodeLine{01111\ \ \ \ \ \ \ \ \ btScalar\ tmp\ =\ A\_i1[i1];}
\DoxyCodeLine{01112\ \ \ \ \ \ \ \ \ A\_i1[i1]\ =\ A\_i2[i2];}
\DoxyCodeLine{01113\ \ \ \ \ \ \ \ \ A\_i2[i2]\ =\ tmp;}
\DoxyCodeLine{01114\ \ \ \ \ \}}
\DoxyCodeLine{01115\ \ \ \ \ btScalar\ *A\_j\ =\ A\_i2\ +\ nskip;}
\DoxyCodeLine{01116\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ i2\ +\ 1;\ j\ <\ n;\ A\_j\ +=\ nskip,\ ++j)}
\DoxyCodeLine{01117\ \ \ \ \ \{}
\DoxyCodeLine{01118\ \ \ \ \ \ \ \ \ btScalar\ tmp\ =\ A\_j[i1];}
\DoxyCodeLine{01119\ \ \ \ \ \ \ \ \ A\_j[i1]\ =\ A\_j[i2];}
\DoxyCodeLine{01120\ \ \ \ \ \ \ \ \ A\_j[i2]\ =\ tmp;}
\DoxyCodeLine{01121\ \ \ \ \ \}}
\DoxyCodeLine{01122\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01123\ \}}
\DoxyCodeLine{01124\ }
\DoxyCodeLine{01125\ \textcolor{comment}{//\ swap\ two\ indexes\ in\ the\ n*n\ LCP\ problem.\ i1\ must\ be\ <=\ i2.}}
\DoxyCodeLine{01126\ }
\DoxyCodeLine{01127\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ btSwapProblem(BTATYPE\ A,\ btScalar\ *x,\ btScalar\ *b,\ btScalar\ *w,\ btScalar\ *lo,}
\DoxyCodeLine{01128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ *hi,\ \textcolor{keywordtype}{int}\ *p,\ \textcolor{keywordtype}{bool}\ *state,\ \textcolor{keywordtype}{int}\ *findex,}
\DoxyCodeLine{01129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ n,\ \textcolor{keywordtype}{int}\ i1,\ \textcolor{keywordtype}{int}\ i2,\ \textcolor{keywordtype}{int}\ nskip,}
\DoxyCodeLine{01130\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ do\_fast\_row\_swaps)}
\DoxyCodeLine{01131\ \{}
\DoxyCodeLine{01132\ \ \ \ \ btScalar\ tmpr;}
\DoxyCodeLine{01133\ \ \ \ \ \textcolor{keywordtype}{int}\ tmpi;}
\DoxyCodeLine{01134\ \ \ \ \ \textcolor{keywordtype}{bool}\ tmpb;}
\DoxyCodeLine{01135\ \ \ \ \ btAssert(n\ >\ 0\ \&\&\ i1\ >=\ 0\ \&\&\ i2\ >=\ 0\ \&\&\ i1\ <\ n\ \&\&\ i2\ <\ n\ \&\&\ nskip\ >=\ n\ \&\&\ i1\ <=\ i2);}
\DoxyCodeLine{01136\ \ \ \ \ \textcolor{keywordflow}{if}\ (i1\ ==\ i2)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01137\ }
\DoxyCodeLine{01138\ \ \ \ \ btSwapRowsAndCols(A,\ n,\ i1,\ i2,\ nskip,\ do\_fast\_row\_swaps);}
\DoxyCodeLine{01139\ }
\DoxyCodeLine{01140\ \ \ \ \ tmpr\ =\ x[i1];}
\DoxyCodeLine{01141\ \ \ \ \ x[i1]\ =\ x[i2];}
\DoxyCodeLine{01142\ \ \ \ \ x[i2]\ =\ tmpr;}
\DoxyCodeLine{01143\ }
\DoxyCodeLine{01144\ \ \ \ \ tmpr\ =\ b[i1];}
\DoxyCodeLine{01145\ \ \ \ \ b[i1]\ =\ b[i2];}
\DoxyCodeLine{01146\ \ \ \ \ b[i2]\ =\ tmpr;}
\DoxyCodeLine{01147\ }
\DoxyCodeLine{01148\ \ \ \ \ tmpr\ =\ w[i1];}
\DoxyCodeLine{01149\ \ \ \ \ w[i1]\ =\ w[i2];}
\DoxyCodeLine{01150\ \ \ \ \ w[i2]\ =\ tmpr;}
\DoxyCodeLine{01151\ }
\DoxyCodeLine{01152\ \ \ \ \ tmpr\ =\ lo[i1];}
\DoxyCodeLine{01153\ \ \ \ \ lo[i1]\ =\ lo[i2];}
\DoxyCodeLine{01154\ \ \ \ \ lo[i2]\ =\ tmpr;}
\DoxyCodeLine{01155\ }
\DoxyCodeLine{01156\ \ \ \ \ tmpr\ =\ hi[i1];}
\DoxyCodeLine{01157\ \ \ \ \ hi[i1]\ =\ hi[i2];}
\DoxyCodeLine{01158\ \ \ \ \ hi[i2]\ =\ tmpr;}
\DoxyCodeLine{01159\ }
\DoxyCodeLine{01160\ \ \ \ \ tmpi\ =\ p[i1];}
\DoxyCodeLine{01161\ \ \ \ \ p[i1]\ =\ p[i2];}
\DoxyCodeLine{01162\ \ \ \ \ p[i2]\ =\ tmpi;}
\DoxyCodeLine{01163\ }
\DoxyCodeLine{01164\ \ \ \ \ tmpb\ =\ state[i1];}
\DoxyCodeLine{01165\ \ \ \ \ state[i1]\ =\ state[i2];}
\DoxyCodeLine{01166\ \ \ \ \ state[i2]\ =\ tmpb;}
\DoxyCodeLine{01167\ }
\DoxyCodeLine{01168\ \ \ \ \ \textcolor{keywordflow}{if}\ (findex)}
\DoxyCodeLine{01169\ \ \ \ \ \{}
\DoxyCodeLine{01170\ \ \ \ \ \ \ \ \ tmpi\ =\ findex[i1];}
\DoxyCodeLine{01171\ \ \ \ \ \ \ \ \ findex[i1]\ =\ findex[i2];}
\DoxyCodeLine{01172\ \ \ \ \ \ \ \ \ findex[i2]\ =\ tmpi;}
\DoxyCodeLine{01173\ \ \ \ \ \}}
\DoxyCodeLine{01174\ \}}
\DoxyCodeLine{01175\ }
\DoxyCodeLine{01176\ \textcolor{comment}{//***************************************************************************}}
\DoxyCodeLine{01177\ \textcolor{comment}{//\ btLCP\ manipulator\ object.\ this\ represents\ an\ n*n\ LCP\ problem.}}
\DoxyCodeLine{01178\ \textcolor{comment}{//}}
\DoxyCodeLine{01179\ \textcolor{comment}{//\ two\ index\ sets\ C\ and\ N\ are\ kept.\ each\ set\ holds\ a\ subset\ of}}
\DoxyCodeLine{01180\ \textcolor{comment}{//\ the\ variable\ indexes\ 0..n-\/1.\ an\ index\ can\ only\ be\ in\ one\ set.}}
\DoxyCodeLine{01181\ \textcolor{comment}{//\ initially\ both\ sets\ are\ empty.}}
\DoxyCodeLine{01182\ \textcolor{comment}{//}}
\DoxyCodeLine{01183\ \textcolor{comment}{//\ the\ index\ set\ C\ is\ special:\ solutions\ to\ A(C,C)\(\backslash\)A(C,i)\ can\ be\ generated.}}
\DoxyCodeLine{01184\ }
\DoxyCodeLine{01185\ \textcolor{comment}{//***************************************************************************}}
\DoxyCodeLine{01186\ \textcolor{comment}{//\ fast\ implementation\ of\ btLCP.\ see\ the\ above\ definition\ of\ btLCP\ for}}
\DoxyCodeLine{01187\ \textcolor{comment}{//\ interface\ comments.}}
\DoxyCodeLine{01188\ \textcolor{comment}{//}}
\DoxyCodeLine{01189\ \textcolor{comment}{//\ \`{}p'\ records\ the\ permutation\ of\ A,x,b,w,etc.\ p\ is\ initially\ 1:n\ and\ is}}
\DoxyCodeLine{01190\ \textcolor{comment}{//\ permuted\ as\ the\ other\ vectors/matrices\ are\ permuted.}}
\DoxyCodeLine{01191\ \textcolor{comment}{//}}
\DoxyCodeLine{01192\ \textcolor{comment}{//\ A,x,b,w,lo,hi,state,findex,p,c\ are\ permuted\ such\ that\ sets\ C,N\ have}}
\DoxyCodeLine{01193\ \textcolor{comment}{//\ contiguous\ indexes.\ the\ don't-\/care\ indexes\ follow\ N.}}
\DoxyCodeLine{01194\ \textcolor{comment}{//}}
\DoxyCodeLine{01195\ \textcolor{comment}{//\ an\ L*D*L'\ factorization\ is\ maintained\ of\ A(C,C),\ and\ whenever\ indexes\ are}}
\DoxyCodeLine{01196\ \textcolor{comment}{//\ added\ or\ removed\ from\ the\ set\ C\ the\ factorization\ is\ updated.}}
\DoxyCodeLine{01197\ \textcolor{comment}{//\ thus\ L*D*L'=A[C,C],\ i.e.\ a\ permuted\ top\ left\ nC*nC\ submatrix\ of\ A.}}
\DoxyCodeLine{01198\ \textcolor{comment}{//\ the\ leading\ dimension\ of\ the\ matrix\ L\ is\ always\ \`{}nskip'.}}
\DoxyCodeLine{01199\ \textcolor{comment}{//}}
\DoxyCodeLine{01200\ \textcolor{comment}{//\ at\ the\ start\ there\ may\ be\ other\ indexes\ that\ are\ unbounded\ but\ are\ not}}
\DoxyCodeLine{01201\ \textcolor{comment}{//\ included\ in\ \`{}nub'.\ btLCP\ will\ permute\ the\ matrix\ so\ that\ absolutely\ all}}
\DoxyCodeLine{01202\ \textcolor{comment}{//\ unbounded\ vectors\ are\ at\ the\ start.\ thus\ there\ may\ be\ some\ initial}}
\DoxyCodeLine{01203\ \textcolor{comment}{//\ permutation.}}
\DoxyCodeLine{01204\ \textcolor{comment}{//}}
\DoxyCodeLine{01205\ \textcolor{comment}{//\ the\ algorithms\ here\ assume\ certain\ patterns,\ particularly\ with\ respect\ to}}
\DoxyCodeLine{01206\ \textcolor{comment}{//\ index\ transfer.}}
\DoxyCodeLine{01207\ }
\DoxyCodeLine{01208\ \textcolor{preprocessor}{\#ifdef\ btLCP\_FAST}}
\DoxyCodeLine{01209\ }
\DoxyCodeLine{01210\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structbt_l_c_p}{btLCP}}}
\DoxyCodeLine{01211\ \{}
\DoxyCodeLine{01212\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ m\_n;}
\DoxyCodeLine{01213\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ m\_nskip;}
\DoxyCodeLine{01214\ \ \ \ \ \textcolor{keywordtype}{int}\ m\_nub;}
\DoxyCodeLine{01215\ \ \ \ \ \textcolor{keywordtype}{int}\ m\_nC,\ m\_nN;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ size\ of\ each\ index\ set}}
\DoxyCodeLine{01216\ \ \ \ \ BTATYPE\ \textcolor{keyword}{const}\ m\_A;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ A\ rows}}
\DoxyCodeLine{01217\ \ \ \ \ btScalar\ *\textcolor{keyword}{const}\ m\_x,\ *\textcolor{keyword}{const}\ m\_b,\ *\textcolor{keyword}{const}\ m\_w,\ *\textcolor{keyword}{const}\ m\_lo,\ *\textcolor{keyword}{const}\ m\_hi;\ \ \textcolor{comment}{//\ permuted\ LCP\ problem\ data}}
\DoxyCodeLine{01218\ \ \ \ \ btScalar\ *\textcolor{keyword}{const}\ m\_L,\ *\textcolor{keyword}{const}\ m\_d;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ L*D*L'\ factorization\ of\ set\ C}}
\DoxyCodeLine{01219\ \ \ \ \ btScalar\ *\textcolor{keyword}{const}\ m\_Dell,\ *\textcolor{keyword}{const}\ m\_ell,\ *\textcolor{keyword}{const}\ m\_tmp;}
\DoxyCodeLine{01220\ \ \ \ \ \textcolor{keywordtype}{bool}\ *\textcolor{keyword}{const}\ m\_state;}
\DoxyCodeLine{01221\ \ \ \ \ \textcolor{keywordtype}{int}\ *\textcolor{keyword}{const}\ m\_findex,\ *\textcolor{keyword}{const}\ m\_p,\ *\textcolor{keyword}{const}\ m\_C;}
\DoxyCodeLine{01222\ }
\DoxyCodeLine{01223\ \ \ \ \ \mbox{\hyperlink{structbt_l_c_p}{btLCP}}(\textcolor{keywordtype}{int}\ \_n,\ \textcolor{keywordtype}{int}\ \_nskip,\ \textcolor{keywordtype}{int}\ \_nub,\ btScalar\ *\_Adata,\ btScalar\ *\_x,\ btScalar\ *\_b,\ btScalar\ *\_w,}
\DoxyCodeLine{01224\ \ \ \ \ \ \ \ \ \ \ btScalar\ *\_lo,\ btScalar\ *\_hi,\ btScalar\ *l,\ btScalar\ *\_d,}
\DoxyCodeLine{01225\ \ \ \ \ \ \ \ \ \ \ btScalar\ *\_Dell,\ btScalar\ *\_ell,\ btScalar\ *\_tmp,}
\DoxyCodeLine{01226\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ *\_state,\ \textcolor{keywordtype}{int}\ *\_findex,\ \textcolor{keywordtype}{int}\ *p,\ \textcolor{keywordtype}{int}\ *c,\ btScalar\ **Arows);}
\DoxyCodeLine{01227\ \ \ \ \ \textcolor{keywordtype}{int}\ getNub()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_nub;\ \}}
\DoxyCodeLine{01228\ \ \ \ \ \textcolor{keywordtype}{void}\ transfer\_i\_to\_C(\textcolor{keywordtype}{int}\ i);}
\DoxyCodeLine{01229\ \ \ \ \ \textcolor{keywordtype}{void}\ transfer\_i\_to\_N(\textcolor{keywordtype}{int}\ i)\ \{\ m\_nN++;\ \}\ \ \textcolor{comment}{//\ because\ we\ can\ assume\ C\ and\ N\ span\ 1:i-\/1}}
\DoxyCodeLine{01230\ \ \ \ \ \textcolor{keywordtype}{void}\ transfer\_i\_from\_N\_to\_C(\textcolor{keywordtype}{int}\ i);}
\DoxyCodeLine{01231\ \ \ \ \ \textcolor{keywordtype}{void}\ transfer\_i\_from\_C\_to\_N(\textcolor{keywordtype}{int}\ i,\ \mbox{\hyperlink{classbt_aligned_object_array}{btAlignedObjectArray<btScalar>}}\ \&scratch);}
\DoxyCodeLine{01232\ \ \ \ \ \textcolor{keywordtype}{int}\ numC()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_nC;\ \}}
\DoxyCodeLine{01233\ \ \ \ \ \textcolor{keywordtype}{int}\ numN()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_nN;\ \}}
\DoxyCodeLine{01234\ \ \ \ \ \textcolor{keywordtype}{int}\ indexC(\textcolor{keywordtype}{int}\ i)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ i;\ \}}
\DoxyCodeLine{01235\ \ \ \ \ \textcolor{keywordtype}{int}\ indexN(\textcolor{keywordtype}{int}\ i)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ i\ +\ m\_nC;\ \}}
\DoxyCodeLine{01236\ \ \ \ \ btScalar\ Aii(\textcolor{keywordtype}{int}\ i)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ BTAROW(i)[i];\ \}}
\DoxyCodeLine{01237\ \ \ \ \ btScalar\ AiC\_times\_qC(\textcolor{keywordtype}{int}\ i,\ btScalar\ *q)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ btLargeDot(BTAROW(i),\ q,\ m\_nC);\ \}}
\DoxyCodeLine{01238\ \ \ \ \ btScalar\ AiN\_times\_qN(\textcolor{keywordtype}{int}\ i,\ btScalar\ *q)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ btLargeDot(BTAROW(i)\ +\ m\_nC,\ q\ +\ m\_nC,\ m\_nN);\ \}}
\DoxyCodeLine{01239\ \ \ \ \ \textcolor{keywordtype}{void}\ pN\_equals\_ANC\_times\_qC(btScalar\ *p,\ btScalar\ *q);}
\DoxyCodeLine{01240\ \ \ \ \ \textcolor{keywordtype}{void}\ pN\_plusequals\_ANi(btScalar\ *p,\ \textcolor{keywordtype}{int}\ i,\ \textcolor{keywordtype}{int}\ sign\ =\ 1);}
\DoxyCodeLine{01241\ \ \ \ \ \textcolor{keywordtype}{void}\ pC\_plusequals\_s\_times\_qC(btScalar\ *p,\ btScalar\ s,\ btScalar\ *q);}
\DoxyCodeLine{01242\ \ \ \ \ \textcolor{keywordtype}{void}\ pN\_plusequals\_s\_times\_qN(btScalar\ *p,\ btScalar\ s,\ btScalar\ *q);}
\DoxyCodeLine{01243\ \ \ \ \ \textcolor{keywordtype}{void}\ solve1(btScalar\ *a,\ \textcolor{keywordtype}{int}\ i,\ \textcolor{keywordtype}{int}\ dir\ =\ 1,\ \textcolor{keywordtype}{int}\ only\_transfer\ =\ 0);}
\DoxyCodeLine{01244\ \ \ \ \ \textcolor{keywordtype}{void}\ unpermute();}
\DoxyCodeLine{01245\ \};}
\DoxyCodeLine{01246\ }
\DoxyCodeLine{01247\ btLCP::btLCP(\textcolor{keywordtype}{int}\ \_n,\ \textcolor{keywordtype}{int}\ \_nskip,\ \textcolor{keywordtype}{int}\ \_nub,\ btScalar\ *\_Adata,\ btScalar\ *\_x,\ btScalar\ *\_b,\ btScalar\ *\_w,}
\DoxyCodeLine{01248\ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ *\_lo,\ btScalar\ *\_hi,\ btScalar\ *l,\ btScalar\ *\_d,}
\DoxyCodeLine{01249\ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ *\_Dell,\ btScalar\ *\_ell,\ btScalar\ *\_tmp,}
\DoxyCodeLine{01250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ *\_state,\ \textcolor{keywordtype}{int}\ *\_findex,\ \textcolor{keywordtype}{int}\ *p,\ \textcolor{keywordtype}{int}\ *c,\ btScalar\ **Arows)\ :\ m\_n(\_n),\ m\_nskip(\_nskip),\ m\_nub(\_nub),\ m\_nC(0),\ m\_nN(0),}
\DoxyCodeLine{01251\ \#ifdef\ BTROWPTRS}
\DoxyCodeLine{01252\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_A(Arows),}
\DoxyCodeLine{01253\ \#else}
\DoxyCodeLine{01254\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_A(\_Adata),}
\DoxyCodeLine{01255\ \#endif}
\DoxyCodeLine{01256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_x(\_x),}
\DoxyCodeLine{01257\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_b(\_b),}
\DoxyCodeLine{01258\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_w(\_w),}
\DoxyCodeLine{01259\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_lo(\_lo),}
\DoxyCodeLine{01260\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_hi(\_hi),}
\DoxyCodeLine{01261\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_L(l),}
\DoxyCodeLine{01262\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_d(\_d),}
\DoxyCodeLine{01263\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_Dell(\_Dell),}
\DoxyCodeLine{01264\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_ell(\_ell),}
\DoxyCodeLine{01265\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_tmp(\_tmp),}
\DoxyCodeLine{01266\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_state(\_state),}
\DoxyCodeLine{01267\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_findex(\_findex),}
\DoxyCodeLine{01268\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_p(p),}
\DoxyCodeLine{01269\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_C(c)}
\DoxyCodeLine{01270\ \{}
\DoxyCodeLine{01271\ \ \ \ \ \{}
\DoxyCodeLine{01272\ \ \ \ \ \ \ \ \ btSetZero(m\_x,\ m\_n);}
\DoxyCodeLine{01273\ \ \ \ \ \}}
\DoxyCodeLine{01274\ }
\DoxyCodeLine{01275\ \ \ \ \ \{}
\DoxyCodeLine{01276\ \textcolor{preprocessor}{\#ifdef\ BTROWPTRS}}
\DoxyCodeLine{01277\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ make\ matrix\ row\ pointers}}
\DoxyCodeLine{01278\ \ \ \ \ \ \ \ \ btScalar\ *aptr\ =\ \_Adata;}
\DoxyCodeLine{01279\ \ \ \ \ \ \ \ \ BTATYPE\ A\ =\ m\_A;}
\DoxyCodeLine{01280\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ n\ =\ m\_n,\ nskip\ =\ m\_nskip;}
\DoxyCodeLine{01281\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ n;\ aptr\ +=\ nskip,\ ++k)\ A[k]\ =\ aptr;}
\DoxyCodeLine{01282\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01283\ \ \ \ \ \}}
\DoxyCodeLine{01284\ }
\DoxyCodeLine{01285\ \ \ \ \ \{}
\DoxyCodeLine{01286\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ *p\ =\ m\_p;}
\DoxyCodeLine{01287\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ n\ =\ m\_n;}
\DoxyCodeLine{01288\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ n;\ ++k)\ p[k]\ =\ k;\ \ \textcolor{comment}{//\ initially\ unpermuted}}
\DoxyCodeLine{01289\ \ \ \ \ \}}
\DoxyCodeLine{01290\ }
\DoxyCodeLine{01291\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01292\ \textcolor{comment}{\ \ //\ for\ testing,\ we\ can\ do\ some\ random\ swaps\ in\ the\ area\ i\ >\ nub}}
\DoxyCodeLine{01293\ \textcolor{comment}{\ \ \{}}
\DoxyCodeLine{01294\ \textcolor{comment}{\ \ \ \ const\ int\ n\ =\ m\_n;}}
\DoxyCodeLine{01295\ \textcolor{comment}{\ \ \ \ const\ int\ nub\ =\ m\_nub;}}
\DoxyCodeLine{01296\ \textcolor{comment}{\ \ \ \ if\ (nub\ <\ n)\ \{}}
\DoxyCodeLine{01297\ \textcolor{comment}{\ \ \ \ for\ (int\ k=0;\ k<100;\ k++)\ \{}}
\DoxyCodeLine{01298\ \textcolor{comment}{\ \ \ \ \ \ int\ i1,i2;}}
\DoxyCodeLine{01299\ \textcolor{comment}{\ \ \ \ \ \ do\ \{}}
\DoxyCodeLine{01300\ \textcolor{comment}{\ \ \ \ \ \ \ \ i1\ =\ dRandInt(n-\/nub)+nub;}}
\DoxyCodeLine{01301\ \textcolor{comment}{\ \ \ \ \ \ \ \ i2\ =\ dRandInt(n-\/nub)+nub;}}
\DoxyCodeLine{01302\ \textcolor{comment}{\ \ \ \ \ \ \}}}
\DoxyCodeLine{01303\ \textcolor{comment}{\ \ \ \ \ \ while\ (i1\ >\ i2);\ }}
\DoxyCodeLine{01304\ \textcolor{comment}{\ \ \ \ \ \ //printf\ ("{}-\/-\/>\ \%d\ \%d\(\backslash\)n"{},i1,i2);}}
\DoxyCodeLine{01305\ \textcolor{comment}{\ \ \ \ \ \ btSwapProblem\ (m\_A,m\_x,m\_b,m\_w,m\_lo,m\_hi,m\_p,m\_state,m\_findex,n,i1,i2,m\_nskip,0);}}
\DoxyCodeLine{01306\ \textcolor{comment}{\ \ \ \ \}}}
\DoxyCodeLine{01307\ \textcolor{comment}{\ \ \}}}
\DoxyCodeLine{01308\ \textcolor{comment}{\ \ */}}
\DoxyCodeLine{01309\ }
\DoxyCodeLine{01310\ \ \ \ \ \textcolor{comment}{//\ permute\ the\ problem\ so\ that\ *all*\ the\ unbounded\ variables\ are\ at\ the}}
\DoxyCodeLine{01311\ \ \ \ \ \textcolor{comment}{//\ start,\ i.e.\ look\ for\ unbounded\ variables\ not\ included\ in\ \`{}nub'.\ we\ can}}
\DoxyCodeLine{01312\ \ \ \ \ \textcolor{comment}{//\ potentially\ push\ up\ \`{}nub'\ this\ way\ and\ get\ a\ bigger\ initial\ factorization.}}
\DoxyCodeLine{01313\ \ \ \ \ \textcolor{comment}{//\ note\ that\ when\ we\ swap\ rows/cols\ here\ we\ must\ not\ just\ swap\ row\ pointers,}}
\DoxyCodeLine{01314\ \ \ \ \ \textcolor{comment}{//\ as\ the\ initial\ factorization\ relies\ on\ the\ data\ being\ all\ in\ one\ chunk.}}
\DoxyCodeLine{01315\ \ \ \ \ \textcolor{comment}{//\ variables\ that\ have\ findex\ >=\ 0\ are\ *not*\ considered\ to\ be\ unbounded\ even}}
\DoxyCodeLine{01316\ \ \ \ \ \textcolor{comment}{//\ if\ lo=-\/inf\ and\ hi=inf\ -\/\ this\ is\ because\ these\ limits\ may\ change\ during\ the}}
\DoxyCodeLine{01317\ \ \ \ \ \textcolor{comment}{//\ solution\ process.}}
\DoxyCodeLine{01318\ }
\DoxyCodeLine{01319\ \ \ \ \ \{}
\DoxyCodeLine{01320\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ *findex\ =\ m\_findex;}
\DoxyCodeLine{01321\ \ \ \ \ \ \ \ \ btScalar\ *lo\ =\ m\_lo,\ *hi\ =\ m\_hi;}
\DoxyCodeLine{01322\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ n\ =\ m\_n;}
\DoxyCodeLine{01323\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ m\_nub;\ k\ <\ n;\ ++k)}
\DoxyCodeLine{01324\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01325\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (findex\ \&\&\ findex[k]\ >=\ 0)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01326\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lo[k]\ ==\ -\/BT\_INFINITY\ \&\&\ hi[k]\ ==\ BT\_INFINITY)}
\DoxyCodeLine{01327\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01328\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btSwapProblem(m\_A,\ m\_x,\ m\_b,\ m\_w,\ lo,\ hi,\ m\_p,\ m\_state,\ findex,\ n,\ m\_nub,\ k,\ m\_nskip,\ 0);}
\DoxyCodeLine{01329\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_nub++;}
\DoxyCodeLine{01330\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01331\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01332\ \ \ \ \ \}}
\DoxyCodeLine{01333\ }
\DoxyCodeLine{01334\ \ \ \ \ \textcolor{comment}{//\ if\ there\ are\ unbounded\ variables\ at\ the\ start,\ factorize\ A\ up\ to\ that}}
\DoxyCodeLine{01335\ \ \ \ \ \textcolor{comment}{//\ point\ and\ solve\ for\ x.\ this\ puts\ all\ indexes\ 0..nub-\/1\ into\ C.}}
\DoxyCodeLine{01336\ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_nub\ >\ 0)}
\DoxyCodeLine{01337\ \ \ \ \ \{}
\DoxyCodeLine{01338\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nub\ =\ m\_nub;}
\DoxyCodeLine{01339\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01340\ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ *Lrow\ =\ m\_L;}
\DoxyCodeLine{01341\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nskip\ =\ m\_nskip;}
\DoxyCodeLine{01342\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nub;\ Lrow\ +=\ nskip,\ ++j)\ memcpy(Lrow,\ BTAROW(j),\ (j\ +\ 1)\ *\ \textcolor{keyword}{sizeof}(btScalar));}
\DoxyCodeLine{01343\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01344\ \ \ \ \ \ \ \ \ btFactorLDLT(m\_L,\ m\_d,\ nub,\ m\_nskip);}
\DoxyCodeLine{01345\ \ \ \ \ \ \ \ \ memcpy(m\_x,\ m\_b,\ nub\ *\ \textcolor{keyword}{sizeof}(btScalar));}
\DoxyCodeLine{01346\ \ \ \ \ \ \ \ \ btSolveLDLT(m\_L,\ m\_d,\ m\_x,\ nub,\ m\_nskip);}
\DoxyCodeLine{01347\ \ \ \ \ \ \ \ \ btSetZero(m\_w,\ nub);}
\DoxyCodeLine{01348\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01349\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ *C\ =\ m\_C;}
\DoxyCodeLine{01350\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ nub;\ ++k)\ C[k]\ =\ k;}
\DoxyCodeLine{01351\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01352\ \ \ \ \ \ \ \ \ m\_nC\ =\ nub;}
\DoxyCodeLine{01353\ \ \ \ \ \}}
\DoxyCodeLine{01354\ }
\DoxyCodeLine{01355\ \ \ \ \ \textcolor{comment}{//\ permute\ the\ indexes\ >\ nub\ such\ that\ all\ findex\ variables\ are\ at\ the\ end}}
\DoxyCodeLine{01356\ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_findex)}
\DoxyCodeLine{01357\ \ \ \ \ \{}
\DoxyCodeLine{01358\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nub\ =\ m\_nub;}
\DoxyCodeLine{01359\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ *findex\ =\ m\_findex;}
\DoxyCodeLine{01360\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ num\_at\_end\ =\ 0;}
\DoxyCodeLine{01361\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ m\_n\ -\/\ 1;\ k\ >=\ nub;\ k-\/-\/)}
\DoxyCodeLine{01362\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01363\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (findex[k]\ >=\ 0)}
\DoxyCodeLine{01364\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01365\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btSwapProblem(m\_A,\ m\_x,\ m\_b,\ m\_w,\ m\_lo,\ m\_hi,\ m\_p,\ m\_state,\ findex,\ m\_n,\ k,\ m\_n\ -\/\ 1\ -\/\ num\_at\_end,\ m\_nskip,\ 1);}
\DoxyCodeLine{01366\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_at\_end++;}
\DoxyCodeLine{01367\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01368\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01369\ \ \ \ \ \}}
\DoxyCodeLine{01370\ }
\DoxyCodeLine{01371\ \ \ \ \ \textcolor{comment}{//\ print\ info\ about\ indexes}}
\DoxyCodeLine{01372\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01373\ \textcolor{comment}{\ \ \{}}
\DoxyCodeLine{01374\ \textcolor{comment}{\ \ \ \ const\ int\ n\ =\ m\_n;}}
\DoxyCodeLine{01375\ \textcolor{comment}{\ \ \ \ const\ int\ nub\ =\ m\_nub;}}
\DoxyCodeLine{01376\ \textcolor{comment}{\ \ \ \ for\ (int\ k=0;\ k<n;\ k++)\ \{}}
\DoxyCodeLine{01377\ \textcolor{comment}{\ \ \ \ \ \ if\ (k<nub)\ printf\ ("{}C"{});}}
\DoxyCodeLine{01378\ \textcolor{comment}{\ \ \ \ \ \ else\ if\ (m\_lo[k]==-\/BT\_INFINITY\ \&\&\ m\_hi[k]==BT\_INFINITY)\ printf\ ("{}c"{});}}
\DoxyCodeLine{01379\ \textcolor{comment}{\ \ \ \ \ \ else\ printf\ ("{}."{});}}
\DoxyCodeLine{01380\ \textcolor{comment}{\ \ \ \ \}}}
\DoxyCodeLine{01381\ \textcolor{comment}{\ \ \ \ printf\ ("{}\(\backslash\)n"{});}}
\DoxyCodeLine{01382\ \textcolor{comment}{\ \ \}}}
\DoxyCodeLine{01383\ \textcolor{comment}{\ \ */}}
\DoxyCodeLine{01384\ \}}
\DoxyCodeLine{01385\ }
\DoxyCodeLine{01386\ \textcolor{keywordtype}{void}\ btLCP::transfer\_i\_to\_C(\textcolor{keywordtype}{int}\ i)}
\DoxyCodeLine{01387\ \{}
\DoxyCodeLine{01388\ \ \ \ \ \{}
\DoxyCodeLine{01389\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_nC\ >\ 0)}
\DoxyCodeLine{01390\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01391\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ ell,Dell\ were\ computed\ by\ solve1().\ note,\ ell\ =\ D\ \(\backslash\)\ L1solve\ (L,A(i,C))}}
\DoxyCodeLine{01392\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01393\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nC\ =\ m\_nC;}
\DoxyCodeLine{01394\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ *\textcolor{keyword}{const}\ Ltgt\ =\ m\_L\ +\ nC\ *\ m\_nskip,\ *ell\ =\ m\_ell;}
\DoxyCodeLine{01395\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nC;\ ++j)\ Ltgt[j]\ =\ ell[j];}
\DoxyCodeLine{01396\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01397\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nC\ =\ m\_nC;}
\DoxyCodeLine{01398\ \ \ \ \ \ \ \ \ \ \ \ \ m\_d[nC]\ =\ btRecip(BTAROW(i)[i]\ -\/\ btLargeDot(m\_ell,\ m\_Dell,\ nC));}
\DoxyCodeLine{01399\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01400\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01401\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01402\ \ \ \ \ \ \ \ \ \ \ \ \ m\_d[0]\ =\ btRecip(BTAROW(i)[i]);}
\DoxyCodeLine{01403\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01404\ }
\DoxyCodeLine{01405\ \ \ \ \ \ \ \ \ btSwapProblem(m\_A,\ m\_x,\ m\_b,\ m\_w,\ m\_lo,\ m\_hi,\ m\_p,\ m\_state,\ m\_findex,\ m\_n,\ m\_nC,\ i,\ m\_nskip,\ 1);}
\DoxyCodeLine{01406\ }
\DoxyCodeLine{01407\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nC\ =\ m\_nC;}
\DoxyCodeLine{01408\ \ \ \ \ \ \ \ \ m\_C[nC]\ =\ nC;}
\DoxyCodeLine{01409\ \ \ \ \ \ \ \ \ m\_nC\ =\ nC\ +\ 1;\ \ \textcolor{comment}{//\ nC\ value\ is\ outdated\ after\ this\ line}}
\DoxyCodeLine{01410\ \ \ \ \ \}}
\DoxyCodeLine{01411\ \}}
\DoxyCodeLine{01412\ }
\DoxyCodeLine{01413\ \textcolor{keywordtype}{void}\ btLCP::transfer\_i\_from\_N\_to\_C(\textcolor{keywordtype}{int}\ i)}
\DoxyCodeLine{01414\ \{}
\DoxyCodeLine{01415\ \ \ \ \ \{}
\DoxyCodeLine{01416\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_nC\ >\ 0)}
\DoxyCodeLine{01417\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01418\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01419\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ *\textcolor{keyword}{const}\ aptr\ =\ BTAROW(i);}
\DoxyCodeLine{01420\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ *Dell\ =\ m\_Dell;}
\DoxyCodeLine{01421\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ *C\ =\ m\_C;}
\DoxyCodeLine{01422\ \textcolor{preprocessor}{\#ifdef\ BTNUB\_OPTIMIZATIONS}}
\DoxyCodeLine{01423\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ nub>0,\ initial\ part\ of\ aptr\ unpermuted}}
\DoxyCodeLine{01424\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nub\ =\ m\_nub;}
\DoxyCodeLine{01425\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ j\ =\ 0;}
\DoxyCodeLine{01426\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ j\ <\ nub;\ ++j)\ Dell[j]\ =\ aptr[j];}
\DoxyCodeLine{01427\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nC\ =\ m\_nC;}
\DoxyCodeLine{01428\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ j\ <\ nC;\ ++j)\ Dell[j]\ =\ aptr[C[j]];}
\DoxyCodeLine{01429\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01430\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nC\ =\ m\_nC;}
\DoxyCodeLine{01431\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nC;\ ++j)\ Dell[j]\ =\ aptr[C[j]];}
\DoxyCodeLine{01432\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01433\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01434\ \ \ \ \ \ \ \ \ \ \ \ \ btSolveL1(m\_L,\ m\_Dell,\ m\_nC,\ m\_nskip);}
\DoxyCodeLine{01435\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01436\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nC\ =\ m\_nC;}
\DoxyCodeLine{01437\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ *\textcolor{keyword}{const}\ Ltgt\ =\ m\_L\ +\ nC\ *\ m\_nskip;}
\DoxyCodeLine{01438\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ *ell\ =\ m\_ell,\ *Dell\ =\ m\_Dell,\ *d\ =\ m\_d;}
\DoxyCodeLine{01439\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nC;\ ++j)\ Ltgt[j]\ =\ ell[j]\ =\ Dell[j]\ *\ d[j];}
\DoxyCodeLine{01440\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01441\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nC\ =\ m\_nC;}
\DoxyCodeLine{01442\ \ \ \ \ \ \ \ \ \ \ \ \ m\_d[nC]\ =\ btRecip(BTAROW(i)[i]\ -\/\ btLargeDot(m\_ell,\ m\_Dell,\ nC));}
\DoxyCodeLine{01443\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01444\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01445\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01446\ \ \ \ \ \ \ \ \ \ \ \ \ m\_d[0]\ =\ btRecip(BTAROW(i)[i]);}
\DoxyCodeLine{01447\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01448\ }
\DoxyCodeLine{01449\ \ \ \ \ \ \ \ \ btSwapProblem(m\_A,\ m\_x,\ m\_b,\ m\_w,\ m\_lo,\ m\_hi,\ m\_p,\ m\_state,\ m\_findex,\ m\_n,\ m\_nC,\ i,\ m\_nskip,\ 1);}
\DoxyCodeLine{01450\ }
\DoxyCodeLine{01451\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nC\ =\ m\_nC;}
\DoxyCodeLine{01452\ \ \ \ \ \ \ \ \ m\_C[nC]\ =\ nC;}
\DoxyCodeLine{01453\ \ \ \ \ \ \ \ \ m\_nN-\/-\/;}
\DoxyCodeLine{01454\ \ \ \ \ \ \ \ \ m\_nC\ =\ nC\ +\ 1;\ \ \textcolor{comment}{//\ nC\ value\ is\ outdated\ after\ this\ line}}
\DoxyCodeLine{01455\ \ \ \ \ \}}
\DoxyCodeLine{01456\ }
\DoxyCodeLine{01457\ \ \ \ \ \textcolor{comment}{//\ @@@\ TO\ DO\ LATER}}
\DoxyCodeLine{01458\ \ \ \ \ \textcolor{comment}{//\ if\ we\ just\ finish\ here\ then\ we'll\ go\ back\ and\ re-\/solve\ for}}
\DoxyCodeLine{01459\ \ \ \ \ \textcolor{comment}{//\ delta\_x.\ but\ actually\ we\ can\ be\ more\ efficient\ and\ incrementally}}
\DoxyCodeLine{01460\ \ \ \ \ \textcolor{comment}{//\ update\ delta\_x\ here.\ but\ if\ we\ do\ this,\ we\ wont\ have\ ell\ and\ Dell}}
\DoxyCodeLine{01461\ \ \ \ \ \textcolor{comment}{//\ to\ use\ in\ updating\ the\ factorization\ later.}}
\DoxyCodeLine{01462\ \}}
\DoxyCodeLine{01463\ }
\DoxyCodeLine{01464\ \textcolor{keywordtype}{void}\ btRemoveRowCol(btScalar\ *A,\ \textcolor{keywordtype}{int}\ n,\ \textcolor{keywordtype}{int}\ nskip,\ \textcolor{keywordtype}{int}\ r)}
\DoxyCodeLine{01465\ \{}
\DoxyCodeLine{01466\ \ \ \ \ btAssert(A\ \&\&\ n\ >\ 0\ \&\&\ nskip\ >=\ n\ \&\&\ r\ >=\ 0\ \&\&\ r\ <\ n);}
\DoxyCodeLine{01467\ \ \ \ \ \textcolor{keywordflow}{if}\ (r\ >=\ n\ -\/\ 1)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01468\ \ \ \ \ \textcolor{keywordflow}{if}\ (r\ >\ 0)}
\DoxyCodeLine{01469\ \ \ \ \ \{}
\DoxyCodeLine{01470\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01471\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ move\_size\ =\ (n\ -\/\ r\ -\/\ 1)\ *\ \textcolor{keyword}{sizeof}(btScalar);}
\DoxyCodeLine{01472\ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ *Adst\ =\ A\ +\ r;}
\DoxyCodeLine{01473\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ r;\ Adst\ +=\ nskip,\ ++i)}
\DoxyCodeLine{01474\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01475\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ *Asrc\ =\ Adst\ +\ 1;}
\DoxyCodeLine{01476\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ memmove(Adst,\ Asrc,\ move\_size);}
\DoxyCodeLine{01477\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01478\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01479\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01480\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ cpy\_size\ =\ r\ *\ \textcolor{keyword}{sizeof}(btScalar);}
\DoxyCodeLine{01481\ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ *Adst\ =\ A\ +\ r\ *\ nskip;}
\DoxyCodeLine{01482\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ r;\ i\ <\ (n\ -\/\ 1);\ ++i)}
\DoxyCodeLine{01483\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01484\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ *Asrc\ =\ Adst\ +\ nskip;}
\DoxyCodeLine{01485\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ memcpy(Adst,\ Asrc,\ cpy\_size);}
\DoxyCodeLine{01486\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Adst\ =\ Asrc;}
\DoxyCodeLine{01487\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01488\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01489\ \ \ \ \ \}}
\DoxyCodeLine{01490\ \ \ \ \ \{}
\DoxyCodeLine{01491\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ cpy\_size\ =\ (n\ -\/\ r\ -\/\ 1)\ *\ \textcolor{keyword}{sizeof}(btScalar);}
\DoxyCodeLine{01492\ \ \ \ \ \ \ \ \ btScalar\ *Adst\ =\ A\ +\ r\ *\ (nskip\ +\ 1);}
\DoxyCodeLine{01493\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ r;\ i\ <\ (n\ -\/\ 1);\ ++i)}
\DoxyCodeLine{01494\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01495\ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ *Asrc\ =\ Adst\ +\ (nskip\ +\ 1);}
\DoxyCodeLine{01496\ \ \ \ \ \ \ \ \ \ \ \ \ memcpy(Adst,\ Asrc,\ cpy\_size);}
\DoxyCodeLine{01497\ \ \ \ \ \ \ \ \ \ \ \ \ Adst\ =\ Asrc\ -\/\ 1;}
\DoxyCodeLine{01498\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01499\ \ \ \ \ \}}
\DoxyCodeLine{01500\ \}}
\DoxyCodeLine{01501\ }
\DoxyCodeLine{01502\ \textcolor{keywordtype}{void}\ btLDLTAddTL(btScalar\ *L,\ btScalar\ *d,\ \textcolor{keyword}{const}\ btScalar\ *a,\ \textcolor{keywordtype}{int}\ n,\ \textcolor{keywordtype}{int}\ nskip,\ \mbox{\hyperlink{classbt_aligned_object_array}{btAlignedObjectArray<btScalar>}}\ \&scratch)}
\DoxyCodeLine{01503\ \{}
\DoxyCodeLine{01504\ \ \ \ \ btAssert(L\ \&\&\ d\ \&\&\ a\ \&\&\ n\ >\ 0\ \&\&\ nskip\ >=\ n);}
\DoxyCodeLine{01505\ }
\DoxyCodeLine{01506\ \ \ \ \ \textcolor{keywordflow}{if}\ (n\ <\ 2)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01507\ \ \ \ \ scratch.resize(2\ *\ nskip);}
\DoxyCodeLine{01508\ \ \ \ \ btScalar\ *W1\ =\ \&scratch[0];}
\DoxyCodeLine{01509\ }
\DoxyCodeLine{01510\ \ \ \ \ btScalar\ *W2\ =\ W1\ +\ nskip;}
\DoxyCodeLine{01511\ }
\DoxyCodeLine{01512\ \ \ \ \ W1[0]\ =\ btScalar(0.0);}
\DoxyCodeLine{01513\ \ \ \ \ W2[0]\ =\ btScalar(0.0);}
\DoxyCodeLine{01514\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 1;\ j\ <\ n;\ ++j)}
\DoxyCodeLine{01515\ \ \ \ \ \{}
\DoxyCodeLine{01516\ \ \ \ \ \ \ \ \ W1[j]\ =\ W2[j]\ =\ (btScalar)(a[j]\ *\ SIMDSQRT12);}
\DoxyCodeLine{01517\ \ \ \ \ \}}
\DoxyCodeLine{01518\ \ \ \ \ btScalar\ W11\ =\ (btScalar)((btScalar(0.5)\ *\ a[0]\ +\ 1)\ *\ SIMDSQRT12);}
\DoxyCodeLine{01519\ \ \ \ \ btScalar\ W21\ =\ (btScalar)((btScalar(0.5)\ *\ a[0]\ -\/\ 1)\ *\ SIMDSQRT12);}
\DoxyCodeLine{01520\ }
\DoxyCodeLine{01521\ \ \ \ \ btScalar\ alpha1\ =\ btScalar(1.0);}
\DoxyCodeLine{01522\ \ \ \ \ btScalar\ alpha2\ =\ btScalar(1.0);}
\DoxyCodeLine{01523\ }
\DoxyCodeLine{01524\ \ \ \ \ \{}
\DoxyCodeLine{01525\ \ \ \ \ \ \ \ \ btScalar\ dee\ =\ d[0];}
\DoxyCodeLine{01526\ \ \ \ \ \ \ \ \ btScalar\ alphanew\ =\ alpha1\ +\ (W11\ *\ W11)\ *\ dee;}
\DoxyCodeLine{01527\ \ \ \ \ \ \ \ \ btAssert(alphanew\ !=\ btScalar(0.0));}
\DoxyCodeLine{01528\ \ \ \ \ \ \ \ \ dee\ /=\ alphanew;}
\DoxyCodeLine{01529\ \ \ \ \ \ \ \ \ btScalar\ gamma1\ =\ W11\ *\ dee;}
\DoxyCodeLine{01530\ \ \ \ \ \ \ \ \ dee\ *=\ alpha1;}
\DoxyCodeLine{01531\ \ \ \ \ \ \ \ \ alpha1\ =\ alphanew;}
\DoxyCodeLine{01532\ \ \ \ \ \ \ \ \ alphanew\ =\ alpha2\ -\/\ (W21\ *\ W21)\ *\ dee;}
\DoxyCodeLine{01533\ \ \ \ \ \ \ \ \ dee\ /=\ alphanew;}
\DoxyCodeLine{01534\ \ \ \ \ \ \ \ \ \textcolor{comment}{//btScalar\ gamma2\ =\ W21\ *\ dee;}}
\DoxyCodeLine{01535\ \ \ \ \ \ \ \ \ alpha2\ =\ alphanew;}
\DoxyCodeLine{01536\ \ \ \ \ \ \ \ \ btScalar\ k1\ =\ btScalar(1.0)\ -\/\ W21\ *\ gamma1;}
\DoxyCodeLine{01537\ \ \ \ \ \ \ \ \ btScalar\ k2\ =\ W21\ *\ gamma1\ *\ W11\ -\/\ W21;}
\DoxyCodeLine{01538\ \ \ \ \ \ \ \ \ btScalar\ *ll\ =\ L\ +\ nskip;}
\DoxyCodeLine{01539\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ p\ =\ 1;\ p\ <\ n;\ ll\ +=\ nskip,\ ++p)}
\DoxyCodeLine{01540\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01541\ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ Wp\ =\ W1[p];}
\DoxyCodeLine{01542\ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ ell\ =\ *ll;}
\DoxyCodeLine{01543\ \ \ \ \ \ \ \ \ \ \ \ \ W1[p]\ =\ Wp\ -\/\ W11\ *\ ell;}
\DoxyCodeLine{01544\ \ \ \ \ \ \ \ \ \ \ \ \ W2[p]\ =\ k1\ *\ Wp\ +\ k2\ *\ ell;}
\DoxyCodeLine{01545\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01546\ \ \ \ \ \}}
\DoxyCodeLine{01547\ }
\DoxyCodeLine{01548\ \ \ \ \ btScalar\ *ll\ =\ L\ +\ (nskip\ +\ 1);}
\DoxyCodeLine{01549\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 1;\ j\ <\ n;\ ll\ +=\ nskip\ +\ 1,\ ++j)}
\DoxyCodeLine{01550\ \ \ \ \ \{}
\DoxyCodeLine{01551\ \ \ \ \ \ \ \ \ btScalar\ k1\ =\ W1[j];}
\DoxyCodeLine{01552\ \ \ \ \ \ \ \ \ btScalar\ k2\ =\ W2[j];}
\DoxyCodeLine{01553\ }
\DoxyCodeLine{01554\ \ \ \ \ \ \ \ \ btScalar\ dee\ =\ d[j];}
\DoxyCodeLine{01555\ \ \ \ \ \ \ \ \ btScalar\ alphanew\ =\ alpha1\ +\ (k1\ *\ k1)\ *\ dee;}
\DoxyCodeLine{01556\ \ \ \ \ \ \ \ \ btAssert(alphanew\ !=\ btScalar(0.0));}
\DoxyCodeLine{01557\ \ \ \ \ \ \ \ \ dee\ /=\ alphanew;}
\DoxyCodeLine{01558\ \ \ \ \ \ \ \ \ btScalar\ gamma1\ =\ k1\ *\ dee;}
\DoxyCodeLine{01559\ \ \ \ \ \ \ \ \ dee\ *=\ alpha1;}
\DoxyCodeLine{01560\ \ \ \ \ \ \ \ \ alpha1\ =\ alphanew;}
\DoxyCodeLine{01561\ \ \ \ \ \ \ \ \ alphanew\ =\ alpha2\ -\/\ (k2\ *\ k2)\ *\ dee;}
\DoxyCodeLine{01562\ \ \ \ \ \ \ \ \ dee\ /=\ alphanew;}
\DoxyCodeLine{01563\ \ \ \ \ \ \ \ \ btScalar\ gamma2\ =\ k2\ *\ dee;}
\DoxyCodeLine{01564\ \ \ \ \ \ \ \ \ dee\ *=\ alpha2;}
\DoxyCodeLine{01565\ \ \ \ \ \ \ \ \ d[j]\ =\ dee;}
\DoxyCodeLine{01566\ \ \ \ \ \ \ \ \ alpha2\ =\ alphanew;}
\DoxyCodeLine{01567\ }
\DoxyCodeLine{01568\ \ \ \ \ \ \ \ \ btScalar\ *l\ =\ ll\ +\ nskip;}
\DoxyCodeLine{01569\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ p\ =\ j\ +\ 1;\ p\ <\ n;\ l\ +=\ nskip,\ ++p)}
\DoxyCodeLine{01570\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01571\ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ ell\ =\ *l;}
\DoxyCodeLine{01572\ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ Wp\ =\ W1[p]\ -\/\ k1\ *\ ell;}
\DoxyCodeLine{01573\ \ \ \ \ \ \ \ \ \ \ \ \ ell\ +=\ gamma1\ *\ Wp;}
\DoxyCodeLine{01574\ \ \ \ \ \ \ \ \ \ \ \ \ W1[p]\ =\ Wp;}
\DoxyCodeLine{01575\ \ \ \ \ \ \ \ \ \ \ \ \ Wp\ =\ W2[p]\ -\/\ k2\ *\ ell;}
\DoxyCodeLine{01576\ \ \ \ \ \ \ \ \ \ \ \ \ ell\ -\/=\ gamma2\ *\ Wp;}
\DoxyCodeLine{01577\ \ \ \ \ \ \ \ \ \ \ \ \ W2[p]\ =\ Wp;}
\DoxyCodeLine{01578\ \ \ \ \ \ \ \ \ \ \ \ \ *l\ =\ ell;}
\DoxyCodeLine{01579\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01580\ \ \ \ \ \}}
\DoxyCodeLine{01581\ \}}
\DoxyCodeLine{01582\ }
\DoxyCodeLine{01583\ \textcolor{preprocessor}{\#define\ \_BTGETA(i,\ j)\ (A[i][j])}}
\DoxyCodeLine{01584\ \textcolor{comment}{//\#define\ \_GETA(i,j)\ (A[(i)*nskip+(j)])}}
\DoxyCodeLine{01585\ \textcolor{preprocessor}{\#define\ BTGETA(i,\ j)\ ((i\ >\ j)\ ?\ \_BTGETA(i,\ j)\ :\ \_BTGETA(j,\ i))}}
\DoxyCodeLine{01586\ }
\DoxyCodeLine{01587\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{size\_t}\ btEstimateLDLTAddTLTmpbufSize(\textcolor{keywordtype}{int}\ nskip)}
\DoxyCodeLine{01588\ \{}
\DoxyCodeLine{01589\ \ \ \ \ \textcolor{keywordflow}{return}\ nskip\ *\ 2\ *\ \textcolor{keyword}{sizeof}(btScalar);}
\DoxyCodeLine{01590\ \}}
\DoxyCodeLine{01591\ }
\DoxyCodeLine{01592\ \textcolor{keywordtype}{void}\ btLDLTRemove(btScalar\ **A,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ *p,\ btScalar\ *L,\ btScalar\ *d,}
\DoxyCodeLine{01593\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ n1,\ \textcolor{keywordtype}{int}\ n2,\ \textcolor{keywordtype}{int}\ r,\ \textcolor{keywordtype}{int}\ nskip,\ \mbox{\hyperlink{classbt_aligned_object_array}{btAlignedObjectArray<btScalar>}}\ \&scratch)}
\DoxyCodeLine{01594\ \{}
\DoxyCodeLine{01595\ \ \ \ \ btAssert(A\ \&\&\ p\ \&\&\ L\ \&\&\ d\ \&\&\ n1\ >\ 0\ \&\&\ n2\ >\ 0\ \&\&\ r\ >=\ 0\ \&\&\ r\ <\ n2\ \&\&}
\DoxyCodeLine{01596\ \ \ \ \ \ \ \ \ \ \ \ \ \ n1\ >=\ n2\ \&\&\ nskip\ >=\ n1);}
\DoxyCodeLine{01597\ \textcolor{preprocessor}{\#ifdef\ BT\_DEBUG}}
\DoxyCodeLine{01598\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ n2;\ ++i)}
\DoxyCodeLine{01599\ \ \ \ \ \ \ \ \ btAssert(p[i]\ >=\ 0\ \&\&\ p[i]\ <\ n1);}
\DoxyCodeLine{01600\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01601\ }
\DoxyCodeLine{01602\ \ \ \ \ \textcolor{keywordflow}{if}\ (r\ ==\ n2\ -\/\ 1)}
\DoxyCodeLine{01603\ \ \ \ \ \{}
\DoxyCodeLine{01604\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};\ \ \textcolor{comment}{//\ deleting\ last\ row/col\ is\ easy}}
\DoxyCodeLine{01605\ \ \ \ \ \}}
\DoxyCodeLine{01606\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01607\ \ \ \ \ \{}
\DoxyCodeLine{01608\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ LDLTAddTL\_size\ =\ btEstimateLDLTAddTLTmpbufSize(nskip);}
\DoxyCodeLine{01609\ \ \ \ \ \ \ \ \ btAssert(LDLTAddTL\_size\ \%\ \textcolor{keyword}{sizeof}(btScalar)\ ==\ 0);}
\DoxyCodeLine{01610\ \ \ \ \ \ \ \ \ scratch.resize(nskip\ *\ 2\ +\ n2);}
\DoxyCodeLine{01611\ \ \ \ \ \ \ \ \ btScalar\ *tmp\ =\ \&scratch[0];}
\DoxyCodeLine{01612\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (r\ ==\ 0)}
\DoxyCodeLine{01613\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01614\ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ *a\ =\ (btScalar\ *)((\textcolor{keywordtype}{char}\ *)tmp\ +\ LDLTAddTL\_size);}
\DoxyCodeLine{01615\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ p\_0\ =\ p[0];}
\DoxyCodeLine{01616\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ n2;\ ++i)}
\DoxyCodeLine{01617\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01618\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a[i]\ =\ -\/BTGETA(p[i],\ p\_0);}
\DoxyCodeLine{01619\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01620\ \ \ \ \ \ \ \ \ \ \ \ \ a[0]\ +=\ btScalar(1.0);}
\DoxyCodeLine{01621\ \ \ \ \ \ \ \ \ \ \ \ \ btLDLTAddTL(L,\ d,\ a,\ n2,\ nskip,\ scratch);}
\DoxyCodeLine{01622\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01623\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01624\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01625\ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ *t\ =\ (btScalar\ *)((\textcolor{keywordtype}{char}\ *)tmp\ +\ LDLTAddTL\_size);}
\DoxyCodeLine{01626\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01627\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ *Lcurr\ =\ L\ +\ r\ *\ nskip;}
\DoxyCodeLine{01628\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ r;\ ++Lcurr,\ ++i)}
\DoxyCodeLine{01629\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01630\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btAssert(d[i]\ !=\ btScalar(0.0));}
\DoxyCodeLine{01631\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ t[i]\ =\ *Lcurr\ /\ d[i];}
\DoxyCodeLine{01632\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01633\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01634\ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ *a\ =\ t\ +\ r;}
\DoxyCodeLine{01635\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01636\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ *Lcurr\ =\ L\ +\ r\ *\ nskip;}
\DoxyCodeLine{01637\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ *pp\_r\ =\ p\ +\ r,\ p\_r\ =\ *pp\_r;}
\DoxyCodeLine{01638\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ n2\_minus\_r\ =\ n2\ -\/\ r;}
\DoxyCodeLine{01639\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ n2\_minus\_r;\ Lcurr\ +=\ nskip,\ ++i)}
\DoxyCodeLine{01640\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01641\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a[i]\ =\ btLargeDot(Lcurr,\ t,\ r)\ -\/\ BTGETA(pp\_r[i],\ p\_r);}
\DoxyCodeLine{01642\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01643\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01644\ \ \ \ \ \ \ \ \ \ \ \ \ a[0]\ +=\ btScalar(1.0);}
\DoxyCodeLine{01645\ \ \ \ \ \ \ \ \ \ \ \ \ btLDLTAddTL(L\ +\ r\ *\ nskip\ +\ r,\ d\ +\ r,\ a,\ n2\ -\/\ r,\ nskip,\ scratch);}
\DoxyCodeLine{01646\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01647\ \ \ \ \ \}}
\DoxyCodeLine{01648\ }
\DoxyCodeLine{01649\ \ \ \ \ \textcolor{comment}{//\ snip\ out\ row/column\ r\ from\ L\ and\ d}}
\DoxyCodeLine{01650\ \ \ \ \ btRemoveRowCol(L,\ n2,\ nskip,\ r);}
\DoxyCodeLine{01651\ \ \ \ \ \textcolor{keywordflow}{if}\ (r\ <\ (n2\ -\/\ 1))\ memmove(d\ +\ r,\ d\ +\ r\ +\ 1,\ (n2\ -\/\ r\ -\/\ 1)\ *\ \textcolor{keyword}{sizeof}(btScalar));}
\DoxyCodeLine{01652\ \}}
\DoxyCodeLine{01653\ }
\DoxyCodeLine{01654\ \textcolor{keywordtype}{void}\ btLCP::transfer\_i\_from\_C\_to\_N(\textcolor{keywordtype}{int}\ i,\ \mbox{\hyperlink{classbt_aligned_object_array}{btAlignedObjectArray<btScalar>}}\ \&scratch)}
\DoxyCodeLine{01655\ \{}
\DoxyCodeLine{01656\ \ \ \ \ \{}
\DoxyCodeLine{01657\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ *C\ =\ m\_C;}
\DoxyCodeLine{01658\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ remove\ a\ row/column\ from\ the\ factorization,\ and\ adjust\ the}}
\DoxyCodeLine{01659\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ indexes\ (black\ magic!)}}
\DoxyCodeLine{01660\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ last\_idx\ =\ -\/1;}
\DoxyCodeLine{01661\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nC\ =\ m\_nC;}
\DoxyCodeLine{01662\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ j\ =\ 0;}
\DoxyCodeLine{01663\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ j\ <\ nC;\ ++j)}
\DoxyCodeLine{01664\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01665\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (C[j]\ ==\ nC\ -\/\ 1)}
\DoxyCodeLine{01666\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01667\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ last\_idx\ =\ j;}
\DoxyCodeLine{01668\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01669\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (C[j]\ ==\ i)}
\DoxyCodeLine{01670\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01671\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btLDLTRemove(m\_A,\ C,\ m\_L,\ m\_d,\ m\_n,\ nC,\ j,\ m\_nskip,\ scratch);}
\DoxyCodeLine{01672\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ k;}
\DoxyCodeLine{01673\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (last\_idx\ ==\ -\/1)}
\DoxyCodeLine{01674\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01675\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ j\ +\ 1;\ k\ <\ nC;\ ++k)}
\DoxyCodeLine{01676\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01677\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (C[k]\ ==\ nC\ -\/\ 1)}
\DoxyCodeLine{01678\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01679\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01680\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01681\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01682\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btAssert(k\ <\ nC);}
\DoxyCodeLine{01683\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01684\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01685\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01686\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ k\ =\ last\_idx;}
\DoxyCodeLine{01687\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01688\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ C[k]\ =\ C[j];}
\DoxyCodeLine{01689\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ <\ (nC\ -\/\ 1))\ memmove(C\ +\ j,\ C\ +\ j\ +\ 1,\ (nC\ -\/\ j\ -\/\ 1)\ *\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));}
\DoxyCodeLine{01690\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01691\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01692\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01693\ \ \ \ \ \ \ \ \ btAssert(j\ <\ nC);}
\DoxyCodeLine{01694\ }
\DoxyCodeLine{01695\ \ \ \ \ \ \ \ \ btSwapProblem(m\_A,\ m\_x,\ m\_b,\ m\_w,\ m\_lo,\ m\_hi,\ m\_p,\ m\_state,\ m\_findex,\ m\_n,\ i,\ nC\ -\/\ 1,\ m\_nskip,\ 1);}
\DoxyCodeLine{01696\ }
\DoxyCodeLine{01697\ \ \ \ \ \ \ \ \ m\_nN++;}
\DoxyCodeLine{01698\ \ \ \ \ \ \ \ \ m\_nC\ =\ nC\ -\/\ 1;\ \ \textcolor{comment}{//\ nC\ value\ is\ outdated\ after\ this\ line}}
\DoxyCodeLine{01699\ \ \ \ \ \}}
\DoxyCodeLine{01700\ \}}
\DoxyCodeLine{01701\ }
\DoxyCodeLine{01702\ \textcolor{keywordtype}{void}\ btLCP::pN\_equals\_ANC\_times\_qC(btScalar\ *p,\ btScalar\ *q)}
\DoxyCodeLine{01703\ \{}
\DoxyCodeLine{01704\ \ \ \ \ \textcolor{comment}{//\ we\ could\ try\ to\ make\ this\ matrix-\/vector\ multiplication\ faster\ using}}
\DoxyCodeLine{01705\ \ \ \ \ \textcolor{comment}{//\ outer\ product\ matrix\ tricks,\ e.g.\ with\ the\ dMultidotX()\ functions.}}
\DoxyCodeLine{01706\ \ \ \ \ \textcolor{comment}{//\ but\ i\ tried\ it\ and\ it\ actually\ made\ things\ slower\ on\ random\ 100x100}}
\DoxyCodeLine{01707\ \ \ \ \ \textcolor{comment}{//\ problems\ because\ of\ the\ overhead\ involved.\ so\ we'll\ stick\ with\ the}}
\DoxyCodeLine{01708\ \ \ \ \ \textcolor{comment}{//\ simple\ method\ for\ now.}}
\DoxyCodeLine{01709\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nC\ =\ m\_nC;}
\DoxyCodeLine{01710\ \ \ \ \ btScalar\ *ptgt\ =\ p\ +\ nC;}
\DoxyCodeLine{01711\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nN\ =\ m\_nN;}
\DoxyCodeLine{01712\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ nN;\ ++i)}
\DoxyCodeLine{01713\ \ \ \ \ \{}
\DoxyCodeLine{01714\ \ \ \ \ \ \ \ \ ptgt[i]\ =\ btLargeDot(BTAROW(i\ +\ nC),\ q,\ nC);}
\DoxyCodeLine{01715\ \ \ \ \ \}}
\DoxyCodeLine{01716\ \}}
\DoxyCodeLine{01717\ }
\DoxyCodeLine{01718\ \textcolor{keywordtype}{void}\ btLCP::pN\_plusequals\_ANi(btScalar\ *p,\ \textcolor{keywordtype}{int}\ i,\ \textcolor{keywordtype}{int}\ sign)}
\DoxyCodeLine{01719\ \{}
\DoxyCodeLine{01720\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nC\ =\ m\_nC;}
\DoxyCodeLine{01721\ \ \ \ \ btScalar\ *aptr\ =\ BTAROW(i)\ +\ nC;}
\DoxyCodeLine{01722\ \ \ \ \ btScalar\ *ptgt\ =\ p\ +\ nC;}
\DoxyCodeLine{01723\ \ \ \ \ \textcolor{keywordflow}{if}\ (sign\ >\ 0)}
\DoxyCodeLine{01724\ \ \ \ \ \{}
\DoxyCodeLine{01725\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nN\ =\ m\_nN;}
\DoxyCodeLine{01726\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nN;\ ++j)\ ptgt[j]\ +=\ aptr[j];}
\DoxyCodeLine{01727\ \ \ \ \ \}}
\DoxyCodeLine{01728\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01729\ \ \ \ \ \{}
\DoxyCodeLine{01730\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nN\ =\ m\_nN;}
\DoxyCodeLine{01731\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nN;\ ++j)\ ptgt[j]\ -\/=\ aptr[j];}
\DoxyCodeLine{01732\ \ \ \ \ \}}
\DoxyCodeLine{01733\ \}}
\DoxyCodeLine{01734\ }
\DoxyCodeLine{01735\ \textcolor{keywordtype}{void}\ btLCP::pC\_plusequals\_s\_times\_qC(btScalar\ *p,\ btScalar\ s,\ btScalar\ *q)}
\DoxyCodeLine{01736\ \{}
\DoxyCodeLine{01737\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nC\ =\ m\_nC;}
\DoxyCodeLine{01738\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ nC;\ ++i)}
\DoxyCodeLine{01739\ \ \ \ \ \{}
\DoxyCodeLine{01740\ \ \ \ \ \ \ \ \ p[i]\ +=\ s\ *\ q[i];}
\DoxyCodeLine{01741\ \ \ \ \ \}}
\DoxyCodeLine{01742\ \}}
\DoxyCodeLine{01743\ }
\DoxyCodeLine{01744\ \textcolor{keywordtype}{void}\ btLCP::pN\_plusequals\_s\_times\_qN(btScalar\ *p,\ btScalar\ s,\ btScalar\ *q)}
\DoxyCodeLine{01745\ \{}
\DoxyCodeLine{01746\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nC\ =\ m\_nC;}
\DoxyCodeLine{01747\ \ \ \ \ btScalar\ *ptgt\ =\ p\ +\ nC,\ *qsrc\ =\ q\ +\ nC;}
\DoxyCodeLine{01748\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nN\ =\ m\_nN;}
\DoxyCodeLine{01749\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ nN;\ ++i)}
\DoxyCodeLine{01750\ \ \ \ \ \{}
\DoxyCodeLine{01751\ \ \ \ \ \ \ \ \ ptgt[i]\ +=\ s\ *\ qsrc[i];}
\DoxyCodeLine{01752\ \ \ \ \ \}}
\DoxyCodeLine{01753\ \}}
\DoxyCodeLine{01754\ }
\DoxyCodeLine{01755\ \textcolor{keywordtype}{void}\ btLCP::solve1(btScalar\ *a,\ \textcolor{keywordtype}{int}\ i,\ \textcolor{keywordtype}{int}\ dir,\ \textcolor{keywordtype}{int}\ only\_transfer)}
\DoxyCodeLine{01756\ \{}
\DoxyCodeLine{01757\ \ \ \ \ \textcolor{comment}{//\ the\ \`{}Dell'\ and\ \`{}ell'\ that\ are\ computed\ here\ are\ saved.\ if\ index\ i\ is}}
\DoxyCodeLine{01758\ \ \ \ \ \textcolor{comment}{//\ later\ added\ to\ the\ factorization\ then\ they\ can\ be\ reused.}}
\DoxyCodeLine{01759\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01760\ \ \ \ \ \textcolor{comment}{//\ @@@\ question:\ do\ we\ need\ to\ solve\ for\ entire\ delta\_x???\ yes,\ but}}
\DoxyCodeLine{01761\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ only\ if\ an\ x\ goes\ below\ 0\ during\ the\ step.}}
\DoxyCodeLine{01762\ }
\DoxyCodeLine{01763\ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_nC\ >\ 0)}
\DoxyCodeLine{01764\ \ \ \ \ \{}
\DoxyCodeLine{01765\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01766\ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ *Dell\ =\ m\_Dell;}
\DoxyCodeLine{01767\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ *C\ =\ m\_C;}
\DoxyCodeLine{01768\ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ *aptr\ =\ BTAROW(i);}
\DoxyCodeLine{01769\ \textcolor{preprocessor}{\#ifdef\ BTNUB\_OPTIMIZATIONS}}
\DoxyCodeLine{01770\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ nub>0,\ initial\ part\ of\ aptr[]\ is\ guaranteed\ unpermuted}}
\DoxyCodeLine{01771\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nub\ =\ m\_nub;}
\DoxyCodeLine{01772\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ j\ =\ 0;}
\DoxyCodeLine{01773\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ j\ <\ nub;\ ++j)\ Dell[j]\ =\ aptr[j];}
\DoxyCodeLine{01774\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nC\ =\ m\_nC;}
\DoxyCodeLine{01775\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ j\ <\ nC;\ ++j)\ Dell[j]\ =\ aptr[C[j]];}
\DoxyCodeLine{01776\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01777\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nC\ =\ m\_nC;}
\DoxyCodeLine{01778\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nC;\ ++j)\ Dell[j]\ =\ aptr[C[j]];}
\DoxyCodeLine{01779\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01780\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01781\ \ \ \ \ \ \ \ \ btSolveL1(m\_L,\ m\_Dell,\ m\_nC,\ m\_nskip);}
\DoxyCodeLine{01782\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01783\ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ *ell\ =\ m\_ell,\ *Dell\ =\ m\_Dell,\ *d\ =\ m\_d;}
\DoxyCodeLine{01784\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nC\ =\ m\_nC;}
\DoxyCodeLine{01785\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nC;\ ++j)\ ell[j]\ =\ Dell[j]\ *\ d[j];}
\DoxyCodeLine{01786\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01787\ }
\DoxyCodeLine{01788\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!only\_transfer)}
\DoxyCodeLine{01789\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01790\ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ *tmp\ =\ m\_tmp,\ *ell\ =\ m\_ell;}
\DoxyCodeLine{01791\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01792\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nC\ =\ m\_nC;}
\DoxyCodeLine{01793\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nC;\ ++j)\ tmp[j]\ =\ ell[j];}
\DoxyCodeLine{01794\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01795\ \ \ \ \ \ \ \ \ \ \ \ \ btSolveL1T(m\_L,\ tmp,\ m\_nC,\ m\_nskip);}
\DoxyCodeLine{01796\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (dir\ >\ 0)}
\DoxyCodeLine{01797\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01798\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ *C\ =\ m\_C;}
\DoxyCodeLine{01799\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ *tmp\ =\ m\_tmp;}
\DoxyCodeLine{01800\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nC\ =\ m\_nC;}
\DoxyCodeLine{01801\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nC;\ ++j)\ a[C[j]]\ =\ -\/tmp[j];}
\DoxyCodeLine{01802\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01803\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01804\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01805\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ *C\ =\ m\_C;}
\DoxyCodeLine{01806\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ *tmp\ =\ m\_tmp;}
\DoxyCodeLine{01807\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nC\ =\ m\_nC;}
\DoxyCodeLine{01808\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nC;\ ++j)\ a[C[j]]\ =\ tmp[j];}
\DoxyCodeLine{01809\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01810\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01811\ \ \ \ \ \}}
\DoxyCodeLine{01812\ \}}
\DoxyCodeLine{01813\ }
\DoxyCodeLine{01814\ \textcolor{keywordtype}{void}\ btLCP::unpermute()}
\DoxyCodeLine{01815\ \{}
\DoxyCodeLine{01816\ \ \ \ \ \textcolor{comment}{//\ now\ we\ have\ to\ un-\/permute\ x\ and\ w}}
\DoxyCodeLine{01817\ \ \ \ \ \{}
\DoxyCodeLine{01818\ \ \ \ \ \ \ \ \ memcpy(m\_tmp,\ m\_x,\ m\_n\ *\ \textcolor{keyword}{sizeof}(btScalar));}
\DoxyCodeLine{01819\ \ \ \ \ \ \ \ \ btScalar\ *x\ =\ m\_x,\ *tmp\ =\ m\_tmp;}
\DoxyCodeLine{01820\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ *p\ =\ m\_p;}
\DoxyCodeLine{01821\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ n\ =\ m\_n;}
\DoxyCodeLine{01822\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ n;\ ++j)\ x[p[j]]\ =\ tmp[j];}
\DoxyCodeLine{01823\ \ \ \ \ \}}
\DoxyCodeLine{01824\ \ \ \ \ \{}
\DoxyCodeLine{01825\ \ \ \ \ \ \ \ \ memcpy(m\_tmp,\ m\_w,\ m\_n\ *\ \textcolor{keyword}{sizeof}(btScalar));}
\DoxyCodeLine{01826\ \ \ \ \ \ \ \ \ btScalar\ *w\ =\ m\_w,\ *tmp\ =\ m\_tmp;}
\DoxyCodeLine{01827\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ *p\ =\ m\_p;}
\DoxyCodeLine{01828\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ n\ =\ m\_n;}
\DoxyCodeLine{01829\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ n;\ ++j)\ w[p[j]]\ =\ tmp[j];}
\DoxyCodeLine{01830\ \ \ \ \ \}}
\DoxyCodeLine{01831\ \}}
\DoxyCodeLine{01832\ }
\DoxyCodeLine{01833\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ btLCP\_FAST}}
\DoxyCodeLine{01834\ }
\DoxyCodeLine{01835\ \textcolor{comment}{//***************************************************************************}}
\DoxyCodeLine{01836\ \textcolor{comment}{//\ an\ optimized\ Dantzig\ LCP\ driver\ routine\ for\ the\ lo-\/hi\ LCP\ problem.}}
\DoxyCodeLine{01837\ }
\DoxyCodeLine{01838\ \textcolor{keywordtype}{bool}\ btSolveDantzigLCP(\textcolor{keywordtype}{int}\ n,\ btScalar\ *A,\ btScalar\ *x,\ btScalar\ *b,}
\DoxyCodeLine{01839\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ *outer\_w,\ \textcolor{keywordtype}{int}\ nub,\ btScalar\ *lo,\ btScalar\ *hi,\ \textcolor{keywordtype}{int}\ *findex,\ \mbox{\hyperlink{structbt_dantzig_scratch_memory}{btDantzigScratchMemory}}\ \&scratchMem)}
\DoxyCodeLine{01840\ \{}
\DoxyCodeLine{01841\ \ \ \ \ s\_error\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01842\ }
\DoxyCodeLine{01843\ \ \ \ \ \textcolor{comment}{//\ \ printf("{}btSolveDantzigLCP\ n=\%d\(\backslash\)n"{},n);}}
\DoxyCodeLine{01844\ \ \ \ \ btAssert(n\ >\ 0\ \&\&\ A\ \&\&\ x\ \&\&\ b\ \&\&\ lo\ \&\&\ hi\ \&\&\ nub\ >=\ 0\ \&\&\ nub\ <=\ n);}
\DoxyCodeLine{01845\ \ \ \ \ btAssert(outer\_w);}
\DoxyCodeLine{01846\ }
\DoxyCodeLine{01847\ \textcolor{preprocessor}{\#ifdef\ BT\_DEBUG}}
\DoxyCodeLine{01848\ \ \ \ \ \{}
\DoxyCodeLine{01849\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ check\ restrictions\ on\ lo\ and\ hi}}
\DoxyCodeLine{01850\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ n;\ ++k)}
\DoxyCodeLine{01851\ \ \ \ \ \ \ \ \ \ \ \ \ btAssert(lo[k]\ <=\ 0\ \&\&\ hi[k]\ >=\ 0);}
\DoxyCodeLine{01852\ \ \ \ \ \}}
\DoxyCodeLine{01853\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01854\ }
\DoxyCodeLine{01855\ \ \ \ \ \textcolor{comment}{//\ if\ all\ the\ variables\ are\ unbounded\ then\ we\ can\ just\ factor,\ solve,}}
\DoxyCodeLine{01856\ \ \ \ \ \textcolor{comment}{//\ and\ return}}
\DoxyCodeLine{01857\ \ \ \ \ \textcolor{keywordflow}{if}\ (nub\ >=\ n)}
\DoxyCodeLine{01858\ \ \ \ \ \{}
\DoxyCodeLine{01859\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ nskip\ =\ (n);}
\DoxyCodeLine{01860\ \ \ \ \ \ \ \ \ btFactorLDLT(A,\ outer\_w,\ n,\ nskip);}
\DoxyCodeLine{01861\ \ \ \ \ \ \ \ \ btSolveLDLT(A,\ outer\_w,\ b,\ n,\ nskip);}
\DoxyCodeLine{01862\ \ \ \ \ \ \ \ \ memcpy(x,\ b,\ n\ *\ \textcolor{keyword}{sizeof}(btScalar));}
\DoxyCodeLine{01863\ }
\DoxyCodeLine{01864\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ !s\_error;}
\DoxyCodeLine{01865\ \ \ \ \ \}}
\DoxyCodeLine{01866\ }
\DoxyCodeLine{01867\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nskip\ =\ (n);}
\DoxyCodeLine{01868\ \ \ \ \ scratchMem.L.resize(n\ *\ nskip);}
\DoxyCodeLine{01869\ }
\DoxyCodeLine{01870\ \ \ \ \ scratchMem.d.resize(n);}
\DoxyCodeLine{01871\ }
\DoxyCodeLine{01872\ \ \ \ \ btScalar\ *w\ =\ outer\_w;}
\DoxyCodeLine{01873\ \ \ \ \ scratchMem.delta\_w.resize(n);}
\DoxyCodeLine{01874\ \ \ \ \ scratchMem.delta\_x.resize(n);}
\DoxyCodeLine{01875\ \ \ \ \ scratchMem.Dell.resize(n);}
\DoxyCodeLine{01876\ \ \ \ \ scratchMem.ell.resize(n);}
\DoxyCodeLine{01877\ \ \ \ \ scratchMem.Arows.resize(n);}
\DoxyCodeLine{01878\ \ \ \ \ scratchMem.p.resize(n);}
\DoxyCodeLine{01879\ \ \ \ \ scratchMem.C.resize(n);}
\DoxyCodeLine{01880\ }
\DoxyCodeLine{01881\ \ \ \ \ \textcolor{comment}{//\ for\ i\ in\ N,\ state[i]\ is\ 0\ if\ x(i)==lo(i)\ or\ 1\ if\ x(i)==hi(i)}}
\DoxyCodeLine{01882\ \ \ \ \ scratchMem.state.resize(n);}
\DoxyCodeLine{01883\ }
\DoxyCodeLine{01884\ \ \ \ \ \textcolor{comment}{//\ create\ LCP\ object.\ note\ that\ tmp\ is\ set\ to\ delta\_w\ to\ save\ space,\ this}}
\DoxyCodeLine{01885\ \ \ \ \ \textcolor{comment}{//\ optimization\ relies\ on\ knowledge\ of\ how\ tmp\ is\ used,\ so\ be\ careful!}}
\DoxyCodeLine{01886\ \ \ \ \ \mbox{\hyperlink{structbt_l_c_p}{btLCP}}\ lcp(n,\ nskip,\ nub,\ A,\ x,\ b,\ w,\ lo,\ hi,\ \&scratchMem.L[0],\ \&scratchMem.d[0],\ \&scratchMem.Dell[0],\ \&scratchMem.ell[0],\ \&scratchMem.delta\_w[0],\ \&scratchMem.state[0],\ findex,\ \&scratchMem.p[0],\ \&scratchMem.C[0],\ \&scratchMem.Arows[0]);}
\DoxyCodeLine{01887\ \ \ \ \ \textcolor{keywordtype}{int}\ adj\_nub\ =\ lcp.getNub();}
\DoxyCodeLine{01888\ }
\DoxyCodeLine{01889\ \ \ \ \ \textcolor{comment}{//\ loop\ over\ all\ indexes\ adj\_nub..n-\/1.\ for\ index\ i,\ if\ x(i),w(i)\ satisfy\ the}}
\DoxyCodeLine{01890\ \ \ \ \ \textcolor{comment}{//\ LCP\ conditions\ then\ i\ is\ added\ to\ the\ appropriate\ index\ set.\ otherwise}}
\DoxyCodeLine{01891\ \ \ \ \ \textcolor{comment}{//\ x(i),w(i)\ is\ driven\ either\ +ve\ or\ -\/ve\ to\ force\ it\ to\ the\ valid\ region.}}
\DoxyCodeLine{01892\ \ \ \ \ \textcolor{comment}{//\ as\ we\ drive\ x(i),\ x(C)\ is\ also\ adjusted\ to\ keep\ w(C)\ at\ zero.}}
\DoxyCodeLine{01893\ \ \ \ \ \textcolor{comment}{//\ while\ driving\ x(i)\ we\ maintain\ the\ LCP\ conditions\ on\ the\ other\ variables}}
\DoxyCodeLine{01894\ \ \ \ \ \textcolor{comment}{//\ 0..i-\/1.\ we\ do\ this\ by\ watching\ out\ for\ other\ x(i),w(i)\ values\ going}}
\DoxyCodeLine{01895\ \ \ \ \ \textcolor{comment}{//\ outside\ the\ valid\ region,\ and\ then\ switching\ them\ between\ index\ sets}}
\DoxyCodeLine{01896\ \ \ \ \ \textcolor{comment}{//\ when\ that\ happens.}}
\DoxyCodeLine{01897\ }
\DoxyCodeLine{01898\ \ \ \ \ \textcolor{keywordtype}{bool}\ hit\_first\_friction\_index\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01899\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ adj\_nub;\ i\ <\ n;\ ++i)}
\DoxyCodeLine{01900\ \ \ \ \ \{}
\DoxyCodeLine{01901\ \ \ \ \ \ \ \ \ s\_error\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01902\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ index\ i\ is\ the\ driving\ index\ and\ indexes\ i+1..n-\/1\ are\ "{}dont\ care"{},}}
\DoxyCodeLine{01903\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ i.e.\ when\ we\ make\ changes\ to\ the\ system\ those\ x's\ will\ be\ zero\ and\ we}}
\DoxyCodeLine{01904\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ don't\ care\ what\ happens\ to\ those\ w's.\ in\ other\ words,\ we\ only\ consider}}
\DoxyCodeLine{01905\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ an\ (i+1)*(i+1)\ sub-\/problem\ of\ A*x=b+w.}}
\DoxyCodeLine{01906\ }
\DoxyCodeLine{01907\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ we've\ hit\ the\ first\ friction\ index,\ we\ have\ to\ compute\ the\ lo\ and}}
\DoxyCodeLine{01908\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ hi\ values\ based\ on\ the\ values\ of\ x\ already\ computed.\ we\ have\ been}}
\DoxyCodeLine{01909\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ permuting\ the\ indexes,\ so\ the\ values\ stored\ in\ the\ findex\ vector\ are}}
\DoxyCodeLine{01910\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ no\ longer\ valid.\ thus\ we\ have\ to\ temporarily\ unpermute\ the\ x\ vector.}}
\DoxyCodeLine{01911\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ for\ the\ purposes\ of\ this\ computation,\ 0*infinity\ =\ 0\ ...\ so\ if\ the}}
\DoxyCodeLine{01912\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ contact\ constraint's\ normal\ force\ is\ 0,\ there\ should\ be\ no\ tangential}}
\DoxyCodeLine{01913\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ force\ applied.}}
\DoxyCodeLine{01914\ }
\DoxyCodeLine{01915\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!hit\_first\_friction\_index\ \&\&\ findex\ \&\&\ findex[i]\ >=\ 0)}
\DoxyCodeLine{01916\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01917\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ un-\/permute\ x\ into\ delta\_w,\ which\ is\ not\ being\ used\ at\ the\ moment}}
\DoxyCodeLine{01918\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ n;\ ++j)\ scratchMem.delta\_w[scratchMem.p[j]]\ =\ x[j];}
\DoxyCodeLine{01919\ }
\DoxyCodeLine{01920\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ set\ lo\ and\ hi\ values}}
\DoxyCodeLine{01921\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ i;\ k\ <\ n;\ ++k)}
\DoxyCodeLine{01922\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01923\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ wfk\ =\ scratchMem.delta\_w[findex[k]];}
\DoxyCodeLine{01924\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (wfk\ ==\ 0)}
\DoxyCodeLine{01925\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01926\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hi[k]\ =\ 0;}
\DoxyCodeLine{01927\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lo[k]\ =\ 0;}
\DoxyCodeLine{01928\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01929\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01930\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01931\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hi[k]\ =\ btFabs(hi[k]\ *\ wfk);}
\DoxyCodeLine{01932\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lo[k]\ =\ -\/hi[k];}
\DoxyCodeLine{01933\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01934\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01935\ \ \ \ \ \ \ \ \ \ \ \ \ hit\_first\_friction\_index\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01936\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01937\ }
\DoxyCodeLine{01938\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ thus\ far\ we\ have\ not\ even\ been\ computing\ the\ w\ values\ for\ indexes}}
\DoxyCodeLine{01939\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ greater\ than\ i,\ so\ compute\ w[i]\ now.}}
\DoxyCodeLine{01940\ \ \ \ \ \ \ \ \ w[i]\ =\ lcp.AiC\_times\_qC(i,\ x)\ +\ lcp.AiN\_times\_qN(i,\ x)\ -\/\ b[i];}
\DoxyCodeLine{01941\ }
\DoxyCodeLine{01942\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ lo=hi=0\ (which\ can\ happen\ for\ tangential\ friction\ when\ normals\ are}}
\DoxyCodeLine{01943\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ 0)\ then\ the\ index\ will\ be\ assigned\ to\ set\ N\ with\ some\ state.\ however,}}
\DoxyCodeLine{01944\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ set\ C's\ line\ has\ zero\ size,\ so\ the\ index\ will\ always\ remain\ in\ set\ N.}}
\DoxyCodeLine{01945\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ with\ the\ "{}normal"{}\ switching\ logic,\ if\ w\ changed\ sign\ then\ the\ index}}
\DoxyCodeLine{01946\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ would\ have\ to\ switch\ to\ set\ C\ and\ then\ back\ to\ set\ N\ with\ an\ inverted}}
\DoxyCodeLine{01947\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ state.\ this\ is\ pointless,\ and\ also\ computationally\ expensive.\ to}}
\DoxyCodeLine{01948\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ prevent\ this\ from\ happening,\ we\ use\ the\ rule\ that\ indexes\ with\ lo=hi=0}}
\DoxyCodeLine{01949\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ will\ never\ be\ checked\ for\ set\ changes.\ this\ means\ that\ the\ state\ for}}
\DoxyCodeLine{01950\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ these\ indexes\ may\ be\ incorrect,\ but\ that\ doesn't\ matter.}}
\DoxyCodeLine{01951\ }
\DoxyCodeLine{01952\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ see\ if\ x(i),w(i)\ is\ in\ a\ valid\ region}}
\DoxyCodeLine{01953\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lo[i]\ ==\ 0\ \&\&\ w[i]\ >=\ 0)}
\DoxyCodeLine{01954\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01955\ \ \ \ \ \ \ \ \ \ \ \ \ lcp.transfer\_i\_to\_N(i);}
\DoxyCodeLine{01956\ \ \ \ \ \ \ \ \ \ \ \ \ scratchMem.state[i]\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01957\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01958\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (hi[i]\ ==\ 0\ \&\&\ w[i]\ <=\ 0)}
\DoxyCodeLine{01959\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01960\ \ \ \ \ \ \ \ \ \ \ \ \ lcp.transfer\_i\_to\_N(i);}
\DoxyCodeLine{01961\ \ \ \ \ \ \ \ \ \ \ \ \ scratchMem.state[i]\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01962\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01963\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (w[i]\ ==\ 0)}
\DoxyCodeLine{01964\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01965\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ this\ is\ a\ degenerate\ case.\ by\ the\ time\ we\ get\ to\ this\ test\ we\ know}}
\DoxyCodeLine{01966\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ that\ lo\ !=\ 0,\ which\ means\ that\ lo\ <\ 0\ as\ lo\ is\ not\ allowed\ to\ be\ +ve,}}
\DoxyCodeLine{01967\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ and\ similarly\ that\ hi\ >\ 0.\ this\ means\ that\ the\ line\ segment}}
\DoxyCodeLine{01968\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ corresponding\ to\ set\ C\ is\ at\ least\ finite\ in\ extent,\ and\ we\ are\ on\ it.}}
\DoxyCodeLine{01969\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE:\ we\ must\ call\ lcp.solve1()\ before\ lcp.transfer\_i\_to\_C()}}
\DoxyCodeLine{01970\ \ \ \ \ \ \ \ \ \ \ \ \ lcp.solve1(\&scratchMem.delta\_x[0],\ i,\ 0,\ 1);}
\DoxyCodeLine{01971\ }
\DoxyCodeLine{01972\ \ \ \ \ \ \ \ \ \ \ \ \ lcp.transfer\_i\_to\_C(i);}
\DoxyCodeLine{01973\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01974\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01975\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01976\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ we\ must\ push\ x(i)\ and\ w(i)}}
\DoxyCodeLine{01977\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;;)}
\DoxyCodeLine{01978\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01979\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ dir;}
\DoxyCodeLine{01980\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ dirf;}
\DoxyCodeLine{01981\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ find\ direction\ to\ push\ on\ x(i)}}
\DoxyCodeLine{01982\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (w[i]\ <=\ 0)}
\DoxyCodeLine{01983\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01984\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dir\ =\ 1;}
\DoxyCodeLine{01985\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dirf\ =\ btScalar(1.0);}
\DoxyCodeLine{01986\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01987\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01988\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01989\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dir\ =\ -\/1;}
\DoxyCodeLine{01990\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dirf\ =\ btScalar(-\/1.0);}
\DoxyCodeLine{01991\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01992\ }
\DoxyCodeLine{01993\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ compute:\ delta\_x(C)\ =\ -\/dir*A(C,C)\(\backslash\)A(C,i)}}
\DoxyCodeLine{01994\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lcp.solve1(\&scratchMem.delta\_x[0],\ i,\ dir);}
\DoxyCodeLine{01995\ }
\DoxyCodeLine{01996\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ note\ that\ delta\_x[i]\ =\ dirf,\ but\ we\ wont\ bother\ to\ set\ it}}
\DoxyCodeLine{01997\ }
\DoxyCodeLine{01998\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ compute:\ delta\_w\ =\ A*delta\_x\ ...\ note\ we\ only\ care\ about}}
\DoxyCodeLine{01999\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ delta\_w(N)\ and\ delta\_w(i),\ the\ rest\ is\ ignored}}
\DoxyCodeLine{02000\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lcp.pN\_equals\_ANC\_times\_qC(\&scratchMem.delta\_w[0],\ \&scratchMem.delta\_x[0]);}
\DoxyCodeLine{02001\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lcp.pN\_plusequals\_ANi(\&scratchMem.delta\_w[0],\ i,\ dir);}
\DoxyCodeLine{02002\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ scratchMem.delta\_w[i]\ =\ lcp.AiC\_times\_qC(i,\ \&scratchMem.delta\_x[0])\ +\ lcp.Aii(i)\ *\ dirf;}
\DoxyCodeLine{02003\ }
\DoxyCodeLine{02004\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ find\ largest\ step\ we\ can\ take\ (size=s),\ either\ to\ drive\ x(i),w(i)}}
\DoxyCodeLine{02005\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ to\ the\ valid\ LCP\ region\ or\ to\ drive\ an\ already-\/valid\ variable}}
\DoxyCodeLine{02006\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ outside\ the\ valid\ region.}}
\DoxyCodeLine{02007\ }
\DoxyCodeLine{02008\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ cmd\ =\ 1;\ \ \textcolor{comment}{//\ index\ switching\ command}}
\DoxyCodeLine{02009\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ si\ =\ 0;\ \ \ \textcolor{comment}{//\ si\ =\ index\ to\ switch\ if\ cmd>3}}
\DoxyCodeLine{02010\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ s\ =\ -\/w[i]\ /\ scratchMem.delta\_w[i];}
\DoxyCodeLine{02011\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (dir\ >\ 0)}
\DoxyCodeLine{02012\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02013\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (hi[i]\ <\ BT\_INFINITY)}
\DoxyCodeLine{02014\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02015\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ s2\ =\ (hi[i]\ -\/\ x[i])\ *\ dirf;\ \ \textcolor{comment}{//\ was\ (hi[i]-\/x[i])/dirf\ \ //\ step\ to\ x(i)=hi(i)}}
\DoxyCodeLine{02016\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (s2\ <\ s)}
\DoxyCodeLine{02017\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02018\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ s\ =\ s2;}
\DoxyCodeLine{02019\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmd\ =\ 3;}
\DoxyCodeLine{02020\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02021\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02022\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02023\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02024\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02025\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lo[i]\ >\ -\/BT\_INFINITY)}
\DoxyCodeLine{02026\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02027\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ s2\ =\ (lo[i]\ -\/\ x[i])\ *\ dirf;\ \ \textcolor{comment}{//\ was\ (lo[i]-\/x[i])/dirf\ \ //\ step\ to\ x(i)=lo(i)}}
\DoxyCodeLine{02028\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (s2\ <\ s)}
\DoxyCodeLine{02029\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02030\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ s\ =\ s2;}
\DoxyCodeLine{02031\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmd\ =\ 2;}
\DoxyCodeLine{02032\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02033\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02034\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02035\ }
\DoxyCodeLine{02036\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02037\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ numN\ =\ lcp.numN();}
\DoxyCodeLine{02038\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ numN;\ ++k)}
\DoxyCodeLine{02039\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02040\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ indexN\_k\ =\ lcp.indexN(k);}
\DoxyCodeLine{02041\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!scratchMem.state[indexN\_k]\ ?\ scratchMem.delta\_w[indexN\_k]\ <\ 0\ :\ scratchMem.delta\_w[indexN\_k]\ >\ 0)}
\DoxyCodeLine{02042\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02043\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ don't\ bother\ checking\ if\ lo=hi=0}}
\DoxyCodeLine{02044\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lo[indexN\_k]\ ==\ 0\ \&\&\ hi[indexN\_k]\ ==\ 0)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{02045\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ s2\ =\ -\/w[indexN\_k]\ /\ scratchMem.delta\_w[indexN\_k];}
\DoxyCodeLine{02046\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (s2\ <\ s)}
\DoxyCodeLine{02047\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02048\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ s\ =\ s2;}
\DoxyCodeLine{02049\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmd\ =\ 4;}
\DoxyCodeLine{02050\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ si\ =\ indexN\_k;}
\DoxyCodeLine{02051\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02052\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02053\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02055\ }
\DoxyCodeLine{02056\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02057\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ numC\ =\ lcp.numC();}
\DoxyCodeLine{02058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ adj\_nub;\ k\ <\ numC;\ ++k)}
\DoxyCodeLine{02059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ indexC\_k\ =\ lcp.indexC(k);}
\DoxyCodeLine{02061\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (scratchMem.delta\_x[indexC\_k]\ <\ 0\ \&\&\ lo[indexC\_k]\ >\ -\/BT\_INFINITY)}
\DoxyCodeLine{02062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ s2\ =\ (lo[indexC\_k]\ -\/\ x[indexC\_k])\ /\ scratchMem.delta\_x[indexC\_k];}
\DoxyCodeLine{02064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (s2\ <\ s)}
\DoxyCodeLine{02065\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02066\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ s\ =\ s2;}
\DoxyCodeLine{02067\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmd\ =\ 5;}
\DoxyCodeLine{02068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ si\ =\ indexC\_k;}
\DoxyCodeLine{02069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02071\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (scratchMem.delta\_x[indexC\_k]\ >\ 0\ \&\&\ hi[indexC\_k]\ <\ BT\_INFINITY)}
\DoxyCodeLine{02072\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02073\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btScalar\ s2\ =\ (hi[indexC\_k]\ -\/\ x[indexC\_k])\ /\ scratchMem.delta\_x[indexC\_k];}
\DoxyCodeLine{02074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (s2\ <\ s)}
\DoxyCodeLine{02075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ s\ =\ s2;}
\DoxyCodeLine{02077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmd\ =\ 6;}
\DoxyCodeLine{02078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ si\ =\ indexC\_k;}
\DoxyCodeLine{02079\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02080\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02081\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02082\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02083\ }
\DoxyCodeLine{02084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//static\ char*\ cmdstring[8]\ =\ \{0,"{}-\/>C"{},"{}-\/>NL"{},"{}-\/>NH"{},"{}N-\/>C"{},}}
\DoxyCodeLine{02085\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ "{}C-\/>NL"{},"{}C-\/>NH"{}\};}}
\DoxyCodeLine{02086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//printf\ ("{}cmd=\%d\ (\%s),\ si=\%d\(\backslash\)n"{},cmd,cmdstring[cmd],(cmd>3)\ ?\ si\ :\ i);}}
\DoxyCodeLine{02087\ }
\DoxyCodeLine{02088\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ s\ <=\ 0\ then\ we've\ got\ a\ problem.\ if\ we\ just\ keep\ going\ then}}
\DoxyCodeLine{02089\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ we're\ going\ to\ get\ stuck\ in\ an\ infinite\ loop.\ instead,\ just\ cross}}
\DoxyCodeLine{02090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ our\ fingers\ and\ exit\ with\ the\ current\ solution.}}
\DoxyCodeLine{02091\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (s\ <=\ btScalar(0.0))}
\DoxyCodeLine{02092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02093\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ printf("{}LCP\ internal\ error,\ s\ <=\ 0\ (s=\%.4e)"{},(double)s);}}
\DoxyCodeLine{02094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ <\ n)}
\DoxyCodeLine{02095\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02096\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btSetZero(x\ +\ i,\ n\ -\/\ i);}
\DoxyCodeLine{02097\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ btSetZero(w\ +\ i,\ n\ -\/\ i);}
\DoxyCodeLine{02098\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02099\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ s\_error\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02100\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02101\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02102\ }
\DoxyCodeLine{02103\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ apply\ x\ =\ x\ +\ s\ *\ delta\_x}}
\DoxyCodeLine{02104\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lcp.pC\_plusequals\_s\_times\_qC(x,\ s,\ \&scratchMem.delta\_x[0]);}
\DoxyCodeLine{02105\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x[i]\ +=\ s\ *\ dirf;}
\DoxyCodeLine{02106\ }
\DoxyCodeLine{02107\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ apply\ w\ =\ w\ +\ s\ *\ delta\_w}}
\DoxyCodeLine{02108\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lcp.pN\_plusequals\_s\_times\_qN(w,\ s,\ \&scratchMem.delta\_w[0]);}
\DoxyCodeLine{02109\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ w[i]\ +=\ s\ *\ scratchMem.delta\_w[i];}
\DoxyCodeLine{02110\ }
\DoxyCodeLine{02111\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ void\ *tmpbuf;}}
\DoxyCodeLine{02112\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ switch\ indexes\ between\ sets\ if\ necessary}}
\DoxyCodeLine{02113\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (cmd)}
\DoxyCodeLine{02114\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02115\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ \ \textcolor{comment}{//\ done}}
\DoxyCodeLine{02116\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ w[i]\ =\ 0;}
\DoxyCodeLine{02117\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lcp.transfer\_i\_to\_C(i);}
\DoxyCodeLine{02118\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02119\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ \ \textcolor{comment}{//\ done}}
\DoxyCodeLine{02120\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x[i]\ =\ lo[i];}
\DoxyCodeLine{02121\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ scratchMem.state[i]\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02122\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lcp.transfer\_i\_to\_N(i);}
\DoxyCodeLine{02123\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02124\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 3:\ \ \textcolor{comment}{//\ done}}
\DoxyCodeLine{02125\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x[i]\ =\ hi[i];}
\DoxyCodeLine{02126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ scratchMem.state[i]\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02127\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lcp.transfer\_i\_to\_N(i);}
\DoxyCodeLine{02128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 4:\ \ \textcolor{comment}{//\ keep\ going}}
\DoxyCodeLine{02130\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ w[si]\ =\ 0;}
\DoxyCodeLine{02131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lcp.transfer\_i\_from\_N\_to\_C(si);}
\DoxyCodeLine{02132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 5:\ \ \textcolor{comment}{//\ keep\ going}}
\DoxyCodeLine{02134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x[si]\ =\ lo[si];}
\DoxyCodeLine{02135\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ scratchMem.state[si]\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lcp.transfer\_i\_from\_C\_to\_N(si,\ scratchMem.m\_scratch);}
\DoxyCodeLine{02137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 6:\ \ \textcolor{comment}{//\ keep\ going}}
\DoxyCodeLine{02139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x[si]\ =\ hi[si];}
\DoxyCodeLine{02140\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ scratchMem.state[si]\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02141\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lcp.transfer\_i\_from\_C\_to\_N(si,\ scratchMem.m\_scratch);}
\DoxyCodeLine{02142\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02143\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02144\ }
\DoxyCodeLine{02145\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (cmd\ <=\ 3)\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02146\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \ \textcolor{comment}{//\ for\ (;;)}}
\DoxyCodeLine{02147\ \ \ \ \ \ \ \ \ \}\ \ \ \ \ \ \textcolor{comment}{//\ else}}
\DoxyCodeLine{02148\ }
\DoxyCodeLine{02149\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (s\_error)}
\DoxyCodeLine{02150\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02151\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02152\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02153\ \ \ \ \ \}\ \ \textcolor{comment}{//\ for\ (int\ i=adj\_nub;\ i<n;\ ++i)}}
\DoxyCodeLine{02154\ }
\DoxyCodeLine{02155\ \ \ \ \ lcp.unpermute();}
\DoxyCodeLine{02156\ }
\DoxyCodeLine{02157\ \ \ \ \ \textcolor{keywordflow}{return}\ !s\_error;}
\DoxyCodeLine{02158\ \}}

\end{DoxyCode}
