\doxysection{bt\+Geometry\+Operations.\+h}
\hypertarget{bt_geometry_operations_8h_source}{}\label{bt_geometry_operations_8h_source}\index{C:/Users/Usuario/Documents/pruebas-\/c/Practica Animación/libraries/bullet-\/3.17/src/BulletCollision/Gimpact/btGeometryOperations.h@{C:/Users/Usuario/Documents/pruebas-\/c/Practica Animación/libraries/bullet-\/3.17/src/BulletCollision/Gimpact/btGeometryOperations.h}}
\mbox{\hyperlink{bt_geometry_operations_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ BT\_BASIC\_GEOMETRY\_OPERATIONS\_H\_INCLUDED}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ BT\_BASIC\_GEOMETRY\_OPERATIONS\_H\_INCLUDED}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00008\ \textcolor{comment}{/*}}
\DoxyCodeLine{00009\ \textcolor{comment}{This\ source\ file\ is\ part\ of\ GIMPACT\ Library.}}
\DoxyCodeLine{00010\ \textcolor{comment}{}}
\DoxyCodeLine{00011\ \textcolor{comment}{For\ the\ latest\ info,\ see\ http://gimpact.sourceforge.net/}}
\DoxyCodeLine{00012\ \textcolor{comment}{}}
\DoxyCodeLine{00013\ \textcolor{comment}{Copyright\ (c)\ 2007\ Francisco\ Leon\ Najera.\ C.C.\ 80087371.}}
\DoxyCodeLine{00014\ \textcolor{comment}{email:\ projectileman@yahoo.com}}
\DoxyCodeLine{00015\ \textcolor{comment}{}}
\DoxyCodeLine{00016\ \textcolor{comment}{}}
\DoxyCodeLine{00017\ \textcolor{comment}{This\ software\ is\ provided\ 'as-\/is',\ without\ any\ express\ or\ implied\ warranty.}}
\DoxyCodeLine{00018\ \textcolor{comment}{In\ no\ event\ will\ the\ authors\ be\ held\ liable\ for\ any\ damages\ arising\ from\ the\ use\ of\ this\ software.}}
\DoxyCodeLine{00019\ \textcolor{comment}{Permission\ is\ granted\ to\ anyone\ to\ use\ this\ software\ for\ any\ purpose,}}
\DoxyCodeLine{00020\ \textcolor{comment}{including\ commercial\ applications,\ and\ to\ alter\ it\ and\ redistribute\ it\ freely,}}
\DoxyCodeLine{00021\ \textcolor{comment}{subject\ to\ the\ following\ restrictions:}}
\DoxyCodeLine{00022\ \textcolor{comment}{}}
\DoxyCodeLine{00023\ \textcolor{comment}{1.\ The\ origin\ of\ this\ software\ must\ not\ be\ misrepresented;\ you\ must\ not\ claim\ that\ you\ wrote\ the\ original\ software.\ If\ you\ use\ this\ software\ in\ a\ product,\ an\ acknowledgment\ in\ the\ product\ documentation\ would\ be\ appreciated\ but\ is\ not\ required.}}
\DoxyCodeLine{00024\ \textcolor{comment}{2.\ Altered\ source\ versions\ must\ be\ plainly\ marked\ as\ such,\ and\ must\ not\ be\ misrepresented\ as\ being\ the\ original\ software.}}
\DoxyCodeLine{00025\ \textcolor{comment}{3.\ This\ notice\ may\ not\ be\ removed\ or\ altered\ from\ any\ source\ distribution.}}
\DoxyCodeLine{00026\ \textcolor{comment}{*/}}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#include\ "{}btBoxCollision.h"{}}}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#define\ PLANEDIREPSILON\ 0.0000001f}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#define\ PARALELENORMALS\ 0.000001f}}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#define\ BT\_CLAMP(number,\ minval,\ maxval)\ (number\ <\ minval\ ?\ minval\ :\ (number\ >\ maxval\ ?\ maxval\ :\ number))}}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00036\ SIMD\_FORCE\_INLINE\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{bt_geometry_operations_8h_a8ef83f3444ff4b984beb7c1c593cb0eb}{bt\_edge\_plane}}(\textcolor{keyword}{const}\ btVector3\ \&e1,\ \textcolor{keyword}{const}\ btVector3\ \&e2,\ \textcolor{keyword}{const}\ btVector3\ \&normal,\ \mbox{\hyperlink{classbt_vector4}{btVector4}}\ \&plane)}
\DoxyCodeLine{00037\ \{}
\DoxyCodeLine{00038\ \ \ \ \ btVector3\ planenormal\ =\ (e2\ -\/\ e1).cross(normal);}
\DoxyCodeLine{00039\ \ \ \ \ planenormal.normalize();}
\DoxyCodeLine{00040\ \ \ \ \ plane.\mbox{\hyperlink{classbt_vector4_a7653b136836ef8c5f66d20cb11a86ceb}{setValue}}(planenormal[0],\ planenormal[1],\ planenormal[2],\ e2.dot(planenormal));}
\DoxyCodeLine{00041\ \}}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ \textcolor{comment}{//*****************\ SEGMENT\ and\ LINE\ FUNCTIONS\ **********************************///}}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00047\ SIMD\_FORCE\_INLINE\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{bt_geometry_operations_8h_adb1d2624b7fc6f880aee1f590fe7e3b4}{bt\_closest\_point\_on\_segment}}(}
\DoxyCodeLine{00048\ \ \ \ \ btVector3\ \&cp,\ \textcolor{keyword}{const}\ btVector3\ \&v,}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{keyword}{const}\ btVector3\ \&e1,\ \textcolor{keyword}{const}\ btVector3\ \&e2)}
\DoxyCodeLine{00050\ \{}
\DoxyCodeLine{00051\ \ \ \ \ btVector3\ n\ =\ e2\ -\/\ e1;}
\DoxyCodeLine{00052\ \ \ \ \ cp\ =\ v\ -\/\ e1;}
\DoxyCodeLine{00053\ \ \ \ \ btScalar\ \_scalar\ =\ cp.dot(n)\ /\ n.dot(n);}
\DoxyCodeLine{00054\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_scalar\ <\ 0.0f)}
\DoxyCodeLine{00055\ \ \ \ \ \{}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ cp\ =\ e1;}
\DoxyCodeLine{00057\ \ \ \ \ \}}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_scalar\ >\ 1.0f)}
\DoxyCodeLine{00059\ \ \ \ \ \{}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ cp\ =\ e2;}
\DoxyCodeLine{00061\ \ \ \ \ \}}
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00063\ \ \ \ \ \{}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ cp\ =\ \_scalar\ *\ n\ +\ e1;}
\DoxyCodeLine{00065\ \ \ \ \ \}}
\DoxyCodeLine{00066\ \}}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00076\ SIMD\_FORCE\_INLINE\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{bt_geometry_operations_8h_a8da4cf7fec1c05beb975ac1ea64009e4}{bt\_line\_plane\_collision}}(}
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classbt_vector4}{btVector4}}\ \&plane,}
\DoxyCodeLine{00078\ \ \ \ \ \textcolor{keyword}{const}\ btVector3\ \&vDir,}
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{keyword}{const}\ btVector3\ \&vPoint,}
\DoxyCodeLine{00080\ \ \ \ \ btVector3\ \&pout,}
\DoxyCodeLine{00081\ \ \ \ \ btScalar\ \&tparam,}
\DoxyCodeLine{00082\ \ \ \ \ btScalar\ tmin,\ btScalar\ tmax)}
\DoxyCodeLine{00083\ \{}
\DoxyCodeLine{00084\ \ \ \ \ btScalar\ \_dotdir\ =\ vDir.dot(plane);}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ \ \ \ \ \textcolor{keywordflow}{if}\ (btFabs(\_dotdir)\ <\ PLANEDIREPSILON)}
\DoxyCodeLine{00087\ \ \ \ \ \{}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ tparam\ =\ tmax;}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00090\ \ \ \ \ \}}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \ \ \ \ btScalar\ \_dis\ =\ bt\_distance\_point\_plane(plane,\ vPoint);}
\DoxyCodeLine{00093\ \ \ \ \ \textcolor{keywordtype}{char}\ returnvalue\ =\ \_dis\ <\ 0.0f\ ?\ 2\ :\ 1;}
\DoxyCodeLine{00094\ \ \ \ \ tparam\ =\ -\/\_dis\ /\ \_dotdir;}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ \ \ \ \ \textcolor{keywordflow}{if}\ (tparam\ <\ tmin)}
\DoxyCodeLine{00097\ \ \ \ \ \{}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ returnvalue\ =\ 0;}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ tparam\ =\ tmin;}
\DoxyCodeLine{00100\ \ \ \ \ \}}
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (tparam\ >\ tmax)}
\DoxyCodeLine{00102\ \ \ \ \ \{}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ returnvalue\ =\ 0;}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ tparam\ =\ tmax;}
\DoxyCodeLine{00105\ \ \ \ \ \}}
\DoxyCodeLine{00106\ \ \ \ \ pout\ =\ tparam\ *\ vDir\ +\ vPoint;}
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{keywordflow}{return}\ returnvalue;}
\DoxyCodeLine{00108\ \}}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00111\ SIMD\_FORCE\_INLINE\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{bt_geometry_operations_8h_aae15cd5c84602688921b973fc88b60ef}{bt\_segment\_collision}}(}
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{keyword}{const}\ btVector3\ \&vA1,}
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{keyword}{const}\ btVector3\ \&vA2,}
\DoxyCodeLine{00114\ \ \ \ \ \textcolor{keyword}{const}\ btVector3\ \&vB1,}
\DoxyCodeLine{00115\ \ \ \ \ \textcolor{keyword}{const}\ btVector3\ \&vB2,}
\DoxyCodeLine{00116\ \ \ \ \ btVector3\ \&vPointA,}
\DoxyCodeLine{00117\ \ \ \ \ btVector3\ \&vPointB)}
\DoxyCodeLine{00118\ \{}
\DoxyCodeLine{00119\ \ \ \ \ btVector3\ AD\ =\ vA2\ -\/\ vA1;}
\DoxyCodeLine{00120\ \ \ \ \ btVector3\ BD\ =\ vB2\ -\/\ vB1;}
\DoxyCodeLine{00121\ \ \ \ \ btVector3\ N\ =\ AD.cross(BD);}
\DoxyCodeLine{00122\ \ \ \ \ btScalar\ tp\ =\ N.length2();}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00124\ \ \ \ \ \mbox{\hyperlink{classbt_vector4}{btVector4}}\ \_M;\ \ \textcolor{comment}{//plane}}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ \ \ \ \ \textcolor{keywordflow}{if}\ (tp\ <\ SIMD\_EPSILON)\ \ \textcolor{comment}{//ARE\ PARALELE}}
\DoxyCodeLine{00127\ \ \ \ \ \{}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \textcolor{comment}{//project\ B\ over\ A}}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ invert\_b\_order\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \_M[0]\ =\ vB1.dot(AD);}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \_M[1]\ =\ vB2.dot(AD);}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_M[0]\ >\ \_M[1])}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \ \ \ \ invert\_b\_order\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \ \ \ \ BT\_SWAP\_NUMBERS(\_M[0],\ \_M[1]);}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \_M[2]\ =\ vA1.dot(AD);}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \_M[3]\ =\ vA2.dot(AD);}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \textcolor{comment}{//mid\ points}}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ N[0]\ =\ (\_M[0]\ +\ \_M[1])\ *\ 0.5f;}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ N[1]\ =\ (\_M[2]\ +\ \_M[3])\ *\ 0.5f;}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (N[0]\ <\ N[1])}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_M[1]\ <\ \_M[2])}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vPointB\ =\ invert\_b\_order\ ?\ vB1\ :\ vB2;}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vPointA\ =\ vA1;}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_M[1]\ <\ \_M[3])}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vPointB\ =\ invert\_b\_order\ ?\ vB1\ :\ vB2;}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{bt_geometry_operations_8h_adb1d2624b7fc6f880aee1f590fe7e3b4}{bt\_closest\_point\_on\_segment}}(vPointA,\ vPointB,\ vA1,\ vA2);}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vPointA\ =\ vA2;}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{bt_geometry_operations_8h_adb1d2624b7fc6f880aee1f590fe7e3b4}{bt\_closest\_point\_on\_segment}}(vPointB,\ vPointA,\ vB1,\ vB2);}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_M[3]\ <\ \_M[0])}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vPointB\ =\ invert\_b\_order\ ?\ vB2\ :\ vB1;}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vPointA\ =\ vA2;}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_M[3]\ <\ \_M[1])}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vPointA\ =\ vA2;}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{bt_geometry_operations_8h_adb1d2624b7fc6f880aee1f590fe7e3b4}{bt\_closest\_point\_on\_segment}}(vPointB,\ vPointA,\ vB1,\ vB2);}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vPointB\ =\ invert\_b\_order\ ?\ vB1\ :\ vB2;}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{bt_geometry_operations_8h_adb1d2624b7fc6f880aee1f590fe7e3b4}{bt\_closest\_point\_on\_segment}}(vPointA,\ vPointB,\ vA1,\ vA2);}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00181\ \ \ \ \ \}}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00183\ \ \ \ \ N\ =\ N.cross(BD);}
\DoxyCodeLine{00184\ \ \ \ \ \_M.\mbox{\hyperlink{classbt_vector4_a7653b136836ef8c5f66d20cb11a86ceb}{setValue}}(N[0],\ N[1],\ N[2],\ vB1.dot(N));}
\DoxyCodeLine{00185\ }
\DoxyCodeLine{00186\ \ \ \ \ \textcolor{comment}{//\ get\ point\ A\ as\ the\ plane\ collision\ point}}
\DoxyCodeLine{00187\ \ \ \ \ \mbox{\hyperlink{bt_geometry_operations_8h_a8da4cf7fec1c05beb975ac1ea64009e4}{bt\_line\_plane\_collision}}(\_M,\ AD,\ vA1,\ vPointA,\ tp,\ btScalar(0),\ btScalar(1));}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00189\ \ \ \ \ \textcolor{comment}{/*Closest\ point\ on\ segment*/}}
\DoxyCodeLine{00190\ \ \ \ \ vPointB\ =\ vPointA\ -\/\ vB1;}
\DoxyCodeLine{00191\ \ \ \ \ tp\ =\ vPointB.dot(BD);}
\DoxyCodeLine{00192\ \ \ \ \ tp\ /=\ BD.dot(BD);}
\DoxyCodeLine{00193\ \ \ \ \ tp\ =\ BT\_CLAMP(tp,\ 0.0f,\ 1.0f);}
\DoxyCodeLine{00194\ }
\DoxyCodeLine{00195\ \ \ \ \ vPointB\ =\ tp\ *\ BD\ +\ vB1;}
\DoxyCodeLine{00196\ \}}
\DoxyCodeLine{00197\ }
\DoxyCodeLine{00198\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GIM\_VECTOR\_H\_INCLUDED}}

\end{DoxyCode}
